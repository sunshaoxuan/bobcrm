  蠕ｩ蜈・ｯｾ雎｡縺ｮ繝励Ο繧ｸ繧ｧ繧ｯ繝医ｒ豎ｺ螳壹＠縺ｦ縺・∪縺・..
  蠕ｩ蜈・ｯｾ雎｡縺ｮ縺吶∋縺ｦ縺ｮ繝励Ο繧ｸ繧ｧ繧ｯ繝医・譛譁ｰ縺ｧ縺吶・
  BobCrm.Api -> C:\workspace\bobcrm\src\BobCrm.Api\bin\Debug\net8.0\BobCrm.Api.dll
  BobCrm.Api.Tests -> C:\workspace\bobcrm\tests\BobCrm.Api.Tests\bin\Debug\net8.0\BobCrm.Api.Tests.dll
C:\workspace\bobcrm\tests\BobCrm.Api.Tests\bin\Debug\net8.0\BobCrm.Api.Tests.dll (.NETCoreApp,Version=v8.0) 縺ｮ繝・せ繝亥ｮ溯｡・
VSTest 縺ｮ繝舌・繧ｸ繝ｧ繝ｳ 17.14.1 (x64)

繝・せ繝亥ｮ溯｡後ｒ髢句ｧ九＠縺ｦ縺・∪縺吶ゅ♀蠕・■縺上□縺輔＞...
蜷郁ｨ・1 蛟九・繝・せ繝・繝輔ぃ繧､繝ｫ縺梧欠螳壹＆繧後◆繝代ち繝ｼ繝ｳ縺ｨ荳閾ｴ縺励∪縺励◆縲・
C:\workspace\bobcrm\tests\BobCrm.Api.Tests\bin\Debug\net8.0\BobCrm.Api.Tests.dll
[xUnit.net 00:00:00.00] xUnit.net VSTest Adapter v2.8.2+699d445a1a (64-bit .NET 8.0.21)
[xUnit.net 00:00:00.09]   Discovering: BobCrm.Api.Tests
[xUnit.net 00:00:00.13]   Discovered:  BobCrm.Api.Tests
[xUnit.net 00:00:00.13]   Starting:    BobCrm.Api.Tests
[07:44:35 INF] ============================================
[07:44:35 INF] Application starting at 11/06/2025 07:44:35, log file: C:\workspace\bobcrm\tests\BobCrm.Api.Tests\bin\Debug\net8.0\..\..\logs\api_20251106_074435.log
[07:44:35 INF] ============================================
[07:44:36 INF] Executed DbCommand (32ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:36 INF] Executed DbCommand (4ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:36 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:36 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:36 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:36 INF] No migrations were applied. The database is already up to date.
[07:44:36 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Customers" AS c)
[07:44:36 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "FieldDefinitions" AS f)
[07:44:36 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationLanguages" AS l)
[EntityMetadata] Step 1: Found 1 entity types implementing IEntityMetadataProvider
[07:44:36 INF] Executed DbCommand (7ms) [Parameters=[@__metadata_EntityType_0='?'], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
WHERE e."EntityType" = @__metadata_EntityType_0
LIMIT 1
[EntityMetadata] - Already exists: Customer
[EntityMetadata] Step 2: Validating existing metadata records...
[07:44:36 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
[EntityMetadata] ? No changes needed (all in sync)
[07:44:36 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationResources" AS l)
[xUnit.net 00:00:01.50]     BobCrm.Api.Tests.AccessIntegrationTests.Layout_Save_Default_Forbidden_For_NonAdmin [FAIL]
[xUnit.net 00:00:01.50]       System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
[xUnit.net 00:00:01.50]       Stack Trace:
[xUnit.net 00:00:01.50]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
[xUnit.net 00:00:01.50]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
[xUnit.net 00:00:01.50]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
[xUnit.net 00:00:01.50]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
[xUnit.net 00:00:01.50]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
[xUnit.net 00:00:01.50]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
[xUnit.net 00:00:01.50]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
[xUnit.net 00:00:01.50]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
[xUnit.net 00:00:01.50]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
[xUnit.net 00:00:01.50]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
[xUnit.net 00:00:01.50]            at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
[xUnit.net 00:00:01.50]         C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs(116,0): at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db)
[xUnit.net 00:00:01.50]         C:\workspace\bobcrm\src\BobCrm.Api\Program.cs(147,0): at Program.<Main>$(String[] args)
[xUnit.net 00:00:01.50]            at Program.<Main>(String[] args)
[xUnit.net 00:00:01.50]            at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
[xUnit.net 00:00:01.50]            at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
[xUnit.net 00:00:01.50]         --- End of stack trace from previous location ---
[xUnit.net 00:00:01.50]            at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
[xUnit.net 00:00:01.50]            at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
[xUnit.net 00:00:01.50]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:01.50]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs(35,0): at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:01.50]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
[xUnit.net 00:00:01.50]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
[xUnit.net 00:00:01.50]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:01.50]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:01.50]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:01.50]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:01.50]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\AccessIntegrationTests.cs(54,0): at BobCrm.Api.Tests.AccessIntegrationTests.Layout_Save_Default_Forbidden_For_NonAdmin()
[xUnit.net 00:00:01.50]         --- End of stack trace from previous location ---
[07:44:36 INF] ============================================
[07:44:36 INF] Application starting at 11/06/2025 07:44:36, log file: C:\workspace\bobcrm\tests\BobCrm.Api.Tests\bin\Debug\net8.0\..\..\logs\api_20251106_074436.log
[07:44:36 INF] ============================================
[07:44:36 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:36 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:36 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:36 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:36 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:36 INF] No migrations were applied. The database is already up to date.
[07:44:36 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Customers" AS c)
[07:44:36 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "FieldDefinitions" AS f)
[07:44:36 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationLanguages" AS l)
[EntityMetadata] Step 1: Found 1 entity types implementing IEntityMetadataProvider
[07:44:36 INF] Executed DbCommand (1ms) [Parameters=[@__metadata_EntityType_0='?'], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
WHERE e."EntityType" = @__metadata_EntityType_0
LIMIT 1
[EntityMetadata] - Already exists: Customer
[EntityMetadata] Step 2: Validating existing metadata records...
[07:44:36 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
[EntityMetadata] ? No changes needed (all in sync)
[07:44:36 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationResources" AS l)
[xUnit.net 00:00:01.56]     BobCrm.Api.Tests.AccessIntegrationTests.PutCustomer_Respects_CustomerAccess_CanEdit [FAIL]
[xUnit.net 00:00:01.56]       System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
[xUnit.net 00:00:01.56]       Stack Trace:
[xUnit.net 00:00:01.56]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
[xUnit.net 00:00:01.56]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
[xUnit.net 00:00:01.56]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
[xUnit.net 00:00:01.56]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
[xUnit.net 00:00:01.56]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
[xUnit.net 00:00:01.56]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
[xUnit.net 00:00:01.56]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
[xUnit.net 00:00:01.56]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
[xUnit.net 00:00:01.56]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
[xUnit.net 00:00:01.56]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
[xUnit.net 00:00:01.56]            at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
[xUnit.net 00:00:01.56]         C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs(116,0): at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db)
[xUnit.net 00:00:01.56]         C:\workspace\bobcrm\src\BobCrm.Api\Program.cs(147,0): at Program.<Main>$(String[] args)
[xUnit.net 00:00:01.56]            at Program.<Main>(String[] args)
[xUnit.net 00:00:01.56]            at InvokeStub_Program.<Main>(Object, Span`1)
[xUnit.net 00:00:01.56]            at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
[xUnit.net 00:00:01.56]         --- End of stack trace from previous location ---
[xUnit.net 00:00:01.56]            at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
[xUnit.net 00:00:01.56]            at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
[xUnit.net 00:00:01.56]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:01.56]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs(35,0): at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:01.56]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
[xUnit.net 00:00:01.56]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
[xUnit.net 00:00:01.56]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:01.56]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:01.56]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:01.56]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:01.56]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\AccessIntegrationTests.cs(23,0): at BobCrm.Api.Tests.AccessIntegrationTests.PutCustomer_Respects_CustomerAccess_CanEdit()
[xUnit.net 00:00:01.56]         --- End of stack trace from previous location ---
[07:44:36 INF] ============================================
[07:44:36 INF] Application starting at 11/06/2025 07:44:36, log file: C:\workspace\bobcrm\tests\BobCrm.Api.Tests\bin\Debug\net8.0\..\..\logs\api_20251106_074436.log
[07:44:36 INF] ============================================
[07:44:36 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:36 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:36 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:36 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:36 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:36 INF] No migrations were applied. The database is already up to date.
[07:44:36 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Customers" AS c)
[07:44:36 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "FieldDefinitions" AS f)
[07:44:36 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationLanguages" AS l)
[EntityMetadata] Step 1: Found 1 entity types implementing IEntityMetadataProvider
[07:44:36 INF] Executed DbCommand (1ms) [Parameters=[@__metadata_EntityType_0='?'], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
WHERE e."EntityType" = @__metadata_EntityType_0
LIMIT 1
[EntityMetadata] - Already exists: Customer
[EntityMetadata] Step 2: Validating existing metadata records...
[07:44:36 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
[EntityMetadata] ? No changes needed (all in sync)
[07:44:36 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationResources" AS l)
[xUnit.net 00:00:01.67]     BobCrm.Api.Tests.LayoutDimensionTests.Layout_Mixed_Units_In_Different_Widgets [FAIL]
[xUnit.net 00:00:01.67]       System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
[xUnit.net 00:00:01.67]       Stack Trace:
[xUnit.net 00:00:01.67]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
[xUnit.net 00:00:01.67]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
[xUnit.net 00:00:01.67]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
[xUnit.net 00:00:01.67]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
[xUnit.net 00:00:01.67]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
[xUnit.net 00:00:01.67]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
[xUnit.net 00:00:01.67]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
[xUnit.net 00:00:01.67]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
[xUnit.net 00:00:01.67]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
[xUnit.net 00:00:01.67]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
[xUnit.net 00:00:01.67]            at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
[xUnit.net 00:00:01.67]         C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs(116,0): at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db)
[xUnit.net 00:00:01.67]         C:\workspace\bobcrm\src\BobCrm.Api\Program.cs(147,0): at Program.<Main>$(String[] args)
[xUnit.net 00:00:01.67]            at Program.<Main>(String[] args)
[xUnit.net 00:00:01.67]            at InvokeStub_Program.<Main>(Object, Span`1)
[xUnit.net 00:00:01.67]            at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
[xUnit.net 00:00:01.67]         --- End of stack trace from previous location ---
[xUnit.net 00:00:01.67]            at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
[xUnit.net 00:00:01.67]            at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
[xUnit.net 00:00:01.67]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:01.67]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs(35,0): at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:01.67]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
[xUnit.net 00:00:01.67]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
[xUnit.net 00:00:01.67]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:01.67]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:01.67]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:01.67]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:01.67]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\LayoutDimensionTests.cs(106,0): at BobCrm.Api.Tests.LayoutDimensionTests.Layout_Mixed_Units_In_Different_Widgets()
[xUnit.net 00:00:01.67]         --- End of stack trace from previous location ---
[07:44:36 INF] ============================================
[07:44:36 INF] Application starting at 11/06/2025 07:44:36, log file: C:\workspace\bobcrm\tests\BobCrm.Api.Tests\bin\Debug\net8.0\..\..\logs\api_20251106_074436.log
[07:44:36 INF] ============================================
[07:44:36 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:36 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:36 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:36 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:36 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:36 INF] No migrations were applied. The database is already up to date.
[07:44:36 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Customers" AS c)
[07:44:36 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "FieldDefinitions" AS f)
[07:44:36 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationLanguages" AS l)
[EntityMetadata] Step 1: Found 1 entity types implementing IEntityMetadataProvider
[07:44:36 INF] Executed DbCommand (1ms) [Parameters=[@__metadata_EntityType_0='?'], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
WHERE e."EntityType" = @__metadata_EntityType_0
LIMIT 1
[EntityMetadata] - Already exists: Customer
[EntityMetadata] Step 2: Validating existing metadata records...
[07:44:36 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
[EntityMetadata] ? No changes needed (all in sync)
[07:44:36 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationResources" AS l)
[xUnit.net 00:00:01.74]     BobCrm.Api.Tests.LayoutDimensionTests.Layout_Delete_Then_Get_Returns_Default_Or_Empty [FAIL]
[xUnit.net 00:00:01.74]       System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
[xUnit.net 00:00:01.74]       Stack Trace:
[xUnit.net 00:00:01.74]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
[xUnit.net 00:00:01.74]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
[xUnit.net 00:00:01.74]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
[xUnit.net 00:00:01.74]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
[xUnit.net 00:00:01.74]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
[xUnit.net 00:00:01.74]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
[xUnit.net 00:00:01.74]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
[xUnit.net 00:00:01.74]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
[xUnit.net 00:00:01.74]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
[xUnit.net 00:00:01.74]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
[xUnit.net 00:00:01.74]            at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
[xUnit.net 00:00:01.74]         C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs(116,0): at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db)
[xUnit.net 00:00:01.74]         C:\workspace\bobcrm\src\BobCrm.Api\Program.cs(147,0): at Program.<Main>$(String[] args)
[xUnit.net 00:00:01.74]            at Program.<Main>(String[] args)
[xUnit.net 00:00:01.74]            at InvokeStub_Program.<Main>(Object, Span`1)
[xUnit.net 00:00:01.74]            at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
[xUnit.net 00:00:01.74]         --- End of stack trace from previous location ---
[xUnit.net 00:00:01.74]            at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
[xUnit.net 00:00:01.74]            at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
[xUnit.net 00:00:01.74]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:01.74]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs(35,0): at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:01.74]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
[xUnit.net 00:00:01.74]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
[xUnit.net 00:00:01.74]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:01.74]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:01.74]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:01.74]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:01.74]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\LayoutDimensionTests.cs(173,0): at BobCrm.Api.Tests.LayoutDimensionTests.Layout_Delete_Then_Get_Returns_Default_Or_Empty()
[xUnit.net 00:00:01.74]         --- End of stack trace from previous location ---
[07:44:36 INF] ============================================
[07:44:36 INF] Application starting at 11/06/2025 07:44:36, log file: C:\workspace\bobcrm\tests\BobCrm.Api.Tests\bin\Debug\net8.0\..\..\logs\api_20251106_074436.log
[07:44:36 INF] ============================================
[07:44:36 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:36 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:36 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:36 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:36 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:36 INF] No migrations were applied. The database is already up to date.
[07:44:36 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Customers" AS c)
[07:44:36 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "FieldDefinitions" AS f)
[07:44:36 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationLanguages" AS l)
[EntityMetadata] Step 1: Found 1 entity types implementing IEntityMetadataProvider
[07:44:36 INF] Executed DbCommand (1ms) [Parameters=[@__metadata_EntityType_0='?'], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
WHERE e."EntityType" = @__metadata_EntityType_0
LIMIT 1
[EntityMetadata] - Already exists: Customer
[EntityMetadata] Step 2: Validating existing metadata records...
[07:44:36 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
[EntityMetadata] ? No changes needed (all in sync)
[07:44:36 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationResources" AS l)
[xUnit.net 00:00:01.80]     BobCrm.Api.Tests.LayoutDimensionTests.Layout_Flow_Mode_Preserves_Width [FAIL]
[xUnit.net 00:00:01.80]       System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
[xUnit.net 00:00:01.80]       Stack Trace:
[xUnit.net 00:00:01.80]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
[xUnit.net 00:00:01.80]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
[xUnit.net 00:00:01.80]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
[xUnit.net 00:00:01.80]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
[xUnit.net 00:00:01.80]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
[xUnit.net 00:00:01.80]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
[xUnit.net 00:00:01.80]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
[xUnit.net 00:00:01.80]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
[xUnit.net 00:00:01.80]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
[xUnit.net 00:00:01.80]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
[xUnit.net 00:00:01.80]            at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
[xUnit.net 00:00:01.80]         C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs(116,0): at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db)
[xUnit.net 00:00:01.80]         C:\workspace\bobcrm\src\BobCrm.Api\Program.cs(147,0): at Program.<Main>$(String[] args)
[xUnit.net 00:00:01.80]            at Program.<Main>(String[] args)
[xUnit.net 00:00:01.80]            at InvokeStub_Program.<Main>(Object, Span`1)
[xUnit.net 00:00:01.80]            at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
[xUnit.net 00:00:01.80]         --- End of stack trace from previous location ---
[xUnit.net 00:00:01.80]            at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
[xUnit.net 00:00:01.80]            at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
[xUnit.net 00:00:01.80]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:01.80]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs(35,0): at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:01.80]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
[xUnit.net 00:00:01.80]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
[xUnit.net 00:00:01.80]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:01.80]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:01.80]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:01.80]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:01.80]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\LayoutDimensionTests.cs(142,0): at BobCrm.Api.Tests.LayoutDimensionTests.Layout_Flow_Mode_Preserves_Width()
[xUnit.net 00:00:01.80]         --- End of stack trace from previous location ---
[07:44:36 INF] ============================================
[07:44:36 INF] Application starting at 11/06/2025 07:44:36, log file: C:\workspace\bobcrm\tests\BobCrm.Api.Tests\bin\Debug\net8.0\..\..\logs\api_20251106_074436.log
[07:44:36 INF] ============================================
[07:44:36 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:36 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:36 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:36 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:36 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:36 INF] No migrations were applied. The database is already up to date.
[07:44:36 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Customers" AS c)
[07:44:36 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "FieldDefinitions" AS f)
[07:44:36 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationLanguages" AS l)
[EntityMetadata] Step 1: Found 1 entity types implementing IEntityMetadataProvider
[07:44:36 INF] Executed DbCommand (1ms) [Parameters=[@__metadata_EntityType_0='?'], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
WHERE e."EntityType" = @__metadata_EntityType_0
LIMIT 1
[EntityMetadata] - Already exists: Customer
[EntityMetadata] Step 2: Validating existing metadata records...
[07:44:36 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
[EntityMetadata] ? No changes needed (all in sync)
[07:44:36 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationResources" AS l)
[xUnit.net 00:00:01.85]     BobCrm.Api.Tests.LayoutDimensionTests.Layout_User_And_Default_Scope_Are_Independent [FAIL]
[xUnit.net 00:00:01.85]       System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
[xUnit.net 00:00:01.85]       Stack Trace:
[xUnit.net 00:00:01.85]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
[xUnit.net 00:00:01.85]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
[xUnit.net 00:00:01.85]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
[xUnit.net 00:00:01.85]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
[xUnit.net 00:00:01.85]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
[xUnit.net 00:00:01.85]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
[xUnit.net 00:00:01.85]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
[xUnit.net 00:00:01.85]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
[xUnit.net 00:00:01.85]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
[xUnit.net 00:00:01.85]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
[xUnit.net 00:00:01.85]            at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
[xUnit.net 00:00:01.85]         C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs(116,0): at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db)
[xUnit.net 00:00:01.85]         C:\workspace\bobcrm\src\BobCrm.Api\Program.cs(147,0): at Program.<Main>$(String[] args)
[xUnit.net 00:00:01.85]            at Program.<Main>(String[] args)
[xUnit.net 00:00:01.85]            at InvokeStub_Program.<Main>(Object, Span`1)
[xUnit.net 00:00:01.85]            at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
[xUnit.net 00:00:01.85]         --- End of stack trace from previous location ---
[xUnit.net 00:00:01.85]            at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
[xUnit.net 00:00:01.85]            at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
[xUnit.net 00:00:01.85]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:01.85]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs(35,0): at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:01.85]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
[xUnit.net 00:00:01.85]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
[xUnit.net 00:00:01.85]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:01.85]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:01.85]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:01.85]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:01.85]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\LayoutDimensionTests.cs(198,0): at BobCrm.Api.Tests.LayoutDimensionTests.Layout_User_And_Default_Scope_Are_Independent()
[xUnit.net 00:00:01.85]         --- End of stack trace from previous location ---
[07:44:36 INF] ============================================
[07:44:36 INF] Application starting at 11/06/2025 07:44:36, log file: C:\workspace\bobcrm\tests\BobCrm.Api.Tests\bin\Debug\net8.0\..\..\logs\api_20251106_074436.log
[07:44:36 INF] ============================================
[07:44:36 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:36 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:36 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:36 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:36 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:36 INF] No migrations were applied. The database is already up to date.
[07:44:36 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Customers" AS c)
[07:44:36 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "FieldDefinitions" AS f)
[07:44:36 INF] Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationLanguages" AS l)
[EntityMetadata] Step 1: Found 1 entity types implementing IEntityMetadataProvider
[07:44:36 INF] Executed DbCommand (1ms) [Parameters=[@__metadata_EntityType_0='?'], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
WHERE e."EntityType" = @__metadata_EntityType_0
LIMIT 1
[EntityMetadata] - Already exists: Customer
[EntityMetadata] Step 2: Validating existing metadata records...
[07:44:36 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
[EntityMetadata] ? No changes needed (all in sync)
[07:44:36 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationResources" AS l)
[xUnit.net 00:00:01.90]     BobCrm.Api.Tests.LayoutDimensionTests.Layout_Preserves_Width_And_WidthUnit_Pixels [FAIL]
[xUnit.net 00:00:01.90]       System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
[xUnit.net 00:00:01.90]       Stack Trace:
[xUnit.net 00:00:01.90]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
[xUnit.net 00:00:01.90]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
[xUnit.net 00:00:01.90]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
[xUnit.net 00:00:01.90]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
[xUnit.net 00:00:01.90]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
[xUnit.net 00:00:01.90]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
[xUnit.net 00:00:01.90]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
[xUnit.net 00:00:01.90]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
[xUnit.net 00:00:01.90]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
[xUnit.net 00:00:01.90]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
[xUnit.net 00:00:01.90]            at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
[xUnit.net 00:00:01.90]         C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs(116,0): at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db)
[xUnit.net 00:00:01.90]         C:\workspace\bobcrm\src\BobCrm.Api\Program.cs(147,0): at Program.<Main>$(String[] args)
[xUnit.net 00:00:01.90]            at Program.<Main>(String[] args)
[xUnit.net 00:00:01.90]            at InvokeStub_Program.<Main>(Object, Span`1)
[xUnit.net 00:00:01.90]            at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
[xUnit.net 00:00:01.90]         --- End of stack trace from previous location ---
[xUnit.net 00:00:01.90]            at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
[xUnit.net 00:00:01.90]            at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
[xUnit.net 00:00:01.90]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:01.90]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs(35,0): at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:01.90]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
[xUnit.net 00:00:01.90]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
[xUnit.net 00:00:01.90]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:01.90]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:01.90]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:01.90]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:01.90]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\LayoutDimensionTests.cs(65,0): at BobCrm.Api.Tests.LayoutDimensionTests.Layout_Preserves_Width_And_WidthUnit_Pixels()
[xUnit.net 00:00:01.90]         --- End of stack trace from previous location ---
[07:44:36 INF] ============================================
[07:44:36 INF] Application starting at 11/06/2025 07:44:36, log file: C:\workspace\bobcrm\tests\BobCrm.Api.Tests\bin\Debug\net8.0\..\..\logs\api_20251106_074436.log
[07:44:36 INF] ============================================
[07:44:36 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:36 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:36 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:36 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:36 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:36 INF] No migrations were applied. The database is already up to date.
[07:44:36 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Customers" AS c)
[07:44:36 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "FieldDefinitions" AS f)
[07:44:36 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationLanguages" AS l)
[EntityMetadata] Step 1: Found 1 entity types implementing IEntityMetadataProvider
[07:44:36 INF] Executed DbCommand (1ms) [Parameters=[@__metadata_EntityType_0='?'], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
WHERE e."EntityType" = @__metadata_EntityType_0
LIMIT 1
[EntityMetadata] - Already exists: Customer
[EntityMetadata] Step 2: Validating existing metadata records...
[07:44:36 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
[EntityMetadata] ? No changes needed (all in sync)
[07:44:36 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationResources" AS l)
[xUnit.net 00:00:01.95]     BobCrm.Api.Tests.LayoutDimensionTests.Layout_Preserves_Width_And_WidthUnit_Percent [FAIL]
[xUnit.net 00:00:01.95]       System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
[xUnit.net 00:00:01.95]       Stack Trace:
[xUnit.net 00:00:01.95]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
[xUnit.net 00:00:01.95]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
[xUnit.net 00:00:01.95]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
[xUnit.net 00:00:01.95]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
[xUnit.net 00:00:01.95]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
[xUnit.net 00:00:01.95]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
[xUnit.net 00:00:01.95]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
[xUnit.net 00:00:01.95]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
[xUnit.net 00:00:01.95]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
[xUnit.net 00:00:01.95]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
[xUnit.net 00:00:01.95]            at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
[xUnit.net 00:00:01.95]         C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs(116,0): at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db)
[xUnit.net 00:00:01.95]         C:\workspace\bobcrm\src\BobCrm.Api\Program.cs(147,0): at Program.<Main>$(String[] args)
[xUnit.net 00:00:01.95]            at Program.<Main>(String[] args)
[xUnit.net 00:00:01.95]            at InvokeStub_Program.<Main>(Object, Span`1)
[xUnit.net 00:00:01.95]            at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
[xUnit.net 00:00:01.95]         --- End of stack trace from previous location ---
[xUnit.net 00:00:01.95]            at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
[xUnit.net 00:00:01.95]            at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
[xUnit.net 00:00:01.95]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:01.95]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs(35,0): at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:01.95]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
[xUnit.net 00:00:01.95]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
[xUnit.net 00:00:01.95]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:01.95]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:01.95]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:01.95]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:01.95]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\LayoutDimensionTests.cs(18,0): at BobCrm.Api.Tests.LayoutDimensionTests.Layout_Preserves_Width_And_WidthUnit_Percent()
[xUnit.net 00:00:01.95]         --- End of stack trace from previous location ---
  螟ｱ謨・BobCrm.Api.Tests.AccessIntegrationTests.Layout_Save_Default_Forbidden_For_NonAdmin [1 s]
  繧ｨ繝ｩ繝ｼ 繝｡繝・そ繝ｼ繧ｸ:
   System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
  繧ｹ繧ｿ繝・け 繝医Ξ繝ｼ繧ｹ:
     at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
   at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db) in C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs:line 116
   at Program.<Main>$(String[] args) in C:\workspace\bobcrm\src\BobCrm.Api\Program.cs:line 147
   at Program.<Main>(String[] args)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
   at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder) in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs:line 35
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at BobCrm.Api.Tests.AccessIntegrationTests.Layout_Save_Default_Forbidden_For_NonAdmin() in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\AccessIntegrationTests.cs:line 54
--- End of stack trace from previous location ---
  螟ｱ謨・BobCrm.Api.Tests.AccessIntegrationTests.PutCustomer_Respects_CustomerAccess_CanEdit [65 ms]
  繧ｨ繝ｩ繝ｼ 繝｡繝・そ繝ｼ繧ｸ:
   System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
  繧ｹ繧ｿ繝・け 繝医Ξ繝ｼ繧ｹ:
     at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
   at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db) in C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs:line 116
   at Program.<Main>$(String[] args) in C:\workspace\bobcrm\src\BobCrm.Api\Program.cs:line 147
   at Program.<Main>(String[] args)
   at InvokeStub_Program.<Main>(Object, Span`1)
   at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
   at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder) in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs:line 35
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at BobCrm.Api.Tests.AccessIntegrationTests.PutCustomer_Respects_CustomerAccess_CanEdit() in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\AccessIntegrationTests.cs:line 23
--- End of stack trace from previous location ---
  螟ｱ謨・BobCrm.Api.Tests.LayoutDimensionTests.Layout_Mixed_Units_In_Different_Widgets [101 ms]
  繧ｨ繝ｩ繝ｼ 繝｡繝・そ繝ｼ繧ｸ:
   System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
  繧ｹ繧ｿ繝・け 繝医Ξ繝ｼ繧ｹ:
     at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
   at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db) in C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs:line 116
   at Program.<Main>$(String[] args) in C:\workspace\bobcrm\src\BobCrm.Api\Program.cs:line 147
   at Program.<Main>(String[] args)
   at InvokeStub_Program.<Main>(Object, Span`1)
   at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
   at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder) in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs:line 35
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at BobCrm.Api.Tests.LayoutDimensionTests.Layout_Mixed_Units_In_Different_Widgets() in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\LayoutDimensionTests.cs:line 106
--- End of stack trace from previous location ---
  螟ｱ謨・BobCrm.Api.Tests.LayoutDimensionTests.Layout_Delete_Then_Get_Returns_Default_Or_Empty [75 ms]
  繧ｨ繝ｩ繝ｼ 繝｡繝・そ繝ｼ繧ｸ:
   System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
  繧ｹ繧ｿ繝・け 繝医Ξ繝ｼ繧ｹ:
     at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
   at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db) in C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs:line 116
   at Program.<Main>$(String[] args) in C:\workspace\bobcrm\src\BobCrm.Api\Program.cs:line 147
   at Program.<Main>(String[] args)
   at InvokeStub_Program.<Main>(Object, Span`1)
   at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
   at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder) in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs:line 35
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at BobCrm.Api.Tests.LayoutDimensionTests.Layout_Delete_Then_Get_Returns_Default_Or_Empty() in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\LayoutDimensionTests.cs:line 173
--- End of stack trace from previous location ---
  螟ｱ謨・BobCrm.Api.Tests.LayoutDimensionTests.Layout_Flow_Mode_Preserves_Width [56 ms]
  繧ｨ繝ｩ繝ｼ 繝｡繝・そ繝ｼ繧ｸ:
   System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
  繧ｹ繧ｿ繝・け 繝医Ξ繝ｼ繧ｹ:
     at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
   at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db) in C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs:line 116
   at Program.<Main>$(String[] args) in C:\workspace\bobcrm\src\BobCrm.Api\Program.cs:line 147
   at Program.<Main>(String[] args)
   at InvokeStub_Program.<Main>(Object, Span`1)
   at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
   at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder) in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs:line 35
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at BobCrm.Api.Tests.LayoutDimensionTests.Layout_Flow_Mode_Preserves_Width() in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\LayoutDimensionTests.cs:line 142
--- End of stack trace from previous location ---
  螟ｱ謨・BobCrm.Api.Tests.LayoutDimensionTests.Layout_User_And_Default_Scope_Are_Independent [48 ms]
  繧ｨ繝ｩ繝ｼ 繝｡繝・そ繝ｼ繧ｸ:
   System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
  繧ｹ繧ｿ繝・け 繝医Ξ繝ｼ繧ｹ:
     at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
   at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db) in C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs:line 116
   at Program.<Main>$(String[] args) in C:\workspace\bobcrm\src\BobCrm.Api\Program.cs:line 147
   at Program.<Main>(String[] args)
   at InvokeStub_Program.<Main>(Object, Span`1)
   at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
   at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder) in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs:line 35
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at BobCrm.Api.Tests.LayoutDimensionTests.Layout_User_And_Default_Scope_Are_Independent() in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\LayoutDimensionTests.cs:line 198
--- End of stack trace from previous location ---
  螟ｱ謨・BobCrm.Api.Tests.LayoutDimensionTests.Layout_Preserves_Width_And_WidthUnit_Pixels [52 ms]
  繧ｨ繝ｩ繝ｼ 繝｡繝・そ繝ｼ繧ｸ:
   System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
  繧ｹ繧ｿ繝・け 繝医Ξ繝ｼ繧ｹ:
     at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
   at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db) in C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs:line 116
   at Program.<Main>$(String[] args) in C:\workspace\bobcrm\src\BobCrm.Api\Program.cs:line 147
   at Program.<Main>(String[] args)
   at InvokeStub_Program.<Main>(Object, Span`1)
   at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
   at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder) in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs:line 35
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at BobCrm.Api.Tests.LayoutDimensionTests.Layout_Preserves_Width_And_WidthUnit_Pixels() in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\LayoutDimensionTests.cs:line 65
--- End of stack trace from previous location ---
  螟ｱ謨・BobCrm.Api.Tests.LayoutDimensionTests.Layout_Preserves_Width_And_WidthUnit_Percent [49 ms]
  繧ｨ繝ｩ繝ｼ 繝｡繝・そ繝ｼ繧ｸ:
   System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
  繧ｹ繧ｿ繝・け 繝医Ξ繝ｼ繧ｹ:
     at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
   at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db) in C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs:line 116
   at Program.<Main>$(String[] args) in C:\workspace\bobcrm\src\BobCrm.Api\Program.cs:line 147
   at Program.<Main>(String[] args)
   at InvokeStub_Program.<Main>(Object, Span`1)
   at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
   at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder) in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs:line 35
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at BobCrm.Api.Tests.LayoutDimensionTests.Layout_Preserves_Width_And_WidthUnit_Percent() in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\LayoutDimensionTests.cs:line 18
--- End of stack trace from previous location ---
  謌仙粥 BobCrm.Api.Tests.QueriesUnitTests.CustomerQueries_Respects_Access_Control [20 ms]
[07:44:37 INF] ============================================
[07:44:37 INF] Application starting at 11/06/2025 07:44:37, log file: C:\workspace\bobcrm\tests\BobCrm.Api.Tests\bin\Debug\net8.0\..\..\logs\api_20251106_074437.log
[07:44:37 INF] ============================================
[07:44:37 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:37 INF] No migrations were applied. The database is already up to date.
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Customers" AS c)
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "FieldDefinitions" AS f)
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationLanguages" AS l)
[EntityMetadata] Step 1: Found 1 entity types implementing IEntityMetadataProvider
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[@__metadata_EntityType_0='?'], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
WHERE e."EntityType" = @__metadata_EntityType_0
LIMIT 1
[EntityMetadata] - Already exists: Customer
[EntityMetadata] Step 2: Validating existing metadata records...
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
[EntityMetadata] ? No changes needed (all in sync)
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationResources" AS l)
[xUnit.net 00:00:02.08]     BobCrm.Api.Tests.AuthFlowTests.Register_Activate_Login_Succeeds [FAIL]
[xUnit.net 00:00:02.08]       System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
[xUnit.net 00:00:02.08]       Stack Trace:
[xUnit.net 00:00:02.08]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
[xUnit.net 00:00:02.08]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
[xUnit.net 00:00:02.08]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
[xUnit.net 00:00:02.08]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
[xUnit.net 00:00:02.08]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
[xUnit.net 00:00:02.08]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
[xUnit.net 00:00:02.08]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
[xUnit.net 00:00:02.08]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
[xUnit.net 00:00:02.08]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
[xUnit.net 00:00:02.08]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
[xUnit.net 00:00:02.08]            at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
[xUnit.net 00:00:02.08]         C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs(116,0): at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db)
[xUnit.net 00:00:02.08]         C:\workspace\bobcrm\src\BobCrm.Api\Program.cs(147,0): at Program.<Main>$(String[] args)
[xUnit.net 00:00:02.08]            at Program.<Main>(String[] args)
[xUnit.net 00:00:02.08]            at InvokeStub_Program.<Main>(Object, Span`1)
[xUnit.net 00:00:02.08]            at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
[xUnit.net 00:00:02.08]         --- End of stack trace from previous location ---
[xUnit.net 00:00:02.08]            at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
[xUnit.net 00:00:02.08]            at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
[xUnit.net 00:00:02.08]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:02.08]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs(35,0): at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:02.08]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
[xUnit.net 00:00:02.08]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
[xUnit.net 00:00:02.08]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:02.08]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:02.08]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:02.08]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:02.08]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\AuthFlowTests.cs(16,0): at BobCrm.Api.Tests.AuthFlowTests.Register_Activate_Login_Succeeds()
[xUnit.net 00:00:02.08]         --- End of stack trace from previous location ---
[07:44:37 INF] ============================================
[07:44:37 INF] Application starting at 11/06/2025 07:44:37, log file: C:\workspace\bobcrm\tests\BobCrm.Api.Tests\bin\Debug\net8.0\..\..\logs\api_20251106_074437.log
[07:44:37 INF] ============================================
[07:44:37 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:37 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:37 INF] No migrations were applied. The database is already up to date.
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Customers" AS c)
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "FieldDefinitions" AS f)
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationLanguages" AS l)
[EntityMetadata] Step 1: Found 1 entity types implementing IEntityMetadataProvider
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[@__metadata_EntityType_0='?'], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
WHERE e."EntityType" = @__metadata_EntityType_0
LIMIT 1
[EntityMetadata] - Already exists: Customer
[EntityMetadata] Step 2: Validating existing metadata records...
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
[EntityMetadata] ? No changes needed (all in sync)
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationResources" AS l)
[xUnit.net 00:00:02.14]     BobCrm.Api.Tests.AuthBoundaryTests.Login_Fails_With_Nonexistent_Username [FAIL]
[xUnit.net 00:00:02.14]       System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
[xUnit.net 00:00:02.14]       Stack Trace:
[xUnit.net 00:00:02.14]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
[xUnit.net 00:00:02.14]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
[xUnit.net 00:00:02.14]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
[xUnit.net 00:00:02.14]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
[xUnit.net 00:00:02.14]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
[xUnit.net 00:00:02.14]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
[xUnit.net 00:00:02.14]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
[xUnit.net 00:00:02.14]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
[xUnit.net 00:00:02.14]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
[xUnit.net 00:00:02.14]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
[xUnit.net 00:00:02.14]            at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
[xUnit.net 00:00:02.14]         C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs(116,0): at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db)
[xUnit.net 00:00:02.14]         C:\workspace\bobcrm\src\BobCrm.Api\Program.cs(147,0): at Program.<Main>$(String[] args)
[xUnit.net 00:00:02.14]            at Program.<Main>(String[] args)
[xUnit.net 00:00:02.14]            at InvokeStub_Program.<Main>(Object, Span`1)
[xUnit.net 00:00:02.14]            at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
[xUnit.net 00:00:02.14]         --- End of stack trace from previous location ---
[xUnit.net 00:00:02.14]            at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
[xUnit.net 00:00:02.14]            at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
[xUnit.net 00:00:02.14]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:02.14]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs(35,0): at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:02.14]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
[xUnit.net 00:00:02.14]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
[xUnit.net 00:00:02.14]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:02.14]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:02.14]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:02.14]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:02.14]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\AuthBoundaryTests.cs(67,0): at BobCrm.Api.Tests.AuthBoundaryTests.Login_Fails_With_Nonexistent_Username()
[xUnit.net 00:00:02.14]         --- End of stack trace from previous location ---
[07:44:37 INF] ============================================
[07:44:37 INF] Application starting at 11/06/2025 07:44:37, log file: C:\workspace\bobcrm\tests\BobCrm.Api.Tests\bin\Debug\net8.0\..\..\logs\api_20251106_074437.log
[07:44:37 INF] ============================================
[07:44:37 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:37 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:37 INF] No migrations were applied. The database is already up to date.
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Customers" AS c)
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "FieldDefinitions" AS f)
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationLanguages" AS l)
[EntityMetadata] Step 1: Found 1 entity types implementing IEntityMetadataProvider
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[@__metadata_EntityType_0='?'], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
WHERE e."EntityType" = @__metadata_EntityType_0
LIMIT 1
[EntityMetadata] - Already exists: Customer
[EntityMetadata] Step 2: Validating existing metadata records...
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
[EntityMetadata] ? No changes needed (all in sync)
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationResources" AS l)
[xUnit.net 00:00:02.19]     BobCrm.Api.Tests.AuthBoundaryTests.Refresh_Token_Fails_When_Invalid [FAIL]
[xUnit.net 00:00:02.19]       System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
[xUnit.net 00:00:02.19]       Stack Trace:
[xUnit.net 00:00:02.19]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
[xUnit.net 00:00:02.19]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
[xUnit.net 00:00:02.19]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
[xUnit.net 00:00:02.19]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
[xUnit.net 00:00:02.19]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
[xUnit.net 00:00:02.19]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
[xUnit.net 00:00:02.19]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
[xUnit.net 00:00:02.19]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
[xUnit.net 00:00:02.19]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
[xUnit.net 00:00:02.19]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
[xUnit.net 00:00:02.19]            at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
[xUnit.net 00:00:02.19]         C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs(116,0): at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db)
[xUnit.net 00:00:02.19]         C:\workspace\bobcrm\src\BobCrm.Api\Program.cs(147,0): at Program.<Main>$(String[] args)
[xUnit.net 00:00:02.19]            at Program.<Main>(String[] args)
[xUnit.net 00:00:02.19]            at InvokeStub_Program.<Main>(Object, Span`1)
[xUnit.net 00:00:02.19]            at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
[xUnit.net 00:00:02.19]         --- End of stack trace from previous location ---
[xUnit.net 00:00:02.19]            at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
[xUnit.net 00:00:02.19]            at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
[xUnit.net 00:00:02.19]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:02.19]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs(35,0): at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:02.19]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
[xUnit.net 00:00:02.19]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
[xUnit.net 00:00:02.19]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:02.19]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:02.19]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:02.19]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:02.19]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\AuthBoundaryTests.cs(104,0): at BobCrm.Api.Tests.AuthBoundaryTests.Refresh_Token_Fails_When_Invalid()
[xUnit.net 00:00:02.19]         --- End of stack trace from previous location ---
[07:44:37 INF] ============================================
[07:44:37 INF] Application starting at 11/06/2025 07:44:37, log file: C:\workspace\bobcrm\tests\BobCrm.Api.Tests\bin\Debug\net8.0\..\..\logs\api_20251106_074437.log
[07:44:37 INF] ============================================
[07:44:37 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:37 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:37 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:37 INF] No migrations were applied. The database is already up to date.
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Customers" AS c)
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "FieldDefinitions" AS f)
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationLanguages" AS l)
[EntityMetadata] Step 1: Found 1 entity types implementing IEntityMetadataProvider
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[@__metadata_EntityType_0='?'], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
WHERE e."EntityType" = @__metadata_EntityType_0
LIMIT 1
[EntityMetadata] - Already exists: Customer
[EntityMetadata] Step 2: Validating existing metadata records...
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
[EntityMetadata] ? No changes needed (all in sync)
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationResources" AS l)
[xUnit.net 00:00:02.25]     BobCrm.Api.Tests.AuthBoundaryTests.Login_Fails_When_Email_Not_Confirmed [FAIL]
[xUnit.net 00:00:02.25]       System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
[xUnit.net 00:00:02.25]       Stack Trace:
[xUnit.net 00:00:02.25]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
[xUnit.net 00:00:02.25]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
[xUnit.net 00:00:02.25]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
[xUnit.net 00:00:02.25]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
[xUnit.net 00:00:02.25]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
[xUnit.net 00:00:02.25]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
[xUnit.net 00:00:02.25]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
[xUnit.net 00:00:02.25]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
[xUnit.net 00:00:02.25]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
[xUnit.net 00:00:02.25]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
[xUnit.net 00:00:02.25]            at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
[xUnit.net 00:00:02.25]         C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs(116,0): at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db)
[xUnit.net 00:00:02.25]         C:\workspace\bobcrm\src\BobCrm.Api\Program.cs(147,0): at Program.<Main>$(String[] args)
[xUnit.net 00:00:02.25]            at Program.<Main>(String[] args)
[xUnit.net 00:00:02.25]            at InvokeStub_Program.<Main>(Object, Span`1)
[xUnit.net 00:00:02.25]            at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
[xUnit.net 00:00:02.25]         --- End of stack trace from previous location ---
[xUnit.net 00:00:02.25]            at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
[xUnit.net 00:00:02.25]            at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
[xUnit.net 00:00:02.25]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:02.25]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs(35,0): at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:02.25]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
[xUnit.net 00:00:02.25]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
[xUnit.net 00:00:02.25]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:02.25]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:02.25]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:02.25]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:02.25]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\AuthBoundaryTests.cs(20,0): at BobCrm.Api.Tests.AuthBoundaryTests.Login_Fails_When_Email_Not_Confirmed()
[xUnit.net 00:00:02.25]         --- End of stack trace from previous location ---
[07:44:37 INF] ============================================
[07:44:37 INF] Application starting at 11/06/2025 07:44:37, log file: C:\workspace\bobcrm\tests\BobCrm.Api.Tests\bin\Debug\net8.0\..\..\logs\api_20251106_074437.log
[07:44:37 INF] ============================================
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:37 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:37 INF] No migrations were applied. The database is already up to date.
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Customers" AS c)
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "FieldDefinitions" AS f)
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationLanguages" AS l)
[EntityMetadata] Step 1: Found 1 entity types implementing IEntityMetadataProvider
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[@__metadata_EntityType_0='?'], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
WHERE e."EntityType" = @__metadata_EntityType_0
LIMIT 1
[EntityMetadata] - Already exists: Customer
[EntityMetadata] Step 2: Validating existing metadata records...
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
[EntityMetadata] ? No changes needed (all in sync)
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationResources" AS l)
[xUnit.net 00:00:02.31]     BobCrm.Api.Tests.AuthBoundaryTests.Refresh_Token_Works_When_Valid [FAIL]
[xUnit.net 00:00:02.31]       System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
[xUnit.net 00:00:02.31]       Stack Trace:
[xUnit.net 00:00:02.31]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
[xUnit.net 00:00:02.31]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
[xUnit.net 00:00:02.31]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
[xUnit.net 00:00:02.31]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
[xUnit.net 00:00:02.31]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
[xUnit.net 00:00:02.31]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
[xUnit.net 00:00:02.31]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
[xUnit.net 00:00:02.31]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
[xUnit.net 00:00:02.31]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
[xUnit.net 00:00:02.31]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
[xUnit.net 00:00:02.31]            at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
[xUnit.net 00:00:02.31]         C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs(116,0): at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db)
[xUnit.net 00:00:02.31]         C:\workspace\bobcrm\src\BobCrm.Api\Program.cs(147,0): at Program.<Main>$(String[] args)
[xUnit.net 00:00:02.31]            at Program.<Main>(String[] args)
[xUnit.net 00:00:02.31]            at InvokeStub_Program.<Main>(Object, Span`1)
[xUnit.net 00:00:02.31]            at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
[xUnit.net 00:00:02.31]         --- End of stack trace from previous location ---
[xUnit.net 00:00:02.31]            at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
[xUnit.net 00:00:02.31]            at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
[xUnit.net 00:00:02.31]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:02.31]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs(35,0): at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:02.31]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
[xUnit.net 00:00:02.31]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
[xUnit.net 00:00:02.31]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:02.31]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:02.31]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:02.31]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:02.31]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\AuthBoundaryTests.cs(82,0): at BobCrm.Api.Tests.AuthBoundaryTests.Refresh_Token_Works_When_Valid()
[xUnit.net 00:00:02.31]         --- End of stack trace from previous location ---
[07:44:37 INF] ============================================
[07:44:37 INF] Application starting at 11/06/2025 07:44:37, log file: C:\workspace\bobcrm\tests\BobCrm.Api.Tests\bin\Debug\net8.0\..\..\logs\api_20251106_074437.log
[07:44:37 INF] ============================================
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:37 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:37 INF] No migrations were applied. The database is already up to date.
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Customers" AS c)
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "FieldDefinitions" AS f)
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationLanguages" AS l)
[EntityMetadata] Step 1: Found 1 entity types implementing IEntityMetadataProvider
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[@__metadata_EntityType_0='?'], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
WHERE e."EntityType" = @__metadata_EntityType_0
LIMIT 1
[EntityMetadata] - Already exists: Customer
[EntityMetadata] Step 2: Validating existing metadata records...
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
[EntityMetadata] ? No changes needed (all in sync)
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationResources" AS l)
[xUnit.net 00:00:02.37]     BobCrm.Api.Tests.AuthBoundaryTests.Session_Endpoint_Requires_Auth [FAIL]
[xUnit.net 00:00:02.37]       System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
[xUnit.net 00:00:02.37]       Stack Trace:
[xUnit.net 00:00:02.37]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
[xUnit.net 00:00:02.37]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
[xUnit.net 00:00:02.37]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
[xUnit.net 00:00:02.37]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
[xUnit.net 00:00:02.37]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
[xUnit.net 00:00:02.37]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
[xUnit.net 00:00:02.37]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
[xUnit.net 00:00:02.37]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
[xUnit.net 00:00:02.37]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
[xUnit.net 00:00:02.37]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
[xUnit.net 00:00:02.37]            at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
[xUnit.net 00:00:02.37]         C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs(116,0): at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db)
[xUnit.net 00:00:02.37]         C:\workspace\bobcrm\src\BobCrm.Api\Program.cs(147,0): at Program.<Main>$(String[] args)
[xUnit.net 00:00:02.37]            at Program.<Main>(String[] args)
[xUnit.net 00:00:02.37]            at InvokeStub_Program.<Main>(Object, Span`1)
[xUnit.net 00:00:02.37]            at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
[xUnit.net 00:00:02.37]         --- End of stack trace from previous location ---
[xUnit.net 00:00:02.37]            at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
[xUnit.net 00:00:02.37]            at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
[xUnit.net 00:00:02.37]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:02.37]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs(35,0): at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:02.37]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
[xUnit.net 00:00:02.37]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
[xUnit.net 00:00:02.37]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:02.37]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:02.37]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:02.37]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:02.37]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\AuthBoundaryTests.cs(155,0): at BobCrm.Api.Tests.AuthBoundaryTests.Session_Endpoint_Requires_Auth()
[xUnit.net 00:00:02.37]         --- End of stack trace from previous location ---
[07:44:37 INF] ============================================
[07:44:37 INF] Application starting at 11/06/2025 07:44:37, log file: C:\workspace\bobcrm\tests\BobCrm.Api.Tests\bin\Debug\net8.0\..\..\logs\api_20251106_074437.log
[07:44:37 INF] ============================================
[07:44:37 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:37 INF] No migrations were applied. The database is already up to date.
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Customers" AS c)
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "FieldDefinitions" AS f)
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationLanguages" AS l)
[EntityMetadata] Step 1: Found 1 entity types implementing IEntityMetadataProvider
[07:44:37 INF] Executed DbCommand (2ms) [Parameters=[@__metadata_EntityType_0='?'], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
WHERE e."EntityType" = @__metadata_EntityType_0
LIMIT 1
[EntityMetadata] - Already exists: Customer
[EntityMetadata] Step 2: Validating existing metadata records...
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
[EntityMetadata] ? No changes needed (all in sync)
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationResources" AS l)
[xUnit.net 00:00:02.43]     BobCrm.Api.Tests.AuthBoundaryTests.Refresh_Token_Fails_After_Revocation [FAIL]
[xUnit.net 00:00:02.43]       System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
[xUnit.net 00:00:02.43]       Stack Trace:
[xUnit.net 00:00:02.43]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
[xUnit.net 00:00:02.43]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
[xUnit.net 00:00:02.43]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
[xUnit.net 00:00:02.43]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
[xUnit.net 00:00:02.43]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
[xUnit.net 00:00:02.43]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
[xUnit.net 00:00:02.43]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
[xUnit.net 00:00:02.43]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
[xUnit.net 00:00:02.43]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
[xUnit.net 00:00:02.43]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
[xUnit.net 00:00:02.43]            at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
[xUnit.net 00:00:02.43]         C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs(116,0): at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db)
[xUnit.net 00:00:02.43]         C:\workspace\bobcrm\src\BobCrm.Api\Program.cs(147,0): at Program.<Main>$(String[] args)
[xUnit.net 00:00:02.43]            at Program.<Main>(String[] args)
[xUnit.net 00:00:02.43]            at InvokeStub_Program.<Main>(Object, Span`1)
[xUnit.net 00:00:02.43]            at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
[xUnit.net 00:00:02.43]         --- End of stack trace from previous location ---
[xUnit.net 00:00:02.43]            at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
[xUnit.net 00:00:02.43]            at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
[xUnit.net 00:00:02.43]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:02.43]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs(35,0): at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:02.43]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
[xUnit.net 00:00:02.43]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
[xUnit.net 00:00:02.43]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:02.43]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:02.43]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:02.43]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:02.43]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\AuthBoundaryTests.cs(115,0): at BobCrm.Api.Tests.AuthBoundaryTests.Refresh_Token_Fails_After_Revocation()
[xUnit.net 00:00:02.43]         --- End of stack trace from previous location ---
  謌仙粥 BobCrm.Api.Tests.QueriesUnitTests.FieldQueries_Parses_Tags_And_Actions [30 ms]
  謌仙粥 BobCrm.Api.Tests.QueriesUnitTests.LayoutQueries_User_Default_Effective [10 ms]
  螟ｱ謨・BobCrm.Api.Tests.AuthFlowTests.Register_Activate_Login_Succeeds [62 ms]
  繧ｨ繝ｩ繝ｼ 繝｡繝・そ繝ｼ繧ｸ:
   System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
  繧ｹ繧ｿ繝・け 繝医Ξ繝ｼ繧ｹ:
     at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
   at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db) in C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs:line 116
   at Program.<Main>$(String[] args) in C:\workspace\bobcrm\src\BobCrm.Api\Program.cs:line 147
   at Program.<Main>(String[] args)
   at InvokeStub_Program.<Main>(Object, Span`1)
   at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
   at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder) in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs:line 35
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at BobCrm.Api.Tests.AuthFlowTests.Register_Activate_Login_Succeeds() in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\AuthFlowTests.cs:line 16
--- End of stack trace from previous location ---
  螟ｱ謨・BobCrm.Api.Tests.AuthBoundaryTests.Login_Fails_With_Nonexistent_Username [63 ms]
  繧ｨ繝ｩ繝ｼ 繝｡繝・そ繝ｼ繧ｸ:
   System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
  繧ｹ繧ｿ繝・け 繝医Ξ繝ｼ繧ｹ:
     at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
   at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db) in C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs:line 116
   at Program.<Main>$(String[] args) in C:\workspace\bobcrm\src\BobCrm.Api\Program.cs:line 147
   at Program.<Main>(String[] args)
   at InvokeStub_Program.<Main>(Object, Span`1)
   at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
   at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder) in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs:line 35
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at BobCrm.Api.Tests.AuthBoundaryTests.Login_Fails_With_Nonexistent_Username() in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\AuthBoundaryTests.cs:line 67
--- End of stack trace from previous location ---
  螟ｱ謨・BobCrm.Api.Tests.AuthBoundaryTests.Refresh_Token_Fails_When_Invalid [51 ms]
  繧ｨ繝ｩ繝ｼ 繝｡繝・そ繝ｼ繧ｸ:
   System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
  繧ｹ繧ｿ繝・け 繝医Ξ繝ｼ繧ｹ:
     at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
   at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db) in C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs:line 116
   at Program.<Main>$(String[] args) in C:\workspace\bobcrm\src\BobCrm.Api\Program.cs:line 147
   at Program.<Main>(String[] args)
   at InvokeStub_Program.<Main>(Object, Span`1)
   at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
   at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder) in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs:line 35
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at BobCrm.Api.Tests.AuthBoundaryTests.Refresh_Token_Fails_When_Invalid() in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\AuthBoundaryTests.cs:line 104
--- End of stack trace from previous location ---
  螟ｱ謨・BobCrm.Api.Tests.AuthBoundaryTests.Login_Fails_When_Email_Not_Confirmed [53 ms]
  繧ｨ繝ｩ繝ｼ 繝｡繝・そ繝ｼ繧ｸ:
   System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
  繧ｹ繧ｿ繝・け 繝医Ξ繝ｼ繧ｹ:
     at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
   at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db) in C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs:line 116
   at Program.<Main>$(String[] args) in C:\workspace\bobcrm\src\BobCrm.Api\Program.cs:line 147
   at Program.<Main>(String[] args)
   at InvokeStub_Program.<Main>(Object, Span`1)
   at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
   at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder) in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs:line 35
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at BobCrm.Api.Tests.AuthBoundaryTests.Login_Fails_When_Email_Not_Confirmed() in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\AuthBoundaryTests.cs:line 20
--- End of stack trace from previous location ---
  螟ｱ謨・BobCrm.Api.Tests.AuthBoundaryTests.Refresh_Token_Works_When_Valid [57 ms]
  繧ｨ繝ｩ繝ｼ 繝｡繝・そ繝ｼ繧ｸ:
   System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
  繧ｹ繧ｿ繝・け 繝医Ξ繝ｼ繧ｹ:
     at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
   at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db) in C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs:line 116
   at Program.<Main>$(String[] args) in C:\workspace\bobcrm\src\BobCrm.Api\Program.cs:line 147
   at Program.<Main>(String[] args)
   at InvokeStub_Program.<Main>(Object, Span`1)
   at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
   at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder) in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs:line 35
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at BobCrm.Api.Tests.AuthBoundaryTests.Refresh_Token_Works_When_Valid() in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\AuthBoundaryTests.cs:line 82
--- End of stack trace from previous location ---
  螟ｱ謨・BobCrm.Api.Tests.AuthBoundaryTests.Session_Endpoint_Requires_Auth [59 ms]
  繧ｨ繝ｩ繝ｼ 繝｡繝・そ繝ｼ繧ｸ:
   System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
  繧ｹ繧ｿ繝・け 繝医Ξ繝ｼ繧ｹ:
     at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
   at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db) in C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs:line 116
   at Program.<Main>$(String[] args) in C:\workspace\bobcrm\src\BobCrm.Api\Program.cs:line 147
   at Program.<Main>(String[] args)
   at InvokeStub_Program.<Main>(Object, Span`1)
   at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
   at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder) in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs:line 35
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at BobCrm.Api.Tests.AuthBoundaryTests.Session_Endpoint_Requires_Auth() in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\AuthBoundaryTests.cs:line 155
--- End of stack trace from previous location ---
  螟ｱ謨・BobCrm.Api.Tests.AuthBoundaryTests.Refresh_Token_Fails_After_Revocation [59 ms]
  繧ｨ繝ｩ繝ｼ 繝｡繝・そ繝ｼ繧ｸ:
   System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
  繧ｹ繧ｿ繝・け 繝医Ξ繝ｼ繧ｹ:
     at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
   at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db) in C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs:line 116
   at Program.<Main>$(String[] args) in C:\workspace\bobcrm\src\BobCrm.Api\Program.cs:line 147
   at Program.<Main>(String[] args)
   at InvokeStub_Program.<Main>(Object, Span`1)
   at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
   at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder) in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs:line 35
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at BobCrm.Api.Tests.AuthBoundaryTests.Refresh_Token_Fails_After_Revocation() in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\AuthBoundaryTests.cs:line 115
--- End of stack trace from previous location ---
[07:44:37 INF] ============================================
[07:44:37 INF] Application starting at 11/06/2025 07:44:37, log file: C:\workspace\bobcrm\tests\BobCrm.Api.Tests\bin\Debug\net8.0\..\..\logs\api_20251106_074437.log
[07:44:37 INF] ============================================
[07:44:37 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:37 INF] No migrations were applied. The database is already up to date.
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Customers" AS c)
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "FieldDefinitions" AS f)
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationLanguages" AS l)
[EntityMetadata] Step 1: Found 1 entity types implementing IEntityMetadataProvider
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[@__metadata_EntityType_0='?'], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
WHERE e."EntityType" = @__metadata_EntityType_0
LIMIT 1
[EntityMetadata] - Already exists: Customer
[EntityMetadata] Step 2: Validating existing metadata records...
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
[EntityMetadata] ? No changes needed (all in sync)
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationResources" AS l)
[xUnit.net 00:00:02.48]     BobCrm.Api.Tests.AuthBoundaryTests.Login_By_Email_Also_Works [FAIL]
[xUnit.net 00:00:02.48]       System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
[xUnit.net 00:00:02.48]       Stack Trace:
[xUnit.net 00:00:02.48]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
[xUnit.net 00:00:02.48]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
[xUnit.net 00:00:02.48]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
[xUnit.net 00:00:02.48]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
[xUnit.net 00:00:02.48]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
[xUnit.net 00:00:02.48]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
[xUnit.net 00:00:02.49]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
[xUnit.net 00:00:02.49]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
[xUnit.net 00:00:02.49]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
[xUnit.net 00:00:02.49]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
[xUnit.net 00:00:02.49]            at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
[xUnit.net 00:00:02.49]         C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs(116,0): at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db)
[xUnit.net 00:00:02.49]         C:\workspace\bobcrm\src\BobCrm.Api\Program.cs(147,0): at Program.<Main>$(String[] args)
[xUnit.net 00:00:02.49]            at Program.<Main>(String[] args)
[xUnit.net 00:00:02.49]            at InvokeStub_Program.<Main>(Object, Span`1)
[xUnit.net 00:00:02.49]            at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
[xUnit.net 00:00:02.49]         --- End of stack trace from previous location ---
[xUnit.net 00:00:02.49]            at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
[xUnit.net 00:00:02.49]            at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
[xUnit.net 00:00:02.49]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:02.49]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs(35,0): at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:02.49]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
[xUnit.net 00:00:02.49]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
[xUnit.net 00:00:02.49]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:02.49]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:02.49]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:02.49]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:02.49]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\AuthBoundaryTests.cs(165,0): at BobCrm.Api.Tests.AuthBoundaryTests.Login_By_Email_Also_Works()
[xUnit.net 00:00:02.49]         --- End of stack trace from previous location ---
[07:44:37 INF] ============================================
[07:44:37 INF] Application starting at 11/06/2025 07:44:37, log file: C:\workspace\bobcrm\tests\BobCrm.Api.Tests\bin\Debug\net8.0\..\..\logs\api_20251106_074437.log
[07:44:37 INF] ============================================
[07:44:37 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:37 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:37 INF] No migrations were applied. The database is already up to date.
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Customers" AS c)
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "FieldDefinitions" AS f)
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationLanguages" AS l)
[EntityMetadata] Step 1: Found 1 entity types implementing IEntityMetadataProvider
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[@__metadata_EntityType_0='?'], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
WHERE e."EntityType" = @__metadata_EntityType_0
LIMIT 1
[EntityMetadata] - Already exists: Customer
[EntityMetadata] Step 2: Validating existing metadata records...
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
[EntityMetadata] ? No changes needed (all in sync)
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationResources" AS l)
[xUnit.net 00:00:02.55]     BobCrm.Api.Tests.AuthBoundaryTests.Login_Fails_With_Wrong_Password [FAIL]
[xUnit.net 00:00:02.55]       System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
[xUnit.net 00:00:02.55]       Stack Trace:
[xUnit.net 00:00:02.55]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
[xUnit.net 00:00:02.55]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
[xUnit.net 00:00:02.55]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
[xUnit.net 00:00:02.55]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
[xUnit.net 00:00:02.55]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
[xUnit.net 00:00:02.55]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
[xUnit.net 00:00:02.55]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
[xUnit.net 00:00:02.55]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
[xUnit.net 00:00:02.55]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
[xUnit.net 00:00:02.55]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
[xUnit.net 00:00:02.55]            at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
[xUnit.net 00:00:02.55]         C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs(116,0): at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db)
[xUnit.net 00:00:02.55]         C:\workspace\bobcrm\src\BobCrm.Api\Program.cs(147,0): at Program.<Main>$(String[] args)
[xUnit.net 00:00:02.55]            at Program.<Main>(String[] args)
[xUnit.net 00:00:02.55]            at InvokeStub_Program.<Main>(Object, Span`1)
[xUnit.net 00:00:02.55]            at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
[xUnit.net 00:00:02.55]         --- End of stack trace from previous location ---
[xUnit.net 00:00:02.55]            at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
[xUnit.net 00:00:02.55]            at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
[xUnit.net 00:00:02.55]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:02.55]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs(35,0): at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:02.55]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
[xUnit.net 00:00:02.55]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
[xUnit.net 00:00:02.55]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:02.55]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:02.55]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:02.55]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:02.55]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\AuthBoundaryTests.cs(41,0): at BobCrm.Api.Tests.AuthBoundaryTests.Login_Fails_With_Wrong_Password()
[xUnit.net 00:00:02.55]         --- End of stack trace from previous location ---
[07:44:37 INF] ============================================
[07:44:37 INF] Application starting at 11/06/2025 07:44:37, log file: C:\workspace\bobcrm\tests\BobCrm.Api.Tests\bin\Debug\net8.0\..\..\logs\api_20251106_074437.log
[07:44:37 INF] ============================================
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:37 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:37 INF] No migrations were applied. The database is already up to date.
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Customers" AS c)
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "FieldDefinitions" AS f)
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationLanguages" AS l)
[EntityMetadata] Step 1: Found 1 entity types implementing IEntityMetadataProvider
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[@__metadata_EntityType_0='?'], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
WHERE e."EntityType" = @__metadata_EntityType_0
LIMIT 1
[EntityMetadata] - Already exists: Customer
[EntityMetadata] Step 2: Validating existing metadata records...
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
[EntityMetadata] ? No changes needed (all in sync)
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationResources" AS l)
[xUnit.net 00:00:02.61]     BobCrm.Api.Tests.AuthBoundaryTests.Session_Endpoint_Returns_Valid_For_Authenticated_User [FAIL]
[xUnit.net 00:00:02.61]       System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
[xUnit.net 00:00:02.61]       Stack Trace:
[xUnit.net 00:00:02.61]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
[xUnit.net 00:00:02.61]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
[xUnit.net 00:00:02.61]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
[xUnit.net 00:00:02.61]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
[xUnit.net 00:00:02.61]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
[xUnit.net 00:00:02.61]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
[xUnit.net 00:00:02.61]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
[xUnit.net 00:00:02.61]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
[xUnit.net 00:00:02.61]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
[xUnit.net 00:00:02.61]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
[xUnit.net 00:00:02.61]            at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
[xUnit.net 00:00:02.61]         C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs(116,0): at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db)
[xUnit.net 00:00:02.61]         C:\workspace\bobcrm\src\BobCrm.Api\Program.cs(147,0): at Program.<Main>$(String[] args)
[xUnit.net 00:00:02.61]            at Program.<Main>(String[] args)
[xUnit.net 00:00:02.61]            at InvokeStub_Program.<Main>(Object, Span`1)
[xUnit.net 00:00:02.61]            at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
[xUnit.net 00:00:02.61]         --- End of stack trace from previous location ---
[xUnit.net 00:00:02.61]            at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
[xUnit.net 00:00:02.61]            at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
[xUnit.net 00:00:02.61]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:02.61]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs(35,0): at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:02.61]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
[xUnit.net 00:00:02.61]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
[xUnit.net 00:00:02.61]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:02.61]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:02.61]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:02.61]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:02.61]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\AuthBoundaryTests.cs(142,0): at BobCrm.Api.Tests.AuthBoundaryTests.Session_Endpoint_Returns_Valid_For_Authenticated_User()
[xUnit.net 00:00:02.61]         --- End of stack trace from previous location ---
[07:44:37 INF] ============================================
[07:44:37 INF] Application starting at 11/06/2025 07:44:37, log file: C:\workspace\bobcrm\tests\BobCrm.Api.Tests\bin\Debug\net8.0\..\..\logs\api_20251106_074437.log
[07:44:37 INF] ============================================
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:37 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:37 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:37 INF] No migrations were applied. The database is already up to date.
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Customers" AS c)
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "FieldDefinitions" AS f)
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationLanguages" AS l)
[EntityMetadata] Step 1: Found 1 entity types implementing IEntityMetadataProvider
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[@__metadata_EntityType_0='?'], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
WHERE e."EntityType" = @__metadata_EntityType_0
LIMIT 1
[EntityMetadata] - Already exists: Customer
[EntityMetadata] Step 2: Validating existing metadata records...
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
[EntityMetadata] ? No changes needed (all in sync)
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationResources" AS l)
[xUnit.net 00:00:02.67]     BobCrm.Api.Tests.AuthBoundaryTests.Login_Empty_Username_Returns_BadRequest [FAIL]
[xUnit.net 00:00:02.67]       System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
[xUnit.net 00:00:02.67]       Stack Trace:
[xUnit.net 00:00:02.67]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
[xUnit.net 00:00:02.67]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
[xUnit.net 00:00:02.67]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
[xUnit.net 00:00:02.67]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
[xUnit.net 00:00:02.67]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
[xUnit.net 00:00:02.67]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
[xUnit.net 00:00:02.67]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
[xUnit.net 00:00:02.67]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
[xUnit.net 00:00:02.67]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
[xUnit.net 00:00:02.67]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
[xUnit.net 00:00:02.67]            at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
[xUnit.net 00:00:02.67]         C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs(116,0): at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db)
[xUnit.net 00:00:02.67]         C:\workspace\bobcrm\src\BobCrm.Api\Program.cs(147,0): at Program.<Main>$(String[] args)
[xUnit.net 00:00:02.67]            at Program.<Main>(String[] args)
[xUnit.net 00:00:02.67]            at InvokeStub_Program.<Main>(Object, Span`1)
[xUnit.net 00:00:02.67]            at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
[xUnit.net 00:00:02.67]         --- End of stack trace from previous location ---
[xUnit.net 00:00:02.67]            at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
[xUnit.net 00:00:02.67]            at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
[xUnit.net 00:00:02.67]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:02.67]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs(35,0): at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:02.67]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
[xUnit.net 00:00:02.67]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
[xUnit.net 00:00:02.67]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:02.67]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:02.67]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:02.67]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:02.67]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\AuthBoundaryTests.cs(131,0): at BobCrm.Api.Tests.AuthBoundaryTests.Login_Empty_Username_Returns_BadRequest()
[xUnit.net 00:00:02.67]         --- End of stack trace from previous location ---
[07:44:37 INF] ============================================
[07:44:37 INF] Application starting at 11/06/2025 07:44:37, log file: C:\workspace\bobcrm\tests\BobCrm.Api.Tests\bin\Debug\net8.0\..\..\logs\api_20251106_074437.log
[07:44:37 INF] ============================================
[07:44:37 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:37 INF] Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:37 INF] No migrations were applied. The database is already up to date.
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Customers" AS c)
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "FieldDefinitions" AS f)
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationLanguages" AS l)
[EntityMetadata] Step 1: Found 1 entity types implementing IEntityMetadataProvider
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[@__metadata_EntityType_0='?'], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
WHERE e."EntityType" = @__metadata_EntityType_0
LIMIT 1
[EntityMetadata] - Already exists: Customer
[EntityMetadata] Step 2: Validating existing metadata records...
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
[EntityMetadata] ? No changes needed (all in sync)
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationResources" AS l)
[xUnit.net 00:00:02.73]     BobCrm.Api.Tests.I18nCacheTests.I18n_Resources_Endpoint_Requires_Auth [FAIL]
[xUnit.net 00:00:02.73]       System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
[xUnit.net 00:00:02.73]       Stack Trace:
[xUnit.net 00:00:02.73]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
[xUnit.net 00:00:02.73]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
[xUnit.net 00:00:02.73]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
[xUnit.net 00:00:02.73]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
[xUnit.net 00:00:02.73]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
[xUnit.net 00:00:02.73]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
[xUnit.net 00:00:02.73]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
[xUnit.net 00:00:02.73]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
[xUnit.net 00:00:02.73]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
[xUnit.net 00:00:02.73]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
[xUnit.net 00:00:02.73]            at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
[xUnit.net 00:00:02.73]         C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs(116,0): at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db)
[xUnit.net 00:00:02.73]         C:\workspace\bobcrm\src\BobCrm.Api\Program.cs(147,0): at Program.<Main>$(String[] args)
[xUnit.net 00:00:02.74]            at Program.<Main>(String[] args)
[xUnit.net 00:00:02.74]            at InvokeStub_Program.<Main>(Object, Span`1)
[xUnit.net 00:00:02.74]            at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
[xUnit.net 00:00:02.74]         --- End of stack trace from previous location ---
[xUnit.net 00:00:02.74]            at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
[xUnit.net 00:00:02.74]            at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
[xUnit.net 00:00:02.74]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:02.74]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs(35,0): at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:02.74]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
[xUnit.net 00:00:02.74]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
[xUnit.net 00:00:02.74]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:02.74]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:02.74]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:02.74]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:02.74]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\I18nCacheTests.cs(99,0): at BobCrm.Api.Tests.I18nCacheTests.I18n_Resources_Endpoint_Requires_Auth()
[xUnit.net 00:00:02.74]         --- End of stack trace from previous location ---
[07:44:37 INF] ============================================
[07:44:37 INF] Application starting at 11/06/2025 07:44:37, log file: C:\workspace\bobcrm\tests\BobCrm.Api.Tests\bin\Debug\net8.0\..\..\logs\api_20251106_074437.log
[07:44:37 INF] ============================================
[07:44:37 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:37 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:37 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:37 INF] No migrations were applied. The database is already up to date.
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Customers" AS c)
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "FieldDefinitions" AS f)
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationLanguages" AS l)
[EntityMetadata] Step 1: Found 1 entity types implementing IEntityMetadataProvider
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[@__metadata_EntityType_0='?'], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
WHERE e."EntityType" = @__metadata_EntityType_0
LIMIT 1
[EntityMetadata] - Already exists: Customer
[EntityMetadata] Step 2: Validating existing metadata records...
[07:44:37 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
[EntityMetadata] ? No changes needed (all in sync)
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationResources" AS l)
[xUnit.net 00:00:02.80]     BobCrm.Api.Tests.I18nCacheTests.I18n_Resources_With_Auth_Returns_ETag [FAIL]
[xUnit.net 00:00:02.80]       System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
[xUnit.net 00:00:02.80]       Stack Trace:
[xUnit.net 00:00:02.80]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
[xUnit.net 00:00:02.80]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
[xUnit.net 00:00:02.80]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
[xUnit.net 00:00:02.80]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
[xUnit.net 00:00:02.80]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
[xUnit.net 00:00:02.80]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
[xUnit.net 00:00:02.80]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
[xUnit.net 00:00:02.80]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
[xUnit.net 00:00:02.80]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
[xUnit.net 00:00:02.80]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
[xUnit.net 00:00:02.80]            at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
[xUnit.net 00:00:02.80]         C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs(116,0): at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db)
[xUnit.net 00:00:02.80]         C:\workspace\bobcrm\src\BobCrm.Api\Program.cs(147,0): at Program.<Main>$(String[] args)
[xUnit.net 00:00:02.80]            at Program.<Main>(String[] args)
[xUnit.net 00:00:02.80]            at InvokeStub_Program.<Main>(Object, Span`1)
[xUnit.net 00:00:02.80]            at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
[xUnit.net 00:00:02.80]         --- End of stack trace from previous location ---
[xUnit.net 00:00:02.80]            at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
[xUnit.net 00:00:02.80]            at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
[xUnit.net 00:00:02.80]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:02.80]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs(35,0): at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:02.80]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
[xUnit.net 00:00:02.80]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
[xUnit.net 00:00:02.80]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:02.80]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:02.80]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:02.80]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:02.80]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\I18nCacheTests.cs(109,0): at BobCrm.Api.Tests.I18nCacheTests.I18n_Resources_With_Auth_Returns_ETag()
[xUnit.net 00:00:02.80]         --- End of stack trace from previous location ---
[07:44:37 INF] ============================================
[07:44:37 INF] Application starting at 11/06/2025 07:44:37, log file: C:\workspace\bobcrm\tests\BobCrm.Api.Tests\bin\Debug\net8.0\..\..\logs\api_20251106_074437.log
[07:44:37 INF] ============================================
[07:44:37 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:37 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:37 INF] No migrations were applied. The database is already up to date.
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Customers" AS c)
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "FieldDefinitions" AS f)
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationLanguages" AS l)
[EntityMetadata] Step 1: Found 1 entity types implementing IEntityMetadataProvider
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[@__metadata_EntityType_0='?'], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
WHERE e."EntityType" = @__metadata_EntityType_0
LIMIT 1
[EntityMetadata] - Already exists: Customer
[EntityMetadata] Step 2: Validating existing metadata records...
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
[EntityMetadata] ? No changes needed (all in sync)
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationResources" AS l)
[xUnit.net 00:00:02.87]     BobCrm.Api.Tests.I18nCacheTests.I18n_Version_Returns_Consistent_Value [FAIL]
[xUnit.net 00:00:02.87]       System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
[xUnit.net 00:00:02.87]       Stack Trace:
[xUnit.net 00:00:02.87]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
[xUnit.net 00:00:02.87]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
[xUnit.net 00:00:02.87]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
[xUnit.net 00:00:02.87]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
[xUnit.net 00:00:02.87]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
[xUnit.net 00:00:02.87]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
[xUnit.net 00:00:02.87]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
[xUnit.net 00:00:02.87]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
[xUnit.net 00:00:02.87]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
[xUnit.net 00:00:02.87]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
[xUnit.net 00:00:02.87]            at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
[xUnit.net 00:00:02.87]         C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs(116,0): at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db)
[xUnit.net 00:00:02.87]         C:\workspace\bobcrm\src\BobCrm.Api\Program.cs(147,0): at Program.<Main>$(String[] args)
[xUnit.net 00:00:02.87]            at Program.<Main>(String[] args)
[xUnit.net 00:00:02.87]            at InvokeStub_Program.<Main>(Object, Span`1)
[xUnit.net 00:00:02.87]            at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
[xUnit.net 00:00:02.87]         --- End of stack trace from previous location ---
[xUnit.net 00:00:02.87]            at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
[xUnit.net 00:00:02.87]            at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
[xUnit.net 00:00:02.87]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:02.87]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs(35,0): at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:02.87]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
[xUnit.net 00:00:02.87]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
[xUnit.net 00:00:02.87]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:02.87]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:02.87]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:02.87]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:02.87]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\I18nCacheTests.cs(46,0): at BobCrm.Api.Tests.I18nCacheTests.I18n_Version_Returns_Consistent_Value()
[xUnit.net 00:00:02.87]         --- End of stack trace from previous location ---
[07:44:37 INF] ============================================
[07:44:37 INF] Application starting at 11/06/2025 07:44:37, log file: C:\workspace\bobcrm\tests\BobCrm.Api.Tests\bin\Debug\net8.0\..\..\logs\api_20251106_074437.log
[07:44:37 INF] ============================================
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:37 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:37 INF] Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:37 INF] No migrations were applied. The database is already up to date.
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Customers" AS c)
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "FieldDefinitions" AS f)
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationLanguages" AS l)
[EntityMetadata] Step 1: Found 1 entity types implementing IEntityMetadataProvider
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[@__metadata_EntityType_0='?'], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
WHERE e."EntityType" = @__metadata_EntityType_0
LIMIT 1
[EntityMetadata] - Already exists: Customer
[EntityMetadata] Step 2: Validating existing metadata records...
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
[EntityMetadata] ? No changes needed (all in sync)
[07:44:37 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationResources" AS l)
[xUnit.net 00:00:02.94]     BobCrm.Api.Tests.I18nCacheTests.I18n_ETag_Returns_304_When_Not_Modified [FAIL]
[xUnit.net 00:00:02.94]       System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
[xUnit.net 00:00:02.94]       Stack Trace:
[xUnit.net 00:00:02.94]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
[xUnit.net 00:00:02.94]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
[xUnit.net 00:00:02.94]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
[xUnit.net 00:00:02.94]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
[xUnit.net 00:00:02.94]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
[xUnit.net 00:00:02.94]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
[xUnit.net 00:00:02.94]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
[xUnit.net 00:00:02.94]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
[xUnit.net 00:00:02.94]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
[xUnit.net 00:00:02.94]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
[xUnit.net 00:00:02.94]            at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
[xUnit.net 00:00:02.94]         C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs(116,0): at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db)
[xUnit.net 00:00:02.94]         C:\workspace\bobcrm\src\BobCrm.Api\Program.cs(147,0): at Program.<Main>$(String[] args)
[xUnit.net 00:00:02.94]            at Program.<Main>(String[] args)
[xUnit.net 00:00:02.94]            at InvokeStub_Program.<Main>(Object, Span`1)
[xUnit.net 00:00:02.94]            at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
[xUnit.net 00:00:02.94]         --- End of stack trace from previous location ---
[xUnit.net 00:00:02.94]            at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
[xUnit.net 00:00:02.94]            at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
[xUnit.net 00:00:02.94]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:02.94]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs(35,0): at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:02.94]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
[xUnit.net 00:00:02.94]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
[xUnit.net 00:00:02.94]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:02.94]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:02.94]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:02.94]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:02.94]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\I18nCacheTests.cs(18,0): at BobCrm.Api.Tests.I18nCacheTests.I18n_ETag_Returns_304_When_Not_Modified()
[xUnit.net 00:00:02.94]         --- End of stack trace from previous location ---
[07:44:37 INF] ============================================
[07:44:37 INF] Application starting at 11/06/2025 07:44:37, log file: C:\workspace\bobcrm\tests\BobCrm.Api.Tests\bin\Debug\net8.0\..\..\logs\api_20251106_074437.log
[07:44:37 INF] ============================================
[07:44:38 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:38 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:38 INF] No migrations were applied. The database is already up to date.
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Customers" AS c)
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "FieldDefinitions" AS f)
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationLanguages" AS l)
[EntityMetadata] Step 1: Found 1 entity types implementing IEntityMetadataProvider
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[@__metadata_EntityType_0='?'], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
WHERE e."EntityType" = @__metadata_EntityType_0
LIMIT 1
[EntityMetadata] - Already exists: Customer
[EntityMetadata] Step 2: Validating existing metadata records...
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
[EntityMetadata] ? No changes needed (all in sync)
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationResources" AS l)
[xUnit.net 00:00:03.00]     BobCrm.Api.Tests.I18nCacheTests.I18n_Different_Languages_Have_Different_ETags [FAIL]
[xUnit.net 00:00:03.00]       System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
[xUnit.net 00:00:03.00]       Stack Trace:
[xUnit.net 00:00:03.00]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
[xUnit.net 00:00:03.00]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
[xUnit.net 00:00:03.00]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
[xUnit.net 00:00:03.00]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
[xUnit.net 00:00:03.00]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
[xUnit.net 00:00:03.00]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
[xUnit.net 00:00:03.00]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
[xUnit.net 00:00:03.00]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
[xUnit.net 00:00:03.00]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
[xUnit.net 00:00:03.00]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
[xUnit.net 00:00:03.00]            at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
[xUnit.net 00:00:03.00]         C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs(116,0): at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db)
[xUnit.net 00:00:03.00]         C:\workspace\bobcrm\src\BobCrm.Api\Program.cs(147,0): at Program.<Main>$(String[] args)
[xUnit.net 00:00:03.00]            at Program.<Main>(String[] args)
[xUnit.net 00:00:03.00]            at InvokeStub_Program.<Main>(Object, Span`1)
[xUnit.net 00:00:03.00]            at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
[xUnit.net 00:00:03.00]         --- End of stack trace from previous location ---
[xUnit.net 00:00:03.00]            at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
[xUnit.net 00:00:03.00]            at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
[xUnit.net 00:00:03.00]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:03.00]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs(35,0): at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:03.00]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
[xUnit.net 00:00:03.00]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
[xUnit.net 00:00:03.00]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:03.00]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:03.00]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:03.00]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:03.00]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\I18nCacheTests.cs(78,0): at BobCrm.Api.Tests.I18nCacheTests.I18n_Different_Languages_Have_Different_ETags()
[xUnit.net 00:00:03.00]         --- End of stack trace from previous location ---
  螟ｱ謨・BobCrm.Api.Tests.AuthBoundaryTests.Login_By_Email_Also_Works [57 ms]
  繧ｨ繝ｩ繝ｼ 繝｡繝・そ繝ｼ繧ｸ:
   System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
  繧ｹ繧ｿ繝・け 繝医Ξ繝ｼ繧ｹ:
     at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
   at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db) in C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs:line 116
   at Program.<Main>$(String[] args) in C:\workspace\bobcrm\src\BobCrm.Api\Program.cs:line 147
   at Program.<Main>(String[] args)
   at InvokeStub_Program.<Main>(Object, Span`1)
   at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
   at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder) in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs:line 35
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at BobCrm.Api.Tests.AuthBoundaryTests.Login_By_Email_Also_Works() in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\AuthBoundaryTests.cs:line 165
--- End of stack trace from previous location ---
  螟ｱ謨・BobCrm.Api.Tests.AuthBoundaryTests.Login_Fails_With_Wrong_Password [59 ms]
  繧ｨ繝ｩ繝ｼ 繝｡繝・そ繝ｼ繧ｸ:
   System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
  繧ｹ繧ｿ繝・け 繝医Ξ繝ｼ繧ｹ:
     at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
   at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db) in C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs:line 116
   at Program.<Main>$(String[] args) in C:\workspace\bobcrm\src\BobCrm.Api\Program.cs:line 147
   at Program.<Main>(String[] args)
   at InvokeStub_Program.<Main>(Object, Span`1)
   at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
   at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder) in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs:line 35
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at BobCrm.Api.Tests.AuthBoundaryTests.Login_Fails_With_Wrong_Password() in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\AuthBoundaryTests.cs:line 41
--- End of stack trace from previous location ---
  螟ｱ謨・BobCrm.Api.Tests.AuthBoundaryTests.Session_Endpoint_Returns_Valid_For_Authenticated_User [62 ms]
  繧ｨ繝ｩ繝ｼ 繝｡繝・そ繝ｼ繧ｸ:
   System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
  繧ｹ繧ｿ繝・け 繝医Ξ繝ｼ繧ｹ:
     at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
   at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db) in C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs:line 116
   at Program.<Main>$(String[] args) in C:\workspace\bobcrm\src\BobCrm.Api\Program.cs:line 147
   at Program.<Main>(String[] args)
   at InvokeStub_Program.<Main>(Object, Span`1)
   at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
   at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder) in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs:line 35
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at BobCrm.Api.Tests.AuthBoundaryTests.Session_Endpoint_Returns_Valid_For_Authenticated_User() in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\AuthBoundaryTests.cs:line 142
--- End of stack trace from previous location ---
  螟ｱ謨・BobCrm.Api.Tests.AuthBoundaryTests.Login_Empty_Username_Returns_BadRequest [61 ms]
  繧ｨ繝ｩ繝ｼ 繝｡繝・そ繝ｼ繧ｸ:
   System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
  繧ｹ繧ｿ繝・け 繝医Ξ繝ｼ繧ｹ:
     at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
   at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db) in C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs:line 116
   at Program.<Main>$(String[] args) in C:\workspace\bobcrm\src\BobCrm.Api\Program.cs:line 147
   at Program.<Main>(String[] args)
   at InvokeStub_Program.<Main>(Object, Span`1)
   at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
   at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder) in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs:line 35
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at BobCrm.Api.Tests.AuthBoundaryTests.Login_Empty_Username_Returns_BadRequest() in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\AuthBoundaryTests.cs:line 131
--- End of stack trace from previous location ---
  螟ｱ謨・BobCrm.Api.Tests.I18nCacheTests.I18n_Resources_Endpoint_Requires_Auth [61 ms]
  繧ｨ繝ｩ繝ｼ 繝｡繝・そ繝ｼ繧ｸ:
   System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
  繧ｹ繧ｿ繝・け 繝医Ξ繝ｼ繧ｹ:
     at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
   at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db) in C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs:line 116
   at Program.<Main>$(String[] args) in C:\workspace\bobcrm\src\BobCrm.Api\Program.cs:line 147
   at Program.<Main>(String[] args)
   at InvokeStub_Program.<Main>(Object, Span`1)
   at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
   at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder) in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs:line 35
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at BobCrm.Api.Tests.I18nCacheTests.I18n_Resources_Endpoint_Requires_Auth() in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\I18nCacheTests.cs:line 99
--- End of stack trace from previous location ---
  螟ｱ謨・BobCrm.Api.Tests.I18nCacheTests.I18n_Resources_With_Auth_Returns_ETag [67 ms]
  繧ｨ繝ｩ繝ｼ 繝｡繝・そ繝ｼ繧ｸ:
   System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
  繧ｹ繧ｿ繝・け 繝医Ξ繝ｼ繧ｹ:
     at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
   at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db) in C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs:line 116
   at Program.<Main>$(String[] args) in C:\workspace\bobcrm\src\BobCrm.Api\Program.cs:line 147
   at Program.<Main>(String[] args)
   at InvokeStub_Program.<Main>(Object, Span`1)
   at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
   at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder) in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs:line 35
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at BobCrm.Api.Tests.I18nCacheTests.I18n_Resources_With_Auth_Returns_ETag() in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\I18nCacheTests.cs:line 109
--- End of stack trace from previous location ---
  螟ｱ謨・BobCrm.Api.Tests.I18nCacheTests.I18n_Version_Returns_Consistent_Value [63 ms]
  繧ｨ繝ｩ繝ｼ 繝｡繝・そ繝ｼ繧ｸ:
   System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
  繧ｹ繧ｿ繝・け 繝医Ξ繝ｼ繧ｹ:
     at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
   at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db) in C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs:line 116
   at Program.<Main>$(String[] args) in C:\workspace\bobcrm\src\BobCrm.Api\Program.cs:line 147
   at Program.<Main>(String[] args)
   at InvokeStub_Program.<Main>(Object, Span`1)
   at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
   at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder) in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs:line 35
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at BobCrm.Api.Tests.I18nCacheTests.I18n_Version_Returns_Consistent_Value() in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\I18nCacheTests.cs:line 46
--- End of stack trace from previous location ---
  螟ｱ謨・BobCrm.Api.Tests.I18nCacheTests.I18n_ETag_Returns_304_When_Not_Modified [67 ms]
  繧ｨ繝ｩ繝ｼ 繝｡繝・そ繝ｼ繧ｸ:
   System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
  繧ｹ繧ｿ繝・け 繝医Ξ繝ｼ繧ｹ:
     at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
   at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db) in C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs:line 116
   at Program.<Main>$(String[] args) in C:\workspace\bobcrm\src\BobCrm.Api\Program.cs:line 147
   at Program.<Main>(String[] args)
   at InvokeStub_Program.<Main>(Object, Span`1)
   at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
   at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder) in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs:line 35
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at BobCrm.Api.Tests.I18nCacheTests.I18n_ETag_Returns_304_When_Not_Modified() in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\I18nCacheTests.cs:line 18
--- End of stack trace from previous location ---
  螟ｱ謨・BobCrm.Api.Tests.I18nCacheTests.I18n_Different_Languages_Have_Different_ETags [63 ms]
  繧ｨ繝ｩ繝ｼ 繝｡繝・そ繝ｼ繧ｸ:
   System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
  繧ｹ繧ｿ繝・け 繝医Ξ繝ｼ繧ｹ:
     at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
   at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db) in C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs:line 116
   at Program.<Main>$(String[] args) in C:\workspace\bobcrm\src\BobCrm.Api\Program.cs:line 147
   at Program.<Main>(String[] args)
   at InvokeStub_Program.<Main>(Object, Span`1)
   at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
   at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder) in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs:line 35
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at BobCrm.Api.Tests.I18nCacheTests.I18n_Different_Languages_Have_Different_ETags() in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\I18nCacheTests.cs:line 78
--- End of stack trace from previous location ---
[07:44:38 INF] ============================================
[07:44:38 INF] Application starting at 11/06/2025 07:44:38, log file: C:\workspace\bobcrm\tests\BobCrm.Api.Tests\bin\Debug\net8.0\..\..\logs\api_20251106_074438.log
[07:44:38 INF] ============================================
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:38 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:38 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:38 INF] No migrations were applied. The database is already up to date.
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Customers" AS c)
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "FieldDefinitions" AS f)
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationLanguages" AS l)
[EntityMetadata] Step 1: Found 1 entity types implementing IEntityMetadataProvider
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[@__metadata_EntityType_0='?'], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
WHERE e."EntityType" = @__metadata_EntityType_0
LIMIT 1
[EntityMetadata] - Already exists: Customer
[EntityMetadata] Step 2: Validating existing metadata records...
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
[EntityMetadata] ? No changes needed (all in sync)
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationResources" AS l)
[xUnit.net 00:00:03.07]     BobCrm.Api.Tests.I18nCacheTests.I18n_CacheControl_Header_Present [FAIL]
[xUnit.net 00:00:03.07]       System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
[xUnit.net 00:00:03.07]       Stack Trace:
[xUnit.net 00:00:03.07]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
[xUnit.net 00:00:03.07]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
[xUnit.net 00:00:03.07]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
[xUnit.net 00:00:03.07]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
[xUnit.net 00:00:03.07]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
[xUnit.net 00:00:03.07]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
[xUnit.net 00:00:03.07]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
[xUnit.net 00:00:03.07]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
[xUnit.net 00:00:03.07]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
[xUnit.net 00:00:03.07]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
[xUnit.net 00:00:03.07]            at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
[xUnit.net 00:00:03.07]         C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs(116,0): at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db)
[xUnit.net 00:00:03.07]         C:\workspace\bobcrm\src\BobCrm.Api\Program.cs(147,0): at Program.<Main>$(String[] args)
[xUnit.net 00:00:03.07]            at Program.<Main>(String[] args)
[xUnit.net 00:00:03.07]            at InvokeStub_Program.<Main>(Object, Span`1)
[xUnit.net 00:00:03.07]            at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
[xUnit.net 00:00:03.07]         --- End of stack trace from previous location ---
[xUnit.net 00:00:03.07]            at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
[xUnit.net 00:00:03.07]            at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
[xUnit.net 00:00:03.07]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:03.07]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs(35,0): at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:03.07]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
[xUnit.net 00:00:03.07]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
[xUnit.net 00:00:03.07]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:03.07]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:03.07]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:03.07]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:03.07]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\I18nCacheTests.cs(63,0): at BobCrm.Api.Tests.I18nCacheTests.I18n_CacheControl_Header_Present()
[xUnit.net 00:00:03.07]         --- End of stack trace from previous location ---
[07:44:38 INF] ============================================
[07:44:38 INF] Application starting at 11/06/2025 07:44:38, log file: C:\workspace\bobcrm\tests\BobCrm.Api.Tests\bin\Debug\net8.0\..\..\logs\api_20251106_074438.log
[07:44:38 INF] ============================================
[07:44:38 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:38 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:38 INF] No migrations were applied. The database is already up to date.
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Customers" AS c)
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "FieldDefinitions" AS f)
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationLanguages" AS l)
[EntityMetadata] Step 1: Found 1 entity types implementing IEntityMetadataProvider
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[@__metadata_EntityType_0='?'], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
WHERE e."EntityType" = @__metadata_EntityType_0
LIMIT 1
[EntityMetadata] - Already exists: Customer
[EntityMetadata] Step 2: Validating existing metadata records...
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
[EntityMetadata] ? No changes needed (all in sync)
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationResources" AS l)
[xUnit.net 00:00:03.13]     BobCrm.Api.Tests.AdminEnvironmentTests.Debug_Endpoints_Return_404_In_Production [FAIL]
[xUnit.net 00:00:03.13]       System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
[xUnit.net 00:00:03.13]       Stack Trace:
[xUnit.net 00:00:03.13]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
[xUnit.net 00:00:03.13]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
[xUnit.net 00:00:03.13]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
[xUnit.net 00:00:03.13]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
[xUnit.net 00:00:03.13]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
[xUnit.net 00:00:03.13]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
[xUnit.net 00:00:03.13]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
[xUnit.net 00:00:03.13]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
[xUnit.net 00:00:03.13]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
[xUnit.net 00:00:03.13]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
[xUnit.net 00:00:03.13]            at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
[xUnit.net 00:00:03.13]         C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs(116,0): at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db)
[xUnit.net 00:00:03.13]         C:\workspace\bobcrm\src\BobCrm.Api\Program.cs(147,0): at Program.<Main>$(String[] args)
[xUnit.net 00:00:03.13]            at Program.<Main>(String[] args)
[xUnit.net 00:00:03.13]            at InvokeStub_Program.<Main>(Object, Span`1)
[xUnit.net 00:00:03.13]            at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
[xUnit.net 00:00:03.13]         --- End of stack trace from previous location ---
[xUnit.net 00:00:03.13]            at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
[xUnit.net 00:00:03.13]            at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
[xUnit.net 00:00:03.13]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:03.13]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs(35,0): at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:03.13]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
[xUnit.net 00:00:03.13]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
[xUnit.net 00:00:03.13]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:03.13]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:03.13]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:03.13]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:03.13]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\AdminEnvironmentTests.cs(78,0): at BobCrm.Api.Tests.AdminEnvironmentTests.Debug_Endpoints_Return_404_In_Production()
[xUnit.net 00:00:03.13]         --- End of stack trace from previous location ---
[xUnit.net 00:00:03.13]     BobCrm.Api.Tests.AdminEnvironmentTests.Admin_DB_Recreate_Only_Works_In_Development [SKIP]
[xUnit.net 00:00:03.13]       豁､豬玖ｯ穂ｼ夐㍾蟒ｺ謨ｰ謐ｮ蠎灘ｹｶ遐ｴ蝮丞・莉匁ｵ玖ｯ慕噪迥ｶ諤・ｼ御ｻ・惠髫皮ｦｻ霑占｡梧慮菴ｿ逕ｨ
[07:44:38 INF] ============================================
[07:44:38 INF] Application starting at 11/06/2025 07:44:38, log file: C:\workspace\bobcrm\tests\BobCrm.Api.Tests\bin\Debug\net8.0\..\..\logs\api_20251106_074438.log
[07:44:38 INF] ============================================
[07:44:38 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:38 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:38 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:38 INF] No migrations were applied. The database is already up to date.
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Customers" AS c)
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "FieldDefinitions" AS f)
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationLanguages" AS l)
[EntityMetadata] Step 1: Found 1 entity types implementing IEntityMetadataProvider
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[@__metadata_EntityType_0='?'], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
WHERE e."EntityType" = @__metadata_EntityType_0
LIMIT 1
[EntityMetadata] - Already exists: Customer
[EntityMetadata] Step 2: Validating existing metadata records...
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
[EntityMetadata] ? No changes needed (all in sync)
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationResources" AS l)
[xUnit.net 00:00:03.19]     BobCrm.Api.Tests.AdminEnvironmentTests.Setup_Endpoints_Available_In_All_Environments [FAIL]
[xUnit.net 00:00:03.19]       System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
[xUnit.net 00:00:03.19]       Stack Trace:
[xUnit.net 00:00:03.19]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
[xUnit.net 00:00:03.19]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
[xUnit.net 00:00:03.19]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
[xUnit.net 00:00:03.19]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
[xUnit.net 00:00:03.19]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
[xUnit.net 00:00:03.19]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
[xUnit.net 00:00:03.19]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
[xUnit.net 00:00:03.19]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
[xUnit.net 00:00:03.19]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
[xUnit.net 00:00:03.19]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
[xUnit.net 00:00:03.19]            at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
[xUnit.net 00:00:03.19]         C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs(116,0): at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db)
[xUnit.net 00:00:03.19]         C:\workspace\bobcrm\src\BobCrm.Api\Program.cs(147,0): at Program.<Main>$(String[] args)
[xUnit.net 00:00:03.19]            at Program.<Main>(String[] args)
[xUnit.net 00:00:03.19]            at InvokeStub_Program.<Main>(Object, Span`1)
[xUnit.net 00:00:03.19]            at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
[xUnit.net 00:00:03.19]         --- End of stack trace from previous location ---
[xUnit.net 00:00:03.19]            at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
[xUnit.net 00:00:03.19]            at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
[xUnit.net 00:00:03.19]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:03.19]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs(35,0): at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:03.19]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
[xUnit.net 00:00:03.19]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
[xUnit.net 00:00:03.19]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:03.19]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:03.19]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:03.19]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:03.19]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\AdminEnvironmentTests.cs(122,0): at BobCrm.Api.Tests.AdminEnvironmentTests.Setup_Endpoints_Available_In_All_Environments()
[xUnit.net 00:00:03.19]         --- End of stack trace from previous location ---
[xUnit.net 00:00:03.19]     BobCrm.Api.Tests.AdminEnvironmentTests.Admin_Reset_Password_Works_In_Development [SKIP]
[xUnit.net 00:00:03.19]       豁､豬玖ｯ穂ｼ壻ｿｮ謾ｹadmin蟇・・ｼ悟庄閭ｽ蠖ｱ蜩榊・莉匁ｵ玖ｯ・
[07:44:38 INF] ============================================
[07:44:38 INF] Application starting at 11/06/2025 07:44:38, log file: C:\workspace\bobcrm\tests\BobCrm.Api.Tests\bin\Debug\net8.0\..\..\logs\api_20251106_074438.log
[07:44:38 INF] ============================================
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:38 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:38 INF] No migrations were applied. The database is already up to date.
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Customers" AS c)
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "FieldDefinitions" AS f)
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationLanguages" AS l)
[EntityMetadata] Step 1: Found 1 entity types implementing IEntityMetadataProvider
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[@__metadata_EntityType_0='?'], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
WHERE e."EntityType" = @__metadata_EntityType_0
LIMIT 1
[EntityMetadata] - Already exists: Customer
[EntityMetadata] Step 2: Validating existing metadata records...
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
[EntityMetadata] ? No changes needed (all in sync)
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationResources" AS l)
[xUnit.net 00:00:03.25]     BobCrm.Api.Tests.AdminEnvironmentTests.Admin_Endpoints_Available_In_Development [FAIL]
[xUnit.net 00:00:03.25]       System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
[xUnit.net 00:00:03.25]       Stack Trace:
[xUnit.net 00:00:03.25]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
[xUnit.net 00:00:03.25]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
[xUnit.net 00:00:03.25]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
[xUnit.net 00:00:03.25]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
[xUnit.net 00:00:03.25]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
[xUnit.net 00:00:03.25]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
[xUnit.net 00:00:03.25]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
[xUnit.net 00:00:03.25]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
[xUnit.net 00:00:03.25]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
[xUnit.net 00:00:03.25]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
[xUnit.net 00:00:03.25]            at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
[xUnit.net 00:00:03.25]         C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs(116,0): at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db)
[xUnit.net 00:00:03.25]         C:\workspace\bobcrm\src\BobCrm.Api\Program.cs(147,0): at Program.<Main>$(String[] args)
[xUnit.net 00:00:03.25]            at Program.<Main>(String[] args)
[xUnit.net 00:00:03.25]            at InvokeStub_Program.<Main>(Object, Span`1)
[xUnit.net 00:00:03.25]            at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
[xUnit.net 00:00:03.25]         --- End of stack trace from previous location ---
[xUnit.net 00:00:03.25]            at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
[xUnit.net 00:00:03.25]            at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
[xUnit.net 00:00:03.25]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:03.25]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs(35,0): at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:03.25]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
[xUnit.net 00:00:03.25]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
[xUnit.net 00:00:03.25]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:03.25]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:03.25]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:03.25]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:03.25]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\AdminEnvironmentTests.cs(24,0): at BobCrm.Api.Tests.AdminEnvironmentTests.Admin_Endpoints_Available_In_Development()
[xUnit.net 00:00:03.25]         --- End of stack trace from previous location ---
[07:44:38 INF] ============================================
[07:44:38 INF] Application starting at 11/06/2025 07:44:38, log file: C:\workspace\bobcrm\tests\BobCrm.Api.Tests\bin\Debug\net8.0\..\..\logs\api_20251106_074438.log
[07:44:38 INF] ============================================
[07:44:38 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:38 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:38 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:38 INF] No migrations were applied. The database is already up to date.
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Customers" AS c)
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "FieldDefinitions" AS f)
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationLanguages" AS l)
[EntityMetadata] Step 1: Found 1 entity types implementing IEntityMetadataProvider
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[@__metadata_EntityType_0='?'], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
WHERE e."EntityType" = @__metadata_EntityType_0
LIMIT 1
[EntityMetadata] - Already exists: Customer
[EntityMetadata] Step 2: Validating existing metadata records...
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
[EntityMetadata] ? No changes needed (all in sync)
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationResources" AS l)
[xUnit.net 00:00:03.33]     BobCrm.Api.Tests.AdminEnvironmentTests.Debug_Users_Endpoint_Available_In_Development [FAIL]
[xUnit.net 00:00:03.34]       System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
[xUnit.net 00:00:03.34]       Stack Trace:
[xUnit.net 00:00:03.34]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
[xUnit.net 00:00:03.34]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
[xUnit.net 00:00:03.34]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
[xUnit.net 00:00:03.34]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
[xUnit.net 00:00:03.34]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
[xUnit.net 00:00:03.34]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
[xUnit.net 00:00:03.34]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
[xUnit.net 00:00:03.34]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
[xUnit.net 00:00:03.34]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
[xUnit.net 00:00:03.34]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
[xUnit.net 00:00:03.34]            at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
[xUnit.net 00:00:03.34]         C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs(116,0): at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db)
[xUnit.net 00:00:03.34]         C:\workspace\bobcrm\src\BobCrm.Api\Program.cs(147,0): at Program.<Main>$(String[] args)
[xUnit.net 00:00:03.34]            at Program.<Main>(String[] args)
[xUnit.net 00:00:03.34]            at InvokeStub_Program.<Main>(Object, Span`1)
[xUnit.net 00:00:03.34]            at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
[xUnit.net 00:00:03.34]         --- End of stack trace from previous location ---
[xUnit.net 00:00:03.34]            at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
[xUnit.net 00:00:03.34]            at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
[xUnit.net 00:00:03.34]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:03.34]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs(35,0): at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:03.34]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
[xUnit.net 00:00:03.34]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
[xUnit.net 00:00:03.34]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:03.34]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:03.34]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:03.34]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:03.34]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\AdminEnvironmentTests.cs(39,0): at BobCrm.Api.Tests.AdminEnvironmentTests.Debug_Users_Endpoint_Available_In_Development()
[xUnit.net 00:00:03.34]         --- End of stack trace from previous location ---
[07:44:38 INF] ============================================
[07:44:38 INF] Application starting at 11/06/2025 07:44:38, log file: C:\workspace\bobcrm\tests\BobCrm.Api.Tests\bin\Debug\net8.0\..\..\logs\api_20251106_074438.log
[07:44:38 INF] ============================================
[07:44:38 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:38 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:38 INF] No migrations were applied. The database is already up to date.
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Customers" AS c)
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "FieldDefinitions" AS f)
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationLanguages" AS l)
[EntityMetadata] Step 1: Found 1 entity types implementing IEntityMetadataProvider
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[@__metadata_EntityType_0='?'], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
WHERE e."EntityType" = @__metadata_EntityType_0
LIMIT 1
[EntityMetadata] - Already exists: Customer
[EntityMetadata] Step 2: Validating existing metadata records...
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
[EntityMetadata] ? No changes needed (all in sync)
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationResources" AS l)
[xUnit.net 00:00:03.39]     BobCrm.Api.Tests.AdminEnvironmentTests.Admin_Endpoints_Return_404_In_Production [FAIL]
[xUnit.net 00:00:03.39]       System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
[xUnit.net 00:00:03.39]       Stack Trace:
[xUnit.net 00:00:03.39]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
[xUnit.net 00:00:03.39]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
[xUnit.net 00:00:03.39]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
[xUnit.net 00:00:03.39]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
[xUnit.net 00:00:03.39]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
[xUnit.net 00:00:03.39]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
[xUnit.net 00:00:03.39]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
[xUnit.net 00:00:03.39]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
[xUnit.net 00:00:03.39]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
[xUnit.net 00:00:03.39]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
[xUnit.net 00:00:03.40]            at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
[xUnit.net 00:00:03.40]         C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs(116,0): at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db)
[xUnit.net 00:00:03.40]         C:\workspace\bobcrm\src\BobCrm.Api\Program.cs(147,0): at Program.<Main>$(String[] args)
[xUnit.net 00:00:03.40]            at Program.<Main>(String[] args)
[xUnit.net 00:00:03.40]            at InvokeStub_Program.<Main>(Object, Span`1)
[xUnit.net 00:00:03.40]            at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
[xUnit.net 00:00:03.40]         --- End of stack trace from previous location ---
[xUnit.net 00:00:03.40]            at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
[xUnit.net 00:00:03.40]            at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
[xUnit.net 00:00:03.40]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:03.40]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs(35,0): at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:03.40]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
[xUnit.net 00:00:03.40]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
[xUnit.net 00:00:03.40]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:03.40]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:03.40]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:03.40]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:03.40]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\AdminEnvironmentTests.cs(61,0): at BobCrm.Api.Tests.AdminEnvironmentTests.Admin_Endpoints_Return_404_In_Production()
[xUnit.net 00:00:03.40]         --- End of stack trace from previous location ---
[07:44:38 INF] ============================================
[07:44:38 INF] Application starting at 11/06/2025 07:44:38, log file: C:\workspace\bobcrm\tests\BobCrm.Api.Tests\bin\Debug\net8.0\..\..\logs\api_20251106_074438.log
[07:44:38 INF] ============================================
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:38 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:38 INF] No migrations were applied. The database is already up to date.
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Customers" AS c)
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "FieldDefinitions" AS f)
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationLanguages" AS l)
[EntityMetadata] Step 1: Found 1 entity types implementing IEntityMetadataProvider
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[@__metadata_EntityType_0='?'], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
WHERE e."EntityType" = @__metadata_EntityType_0
LIMIT 1
[EntityMetadata] - Already exists: Customer
[EntityMetadata] Step 2: Validating existing metadata records...
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
[EntityMetadata] ? No changes needed (all in sync)
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationResources" AS l)
[xUnit.net 00:00:03.46]     BobCrm.Api.Tests.LayoutTests.Layout_Generate_Save_And_Permissions [FAIL]
[xUnit.net 00:00:03.46]       System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
[xUnit.net 00:00:03.46]       Stack Trace:
[xUnit.net 00:00:03.46]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
[xUnit.net 00:00:03.46]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
[xUnit.net 00:00:03.46]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
[xUnit.net 00:00:03.46]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
[xUnit.net 00:00:03.46]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
[xUnit.net 00:00:03.46]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
[xUnit.net 00:00:03.46]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
[xUnit.net 00:00:03.46]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
[xUnit.net 00:00:03.46]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
[xUnit.net 00:00:03.46]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
[xUnit.net 00:00:03.46]            at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
[xUnit.net 00:00:03.46]         C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs(116,0): at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db)
[xUnit.net 00:00:03.46]         C:\workspace\bobcrm\src\BobCrm.Api\Program.cs(147,0): at Program.<Main>$(String[] args)
[xUnit.net 00:00:03.46]            at Program.<Main>(String[] args)
[xUnit.net 00:00:03.46]            at InvokeStub_Program.<Main>(Object, Span`1)
[xUnit.net 00:00:03.46]            at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
[xUnit.net 00:00:03.46]         --- End of stack trace from previous location ---
[xUnit.net 00:00:03.46]            at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
[xUnit.net 00:00:03.46]            at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
[xUnit.net 00:00:03.46]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:03.46]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs(35,0): at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:03.46]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
[xUnit.net 00:00:03.46]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
[xUnit.net 00:00:03.46]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:03.46]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:03.46]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:03.46]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:03.46]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\LayoutTests.cs(54,0): at BobCrm.Api.Tests.LayoutTests.Layout_Generate_Save_And_Permissions()
[xUnit.net 00:00:03.46]         --- End of stack trace from previous location ---
  螟ｱ謨・BobCrm.Api.Tests.I18nCacheTests.I18n_CacheControl_Header_Present [70 ms]
  繧ｨ繝ｩ繝ｼ 繝｡繝・そ繝ｼ繧ｸ:
   System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
  繧ｹ繧ｿ繝・け 繝医Ξ繝ｼ繧ｹ:
     at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
   at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db) in C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs:line 116
   at Program.<Main>$(String[] args) in C:\workspace\bobcrm\src\BobCrm.Api\Program.cs:line 147
   at Program.<Main>(String[] args)
   at InvokeStub_Program.<Main>(Object, Span`1)
   at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
   at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder) in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs:line 35
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at BobCrm.Api.Tests.I18nCacheTests.I18n_CacheControl_Header_Present() in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\I18nCacheTests.cs:line 63
--- End of stack trace from previous location ---
  螟ｱ謨・BobCrm.Api.Tests.AdminEnvironmentTests.Debug_Endpoints_Return_404_In_Production [60 ms]
  繧ｨ繝ｩ繝ｼ 繝｡繝・そ繝ｼ繧ｸ:
   System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
  繧ｹ繧ｿ繝・け 繝医Ξ繝ｼ繧ｹ:
     at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
   at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db) in C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs:line 116
   at Program.<Main>$(String[] args) in C:\workspace\bobcrm\src\BobCrm.Api\Program.cs:line 147
   at Program.<Main>(String[] args)
   at InvokeStub_Program.<Main>(Object, Span`1)
   at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
   at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder) in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs:line 35
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at BobCrm.Api.Tests.AdminEnvironmentTests.Debug_Endpoints_Return_404_In_Production() in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\AdminEnvironmentTests.cs:line 78
--- End of stack trace from previous location ---
  繧ｹ繧ｭ繝・・ BobCrm.Api.Tests.AdminEnvironmentTests.Admin_DB_Recreate_Only_Works_In_Development [1 ms]
  繧ｨ繝ｩ繝ｼ 繝｡繝・そ繝ｼ繧ｸ:
   豁､豬玖ｯ穂ｼ夐㍾蟒ｺ謨ｰ謐ｮ蠎灘ｹｶ遐ｴ蝮丞・莉匁ｵ玖ｯ慕噪迥ｶ諤・ｼ御ｻ・惠髫皮ｦｻ霑占｡梧慮菴ｿ逕ｨ

  螟ｱ謨・BobCrm.Api.Tests.AdminEnvironmentTests.Setup_Endpoints_Available_In_All_Environments [57 ms]
  繧ｨ繝ｩ繝ｼ 繝｡繝・そ繝ｼ繧ｸ:
   System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
  繧ｹ繧ｿ繝・け 繝医Ξ繝ｼ繧ｹ:
     at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
   at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db) in C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs:line 116
   at Program.<Main>$(String[] args) in C:\workspace\bobcrm\src\BobCrm.Api\Program.cs:line 147
   at Program.<Main>(String[] args)
   at InvokeStub_Program.<Main>(Object, Span`1)
   at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
   at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder) in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs:line 35
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at BobCrm.Api.Tests.AdminEnvironmentTests.Setup_Endpoints_Available_In_All_Environments() in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\AdminEnvironmentTests.cs:line 122
--- End of stack trace from previous location ---
  繧ｹ繧ｭ繝・・ BobCrm.Api.Tests.AdminEnvironmentTests.Admin_Reset_Password_Works_In_Development [1 ms]
  繧ｨ繝ｩ繝ｼ 繝｡繝・そ繝ｼ繧ｸ:
   豁､豬玖ｯ穂ｼ壻ｿｮ謾ｹadmin蟇・・ｼ悟庄閭ｽ蠖ｱ蜩榊・莉匁ｵ玖ｯ・

  螟ｱ謨・BobCrm.Api.Tests.AdminEnvironmentTests.Admin_Endpoints_Available_In_Development [57 ms]
  繧ｨ繝ｩ繝ｼ 繝｡繝・そ繝ｼ繧ｸ:
   System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
  繧ｹ繧ｿ繝・け 繝医Ξ繝ｼ繧ｹ:
     at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
   at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db) in C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs:line 116
   at Program.<Main>$(String[] args) in C:\workspace\bobcrm\src\BobCrm.Api\Program.cs:line 147
   at Program.<Main>(String[] args)
   at InvokeStub_Program.<Main>(Object, Span`1)
   at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
   at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder) in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs:line 35
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at BobCrm.Api.Tests.AdminEnvironmentTests.Admin_Endpoints_Available_In_Development() in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\AdminEnvironmentTests.cs:line 24
--- End of stack trace from previous location ---
  螟ｱ謨・BobCrm.Api.Tests.AdminEnvironmentTests.Debug_Users_Endpoint_Available_In_Development [85 ms]
  繧ｨ繝ｩ繝ｼ 繝｡繝・そ繝ｼ繧ｸ:
   System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
  繧ｹ繧ｿ繝・け 繝医Ξ繝ｼ繧ｹ:
     at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
   at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db) in C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs:line 116
   at Program.<Main>$(String[] args) in C:\workspace\bobcrm\src\BobCrm.Api\Program.cs:line 147
   at Program.<Main>(String[] args)
   at InvokeStub_Program.<Main>(Object, Span`1)
   at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
   at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder) in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs:line 35
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at BobCrm.Api.Tests.AdminEnvironmentTests.Debug_Users_Endpoint_Available_In_Development() in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\AdminEnvironmentTests.cs:line 39
--- End of stack trace from previous location ---
  螟ｱ謨・BobCrm.Api.Tests.AdminEnvironmentTests.Admin_Endpoints_Return_404_In_Production [58 ms]
  繧ｨ繝ｩ繝ｼ 繝｡繝・そ繝ｼ繧ｸ:
   System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
  繧ｹ繧ｿ繝・け 繝医Ξ繝ｼ繧ｹ:
     at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
   at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db) in C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs:line 116
   at Program.<Main>$(String[] args) in C:\workspace\bobcrm\src\BobCrm.Api\Program.cs:line 147
   at Program.<Main>(String[] args)
   at InvokeStub_Program.<Main>(Object, Span`1)
   at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
   at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder) in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs:line 35
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at BobCrm.Api.Tests.AdminEnvironmentTests.Admin_Endpoints_Return_404_In_Production() in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\AdminEnvironmentTests.cs:line 61
--- End of stack trace from previous location ---
  螟ｱ謨・BobCrm.Api.Tests.LayoutTests.Layout_Generate_Save_And_Permissions [60 ms]
  繧ｨ繝ｩ繝ｼ 繝｡繝・そ繝ｼ繧ｸ:
   System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
  繧ｹ繧ｿ繝・け 繝医Ξ繝ｼ繧ｹ:
     at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
   at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db) in C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs:line 116
   at Program.<Main>$(String[] args) in C:\workspace\bobcrm\src\BobCrm.Api\Program.cs:line 147
   at Program.<Main>(String[] args)
   at InvokeStub_Program.<Main>(Object, Span`1)
   at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
   at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder) in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs:line 35
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at BobCrm.Api.Tests.LayoutTests.Layout_Generate_Save_And_Permissions() in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\LayoutTests.cs:line 54
--- End of stack trace from previous location ---
[07:44:38 INF] ============================================
[07:44:38 INF] Application starting at 11/06/2025 07:44:38, log file: C:\workspace\bobcrm\tests\BobCrm.Api.Tests\bin\Debug\net8.0\..\..\logs\api_20251106_074438.log
[07:44:38 INF] ============================================
[07:44:38 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:38 INF] No migrations were applied. The database is already up to date.
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Customers" AS c)
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "FieldDefinitions" AS f)
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationLanguages" AS l)
[EntityMetadata] Step 1: Found 1 entity types implementing IEntityMetadataProvider
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[@__metadata_EntityType_0='?'], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
WHERE e."EntityType" = @__metadata_EntityType_0
LIMIT 1
[EntityMetadata] - Already exists: Customer
[EntityMetadata] Step 2: Validating existing metadata records...
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
[EntityMetadata] ? No changes needed (all in sync)
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationResources" AS l)
[xUnit.net 00:00:03.51]     BobCrm.Api.Tests.LayoutTests.Layout_CRUD_User_And_Default [FAIL]
[xUnit.net 00:00:03.52]       System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
[xUnit.net 00:00:03.52]       Stack Trace:
[xUnit.net 00:00:03.52]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
[xUnit.net 00:00:03.52]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
[xUnit.net 00:00:03.52]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
[xUnit.net 00:00:03.52]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
[xUnit.net 00:00:03.52]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
[xUnit.net 00:00:03.52]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
[xUnit.net 00:00:03.52]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
[xUnit.net 00:00:03.52]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
[xUnit.net 00:00:03.52]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
[xUnit.net 00:00:03.52]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
[xUnit.net 00:00:03.52]            at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
[xUnit.net 00:00:03.52]         C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs(116,0): at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db)
[xUnit.net 00:00:03.52]         C:\workspace\bobcrm\src\BobCrm.Api\Program.cs(147,0): at Program.<Main>$(String[] args)
[xUnit.net 00:00:03.52]            at Program.<Main>(String[] args)
[xUnit.net 00:00:03.52]            at InvokeStub_Program.<Main>(Object, Span`1)
[xUnit.net 00:00:03.52]            at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
[xUnit.net 00:00:03.52]         --- End of stack trace from previous location ---
[xUnit.net 00:00:03.52]            at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
[xUnit.net 00:00:03.52]            at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
[xUnit.net 00:00:03.52]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:03.52]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs(35,0): at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:03.52]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
[xUnit.net 00:00:03.52]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
[xUnit.net 00:00:03.52]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:03.52]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:03.52]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:03.52]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:03.52]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\LayoutTests.cs(15,0): at BobCrm.Api.Tests.LayoutTests.Layout_CRUD_User_And_Default()
[xUnit.net 00:00:03.52]         --- End of stack trace from previous location ---
[07:44:38 INF] ============================================
[07:44:38 INF] Application starting at 11/06/2025 07:44:38, log file: C:\workspace\bobcrm\tests\BobCrm.Api.Tests\bin\Debug\net8.0\..\..\logs\api_20251106_074438.log
[07:44:38 INF] ============================================
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:38 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:38 INF] No migrations were applied. The database is already up to date.
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Customers" AS c)
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "FieldDefinitions" AS f)
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationLanguages" AS l)
[EntityMetadata] Step 1: Found 1 entity types implementing IEntityMetadataProvider
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[@__metadata_EntityType_0='?'], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
WHERE e."EntityType" = @__metadata_EntityType_0
LIMIT 1
[EntityMetadata] - Already exists: Customer
[EntityMetadata] Step 2: Validating existing metadata records...
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
[EntityMetadata] ? No changes needed (all in sync)
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationResources" AS l)
[xUnit.net 00:00:03.59]     BobCrm.Api.Tests.AuthTests.Login_Refresh_Session_Ok [FAIL]
[xUnit.net 00:00:03.59]       System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
[xUnit.net 00:00:03.59]       Stack Trace:
[xUnit.net 00:00:03.59]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
[xUnit.net 00:00:03.59]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
[xUnit.net 00:00:03.59]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
[xUnit.net 00:00:03.59]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
[xUnit.net 00:00:03.59]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
[xUnit.net 00:00:03.59]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
[xUnit.net 00:00:03.59]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
[xUnit.net 00:00:03.59]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
[xUnit.net 00:00:03.59]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
[xUnit.net 00:00:03.59]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
[xUnit.net 00:00:03.59]            at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
[xUnit.net 00:00:03.59]         C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs(116,0): at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db)
[xUnit.net 00:00:03.59]         C:\workspace\bobcrm\src\BobCrm.Api\Program.cs(147,0): at Program.<Main>$(String[] args)
[xUnit.net 00:00:03.59]            at Program.<Main>(String[] args)
[xUnit.net 00:00:03.59]            at InvokeStub_Program.<Main>(Object, Span`1)
[xUnit.net 00:00:03.59]            at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
[xUnit.net 00:00:03.59]         --- End of stack trace from previous location ---
[xUnit.net 00:00:03.59]            at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
[xUnit.net 00:00:03.59]            at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
[xUnit.net 00:00:03.59]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:03.59]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs(35,0): at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:03.59]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
[xUnit.net 00:00:03.59]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
[xUnit.net 00:00:03.59]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:03.59]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:03.59]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:03.59]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:03.59]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\AuthTests.cs(15,0): at BobCrm.Api.Tests.AuthTests.Login_Refresh_Session_Ok()
[xUnit.net 00:00:03.59]         --- End of stack trace from previous location ---
[07:44:38 INF] ============================================
[07:44:38 INF] Application starting at 11/06/2025 07:44:38, log file: C:\workspace\bobcrm\tests\BobCrm.Api.Tests\bin\Debug\net8.0\..\..\logs\api_20251106_074438.log
[07:44:38 INF] ============================================
[07:44:38 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:38 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:38 INF] No migrations were applied. The database is already up to date.
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Customers" AS c)
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "FieldDefinitions" AS f)
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationLanguages" AS l)
[EntityMetadata] Step 1: Found 1 entity types implementing IEntityMetadataProvider
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[@__metadata_EntityType_0='?'], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
WHERE e."EntityType" = @__metadata_EntityType_0
LIMIT 1
[EntityMetadata] - Already exists: Customer
[EntityMetadata] Step 2: Validating existing metadata records...
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
[EntityMetadata] ? No changes needed (all in sync)
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationResources" AS l)
[xUnit.net 00:00:03.65]     BobCrm.Api.Tests.TemplateTests.Template_Independent_Of_Customer_Data [FAIL]
[xUnit.net 00:00:03.65]       System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
[xUnit.net 00:00:03.65]       Stack Trace:
[xUnit.net 00:00:03.65]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
[xUnit.net 00:00:03.65]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
[xUnit.net 00:00:03.65]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
[xUnit.net 00:00:03.65]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
[xUnit.net 00:00:03.65]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
[xUnit.net 00:00:03.65]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
[xUnit.net 00:00:03.65]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
[xUnit.net 00:00:03.65]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
[xUnit.net 00:00:03.65]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
[xUnit.net 00:00:03.65]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
[xUnit.net 00:00:03.65]            at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
[xUnit.net 00:00:03.65]         C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs(116,0): at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db)
[xUnit.net 00:00:03.65]         C:\workspace\bobcrm\src\BobCrm.Api\Program.cs(147,0): at Program.<Main>$(String[] args)
[xUnit.net 00:00:03.65]            at Program.<Main>(String[] args)
[xUnit.net 00:00:03.65]            at InvokeStub_Program.<Main>(Object, Span`1)
[xUnit.net 00:00:03.65]            at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
[xUnit.net 00:00:03.65]         --- End of stack trace from previous location ---
[xUnit.net 00:00:03.65]            at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
[xUnit.net 00:00:03.65]            at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
[xUnit.net 00:00:03.65]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:03.65]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs(35,0): at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:03.65]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
[xUnit.net 00:00:03.65]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
[xUnit.net 00:00:03.65]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:03.65]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:03.65]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:03.65]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:03.65]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TemplateTests.cs(181,0): at BobCrm.Api.Tests.TemplateTests.Template_Independent_Of_Customer_Data()
[xUnit.net 00:00:03.65]         --- End of stack trace from previous location ---
[07:44:38 INF] ============================================
[07:44:38 INF] Application starting at 11/06/2025 07:44:38, log file: C:\workspace\bobcrm\tests\BobCrm.Api.Tests\bin\Debug\net8.0\..\..\logs\api_20251106_074438.log
[07:44:38 INF] ============================================
[07:44:38 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:38 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:38 INF] No migrations were applied. The database is already up to date.
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Customers" AS c)
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "FieldDefinitions" AS f)
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationLanguages" AS l)
[EntityMetadata] Step 1: Found 1 entity types implementing IEntityMetadataProvider
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[@__metadata_EntityType_0='?'], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
WHERE e."EntityType" = @__metadata_EntityType_0
LIMIT 1
[EntityMetadata] - Already exists: Customer
[EntityMetadata] Step 2: Validating existing metadata records...
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
[EntityMetadata] ? No changes needed (all in sync)
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationResources" AS l)
[xUnit.net 00:00:03.70]     BobCrm.Api.Tests.TemplateTests.Template_Effective_Prioritizes_User_Over_Default [FAIL]
[xUnit.net 00:00:03.70]       System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
[xUnit.net 00:00:03.70]       Stack Trace:
[xUnit.net 00:00:03.70]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
[xUnit.net 00:00:03.70]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
[xUnit.net 00:00:03.70]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
[xUnit.net 00:00:03.70]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
[xUnit.net 00:00:03.70]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
[xUnit.net 00:00:03.70]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
[xUnit.net 00:00:03.70]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
[xUnit.net 00:00:03.70]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
[xUnit.net 00:00:03.70]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
[xUnit.net 00:00:03.70]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
[xUnit.net 00:00:03.70]            at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
[xUnit.net 00:00:03.70]         C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs(116,0): at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db)
[xUnit.net 00:00:03.70]         C:\workspace\bobcrm\src\BobCrm.Api\Program.cs(147,0): at Program.<Main>$(String[] args)
[xUnit.net 00:00:03.70]            at Program.<Main>(String[] args)
[xUnit.net 00:00:03.70]            at InvokeStub_Program.<Main>(Object, Span`1)
[xUnit.net 00:00:03.70]            at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
[xUnit.net 00:00:03.70]         --- End of stack trace from previous location ---
[xUnit.net 00:00:03.70]            at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
[xUnit.net 00:00:03.70]            at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
[xUnit.net 00:00:03.70]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:03.70]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs(35,0): at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:03.70]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
[xUnit.net 00:00:03.70]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
[xUnit.net 00:00:03.71]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:03.71]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:03.71]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:03.71]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:03.71]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TemplateTests.cs(156,0): at BobCrm.Api.Tests.TemplateTests.Template_Effective_Prioritizes_User_Over_Default()
[xUnit.net 00:00:03.71]         --- End of stack trace from previous location ---
[07:44:38 INF] ============================================
[07:44:38 INF] Application starting at 11/06/2025 07:44:38, log file: C:\workspace\bobcrm\tests\BobCrm.Api.Tests\bin\Debug\net8.0\..\..\logs\api_20251106_074438.log
[07:44:38 INF] ============================================
[07:44:38 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:38 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:38 INF] No migrations were applied. The database is already up to date.
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Customers" AS c)
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "FieldDefinitions" AS f)
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationLanguages" AS l)
[EntityMetadata] Step 1: Found 1 entity types implementing IEntityMetadataProvider
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[@__metadata_EntityType_0='?'], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
WHERE e."EntityType" = @__metadata_EntityType_0
LIMIT 1
[EntityMetadata] - Already exists: Customer
[EntityMetadata] Step 2: Validating existing metadata records...
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
[EntityMetadata] ? No changes needed (all in sync)
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationResources" AS l)
[xUnit.net 00:00:03.77]     BobCrm.Api.Tests.TemplateTests.Template_User_Reset_Returns_To_Default [FAIL]
[xUnit.net 00:00:03.77]       System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
[xUnit.net 00:00:03.77]       Stack Trace:
[xUnit.net 00:00:03.77]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
[xUnit.net 00:00:03.77]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
[xUnit.net 00:00:03.77]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
[xUnit.net 00:00:03.77]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
[xUnit.net 00:00:03.77]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
[xUnit.net 00:00:03.77]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
[xUnit.net 00:00:03.77]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
[xUnit.net 00:00:03.77]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
[xUnit.net 00:00:03.77]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
[xUnit.net 00:00:03.77]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
[xUnit.net 00:00:03.77]            at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
[xUnit.net 00:00:03.77]         C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs(116,0): at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db)
[xUnit.net 00:00:03.77]         C:\workspace\bobcrm\src\BobCrm.Api\Program.cs(147,0): at Program.<Main>$(String[] args)
[xUnit.net 00:00:03.77]            at Program.<Main>(String[] args)
[xUnit.net 00:00:03.77]            at InvokeStub_Program.<Main>(Object, Span`1)
[xUnit.net 00:00:03.77]            at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
[xUnit.net 00:00:03.77]         --- End of stack trace from previous location ---
[xUnit.net 00:00:03.77]            at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
[xUnit.net 00:00:03.77]            at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
[xUnit.net 00:00:03.77]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:03.77]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs(35,0): at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:03.77]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
[xUnit.net 00:00:03.77]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
[xUnit.net 00:00:03.77]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:03.77]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:03.77]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:03.77]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:03.77]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TemplateTests.cs(121,0): at BobCrm.Api.Tests.TemplateTests.Template_User_Reset_Returns_To_Default()
[xUnit.net 00:00:03.77]         --- End of stack trace from previous location ---
[07:44:38 INF] ============================================
[07:44:38 INF] Application starting at 11/06/2025 07:44:38, log file: C:\workspace\bobcrm\tests\BobCrm.Api.Tests\bin\Debug\net8.0\..\..\logs\api_20251106_074438.log
[07:44:38 INF] ============================================
[07:44:38 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:38 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:38 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:38 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:38 INF] No migrations were applied. The database is already up to date.
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Customers" AS c)
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "FieldDefinitions" AS f)
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationLanguages" AS l)
[EntityMetadata] Step 1: Found 1 entity types implementing IEntityMetadataProvider
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[@__metadata_EntityType_0='?'], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
WHERE e."EntityType" = @__metadata_EntityType_0
LIMIT 1
[EntityMetadata] - Already exists: Customer
[EntityMetadata] Step 2: Validating existing metadata records...
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
[EntityMetadata] ? No changes needed (all in sync)
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationResources" AS l)
[xUnit.net 00:00:03.83]     BobCrm.Api.Tests.TemplateTests.Template_Admin_Can_Save_As_Default [FAIL]
[xUnit.net 00:00:03.83]       System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
[xUnit.net 00:00:03.83]       Stack Trace:
[xUnit.net 00:00:03.83]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
[xUnit.net 00:00:03.83]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
[xUnit.net 00:00:03.83]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
[xUnit.net 00:00:03.83]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
[xUnit.net 00:00:03.83]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
[xUnit.net 00:00:03.83]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
[xUnit.net 00:00:03.83]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
[xUnit.net 00:00:03.83]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
[xUnit.net 00:00:03.83]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
[xUnit.net 00:00:03.83]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
[xUnit.net 00:00:03.83]            at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
[xUnit.net 00:00:03.83]         C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs(116,0): at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db)
[xUnit.net 00:00:03.83]         C:\workspace\bobcrm\src\BobCrm.Api\Program.cs(147,0): at Program.<Main>$(String[] args)
[xUnit.net 00:00:03.83]            at Program.<Main>(String[] args)
[xUnit.net 00:00:03.83]            at InvokeStub_Program.<Main>(Object, Span`1)
[xUnit.net 00:00:03.83]            at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
[xUnit.net 00:00:03.83]         --- End of stack trace from previous location ---
[xUnit.net 00:00:03.83]            at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
[xUnit.net 00:00:03.83]            at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
[xUnit.net 00:00:03.83]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:03.83]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs(35,0): at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:03.83]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
[xUnit.net 00:00:03.83]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
[xUnit.net 00:00:03.83]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:03.83]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:03.83]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:03.83]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:03.83]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TemplateTests.cs(70,0): at BobCrm.Api.Tests.TemplateTests.Template_Admin_Can_Save_As_Default()
[xUnit.net 00:00:03.83]         --- End of stack trace from previous location ---
[07:44:38 INF] ============================================
[07:44:38 INF] Application starting at 11/06/2025 07:44:38, log file: C:\workspace\bobcrm\tests\BobCrm.Api.Tests\bin\Debug\net8.0\..\..\logs\api_20251106_074438.log
[07:44:38 INF] ============================================
[07:44:38 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:38 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:38 INF] No migrations were applied. The database is already up to date.
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Customers" AS c)
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "FieldDefinitions" AS f)
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationLanguages" AS l)
[EntityMetadata] Step 1: Found 1 entity types implementing IEntityMetadataProvider
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[@__metadata_EntityType_0='?'], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
WHERE e."EntityType" = @__metadata_EntityType_0
LIMIT 1
[EntityMetadata] - Already exists: Customer
[EntityMetadata] Step 2: Validating existing metadata records...
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
[EntityMetadata] ? No changes needed (all in sync)
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationResources" AS l)
[xUnit.net 00:00:03.89]     BobCrm.Api.Tests.TemplateTests.Template_NonAdmin_Cannot_Save_As_Default [FAIL]
[xUnit.net 00:00:03.89]       System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
[xUnit.net 00:00:03.89]       Stack Trace:
[xUnit.net 00:00:03.89]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
[xUnit.net 00:00:03.89]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
[xUnit.net 00:00:03.89]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
[xUnit.net 00:00:03.89]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
[xUnit.net 00:00:03.89]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
[xUnit.net 00:00:03.89]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
[xUnit.net 00:00:03.89]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
[xUnit.net 00:00:03.89]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
[xUnit.net 00:00:03.89]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
[xUnit.net 00:00:03.89]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
[xUnit.net 00:00:03.89]            at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
[xUnit.net 00:00:03.89]         C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs(116,0): at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db)
[xUnit.net 00:00:03.89]         C:\workspace\bobcrm\src\BobCrm.Api\Program.cs(147,0): at Program.<Main>$(String[] args)
[xUnit.net 00:00:03.89]            at Program.<Main>(String[] args)
[xUnit.net 00:00:03.89]            at InvokeStub_Program.<Main>(Object, Span`1)
[xUnit.net 00:00:03.89]            at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
[xUnit.net 00:00:03.89]         --- End of stack trace from previous location ---
[xUnit.net 00:00:03.89]            at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
[xUnit.net 00:00:03.89]            at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
[xUnit.net 00:00:03.89]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:03.89]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs(35,0): at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:03.89]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
[xUnit.net 00:00:03.89]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
[xUnit.net 00:00:03.89]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:03.89]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:03.89]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:03.89]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:03.89]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TemplateTests.cs(101,0): at BobCrm.Api.Tests.TemplateTests.Template_NonAdmin_Cannot_Save_As_Default()
[xUnit.net 00:00:03.89]         --- End of stack trace from previous location ---
[07:44:38 INF] ============================================
[07:44:38 INF] Application starting at 11/06/2025 07:44:38, log file: C:\workspace\bobcrm\tests\BobCrm.Api.Tests\bin\Debug\net8.0\..\..\logs\api_20251106_074438.log
[07:44:38 INF] ============================================
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:38 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:38 INF] No migrations were applied. The database is already up to date.
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Customers" AS c)
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "FieldDefinitions" AS f)
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationLanguages" AS l)
[EntityMetadata] Step 1: Found 1 entity types implementing IEntityMetadataProvider
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[@__metadata_EntityType_0='?'], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
WHERE e."EntityType" = @__metadata_EntityType_0
LIMIT 1
[EntityMetadata] - Already exists: Customer
[EntityMetadata] Step 2: Validating existing metadata records...
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
[EntityMetadata] ? No changes needed (all in sync)
[07:44:38 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationResources" AS l)
[xUnit.net 00:00:03.95]     BobCrm.Api.Tests.TemplateTests.Template_User_Can_Save_Personal_Template [FAIL]
[xUnit.net 00:00:03.95]       System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
[xUnit.net 00:00:03.95]       Stack Trace:
[xUnit.net 00:00:03.95]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
[xUnit.net 00:00:03.95]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
[xUnit.net 00:00:03.95]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
[xUnit.net 00:00:03.95]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
[xUnit.net 00:00:03.95]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
[xUnit.net 00:00:03.95]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
[xUnit.net 00:00:03.95]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
[xUnit.net 00:00:03.95]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
[xUnit.net 00:00:03.95]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
[xUnit.net 00:00:03.95]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
[xUnit.net 00:00:03.95]            at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
[xUnit.net 00:00:03.95]         C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs(116,0): at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db)
[xUnit.net 00:00:03.95]         C:\workspace\bobcrm\src\BobCrm.Api\Program.cs(147,0): at Program.<Main>$(String[] args)
[xUnit.net 00:00:03.95]            at Program.<Main>(String[] args)
[xUnit.net 00:00:03.95]            at InvokeStub_Program.<Main>(Object, Span`1)
[xUnit.net 00:00:03.95]            at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
[xUnit.net 00:00:03.95]         --- End of stack trace from previous location ---
[xUnit.net 00:00:03.95]            at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
[xUnit.net 00:00:03.95]            at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
[xUnit.net 00:00:03.95]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:03.95]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs(35,0): at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:03.95]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
[xUnit.net 00:00:03.95]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
[xUnit.net 00:00:03.95]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:03.95]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:03.95]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:03.95]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:03.95]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TemplateTests.cs(39,0): at BobCrm.Api.Tests.TemplateTests.Template_User_Can_Save_Personal_Template()
[xUnit.net 00:00:03.95]         --- End of stack trace from previous location ---
[07:44:39 INF] ============================================
[07:44:39 INF] Application starting at 11/06/2025 07:44:39, log file: C:\workspace\bobcrm\tests\BobCrm.Api.Tests\bin\Debug\net8.0\..\..\logs\api_20251106_074439.log
[07:44:39 INF] ============================================
[07:44:39 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:39 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:39 INF] No migrations were applied. The database is already up to date.
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Customers" AS c)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "FieldDefinitions" AS f)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationLanguages" AS l)
[EntityMetadata] Step 1: Found 1 entity types implementing IEntityMetadataProvider
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[@__metadata_EntityType_0='?'], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
WHERE e."EntityType" = @__metadata_EntityType_0
LIMIT 1
[EntityMetadata] - Already exists: Customer
[EntityMetadata] Step 2: Validating existing metadata records...
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
[EntityMetadata] ? No changes needed (all in sync)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationResources" AS l)
[xUnit.net 00:00:04.02]     BobCrm.Api.Tests.TemplateTests.Template_Default_Exists_After_Initialization [FAIL]
[xUnit.net 00:00:04.02]       System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
[xUnit.net 00:00:04.02]       Stack Trace:
[xUnit.net 00:00:04.02]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
[xUnit.net 00:00:04.02]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
[xUnit.net 00:00:04.02]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
[xUnit.net 00:00:04.02]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
[xUnit.net 00:00:04.02]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
[xUnit.net 00:00:04.02]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
[xUnit.net 00:00:04.02]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
[xUnit.net 00:00:04.02]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
[xUnit.net 00:00:04.02]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
[xUnit.net 00:00:04.02]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
[xUnit.net 00:00:04.02]            at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
[xUnit.net 00:00:04.02]         C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs(116,0): at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db)
[xUnit.net 00:00:04.02]         C:\workspace\bobcrm\src\BobCrm.Api\Program.cs(147,0): at Program.<Main>$(String[] args)
[xUnit.net 00:00:04.02]            at Program.<Main>(String[] args)
[xUnit.net 00:00:04.02]            at InvokeStub_Program.<Main>(Object, Span`1)
[xUnit.net 00:00:04.02]            at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
[xUnit.net 00:00:04.02]         --- End of stack trace from previous location ---
[xUnit.net 00:00:04.02]            at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
[xUnit.net 00:00:04.02]            at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
[xUnit.net 00:00:04.02]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:04.02]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs(35,0): at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:04.02]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
[xUnit.net 00:00:04.02]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
[xUnit.net 00:00:04.02]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:04.02]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:04.02]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:04.02]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:04.02]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TemplateTests.cs(18,0): at BobCrm.Api.Tests.TemplateTests.Template_Default_Exists_After_Initialization()
[xUnit.net 00:00:04.02]         --- End of stack trace from previous location ---
  螟ｱ謨・BobCrm.Api.Tests.LayoutTests.Layout_CRUD_User_And_Default [57 ms]
  繧ｨ繝ｩ繝ｼ 繝｡繝・そ繝ｼ繧ｸ:
   System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
  繧ｹ繧ｿ繝・け 繝医Ξ繝ｼ繧ｹ:
     at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
   at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db) in C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs:line 116
   at Program.<Main>$(String[] args) in C:\workspace\bobcrm\src\BobCrm.Api\Program.cs:line 147
   at Program.<Main>(String[] args)
   at InvokeStub_Program.<Main>(Object, Span`1)
   at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
   at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder) in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs:line 35
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at BobCrm.Api.Tests.LayoutTests.Layout_CRUD_User_And_Default() in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\LayoutTests.cs:line 15
--- End of stack trace from previous location ---
  螟ｱ謨・BobCrm.Api.Tests.AuthTests.Login_Refresh_Session_Ok [69 ms]
  繧ｨ繝ｩ繝ｼ 繝｡繝・そ繝ｼ繧ｸ:
   System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
  繧ｹ繧ｿ繝・け 繝医Ξ繝ｼ繧ｹ:
     at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
   at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db) in C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs:line 116
   at Program.<Main>$(String[] args) in C:\workspace\bobcrm\src\BobCrm.Api\Program.cs:line 147
   at Program.<Main>(String[] args)
   at InvokeStub_Program.<Main>(Object, Span`1)
   at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
   at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder) in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs:line 35
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at BobCrm.Api.Tests.AuthTests.Login_Refresh_Session_Ok() in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\AuthTests.cs:line 15
--- End of stack trace from previous location ---
  螟ｱ謨・BobCrm.Api.Tests.TemplateTests.Template_Independent_Of_Customer_Data [56 ms]
  繧ｨ繝ｩ繝ｼ 繝｡繝・そ繝ｼ繧ｸ:
   System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
  繧ｹ繧ｿ繝・け 繝医Ξ繝ｼ繧ｹ:
     at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
   at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db) in C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs:line 116
   at Program.<Main>$(String[] args) in C:\workspace\bobcrm\src\BobCrm.Api\Program.cs:line 147
   at Program.<Main>(String[] args)
   at InvokeStub_Program.<Main>(Object, Span`1)
   at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
   at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder) in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs:line 35
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at BobCrm.Api.Tests.TemplateTests.Template_Independent_Of_Customer_Data() in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TemplateTests.cs:line 181
--- End of stack trace from previous location ---
  螟ｱ謨・BobCrm.Api.Tests.TemplateTests.Template_Effective_Prioritizes_User_Over_Default [57 ms]
  繧ｨ繝ｩ繝ｼ 繝｡繝・そ繝ｼ繧ｸ:
   System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
  繧ｹ繧ｿ繝・け 繝医Ξ繝ｼ繧ｹ:
     at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
   at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db) in C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs:line 116
   at Program.<Main>$(String[] args) in C:\workspace\bobcrm\src\BobCrm.Api\Program.cs:line 147
   at Program.<Main>(String[] args)
   at InvokeStub_Program.<Main>(Object, Span`1)
   at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
   at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder) in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs:line 35
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at BobCrm.Api.Tests.TemplateTests.Template_Effective_Prioritizes_User_Over_Default() in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TemplateTests.cs:line 156
--- End of stack trace from previous location ---
  螟ｱ謨・BobCrm.Api.Tests.TemplateTests.Template_User_Reset_Returns_To_Default [61 ms]
  繧ｨ繝ｩ繝ｼ 繝｡繝・そ繝ｼ繧ｸ:
   System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
  繧ｹ繧ｿ繝・け 繝医Ξ繝ｼ繧ｹ:
     at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
   at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db) in C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs:line 116
   at Program.<Main>$(String[] args) in C:\workspace\bobcrm\src\BobCrm.Api\Program.cs:line 147
   at Program.<Main>(String[] args)
   at InvokeStub_Program.<Main>(Object, Span`1)
   at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
   at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder) in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs:line 35
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at BobCrm.Api.Tests.TemplateTests.Template_User_Reset_Returns_To_Default() in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TemplateTests.cs:line 121
--- End of stack trace from previous location ---
  螟ｱ謨・BobCrm.Api.Tests.TemplateTests.Template_Admin_Can_Save_As_Default [63 ms]
  繧ｨ繝ｩ繝ｼ 繝｡繝・そ繝ｼ繧ｸ:
   System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
  繧ｹ繧ｿ繝・け 繝医Ξ繝ｼ繧ｹ:
     at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
   at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db) in C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs:line 116
   at Program.<Main>$(String[] args) in C:\workspace\bobcrm\src\BobCrm.Api\Program.cs:line 147
   at Program.<Main>(String[] args)
   at InvokeStub_Program.<Main>(Object, Span`1)
   at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
   at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder) in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs:line 35
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at BobCrm.Api.Tests.TemplateTests.Template_Admin_Can_Save_As_Default() in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TemplateTests.cs:line 70
--- End of stack trace from previous location ---
  螟ｱ謨・BobCrm.Api.Tests.TemplateTests.Template_NonAdmin_Cannot_Save_As_Default [59 ms]
  繧ｨ繝ｩ繝ｼ 繝｡繝・そ繝ｼ繧ｸ:
   System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
  繧ｹ繧ｿ繝・け 繝医Ξ繝ｼ繧ｹ:
     at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
   at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db) in C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs:line 116
   at Program.<Main>$(String[] args) in C:\workspace\bobcrm\src\BobCrm.Api\Program.cs:line 147
   at Program.<Main>(String[] args)
   at InvokeStub_Program.<Main>(Object, Span`1)
   at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
   at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder) in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs:line 35
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at BobCrm.Api.Tests.TemplateTests.Template_NonAdmin_Cannot_Save_As_Default() in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TemplateTests.cs:line 101
--- End of stack trace from previous location ---
  螟ｱ謨・BobCrm.Api.Tests.TemplateTests.Template_User_Can_Save_Personal_Template [59 ms]
  繧ｨ繝ｩ繝ｼ 繝｡繝・そ繝ｼ繧ｸ:
   System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
  繧ｹ繧ｿ繝・け 繝医Ξ繝ｼ繧ｹ:
     at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
   at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db) in C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs:line 116
   at Program.<Main>$(String[] args) in C:\workspace\bobcrm\src\BobCrm.Api\Program.cs:line 147
   at Program.<Main>(String[] args)
   at InvokeStub_Program.<Main>(Object, Span`1)
   at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
   at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder) in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs:line 35
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at BobCrm.Api.Tests.TemplateTests.Template_User_Can_Save_Personal_Template() in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TemplateTests.cs:line 39
--- End of stack trace from previous location ---
  螟ｱ謨・BobCrm.Api.Tests.TemplateTests.Template_Default_Exists_After_Initialization [70 ms]
  繧ｨ繝ｩ繝ｼ 繝｡繝・そ繝ｼ繧ｸ:
   System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
  繧ｹ繧ｿ繝・け 繝医Ξ繝ｼ繧ｹ:
     at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
   at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db) in C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs:line 116
   at Program.<Main>$(String[] args) in C:\workspace\bobcrm\src\BobCrm.Api\Program.cs:line 147
   at Program.<Main>(String[] args)
   at InvokeStub_Program.<Main>(Object, Span`1)
   at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
   at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder) in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs:line 35
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at BobCrm.Api.Tests.TemplateTests.Template_Default_Exists_After_Initialization() in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TemplateTests.cs:line 18
--- End of stack trace from previous location ---
[xUnit.net 00:00:04.02]     BobCrm.Api.Tests.AdminAndAccessTests.Admin_Db_Health_And_Recreate [SKIP]
[xUnit.net 00:00:04.02]       豁､豬玖ｯ穂ｼ夐㍾蟒ｺ謨ｰ謐ｮ蠎灘ｹｶ遐ｴ蝮丞・莉匁ｵ玖ｯ慕噪迥ｶ諤・ｼ御ｻ・惠髫皮ｦｻ霑占｡梧慮菴ｿ逕ｨ
[07:44:39 INF] ============================================
[07:44:39 INF] Application starting at 11/06/2025 07:44:39, log file: C:\workspace\bobcrm\tests\BobCrm.Api.Tests\bin\Debug\net8.0\..\..\logs\api_20251106_074439.log
[07:44:39 INF] ============================================
[07:44:39 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:39 INF] No migrations were applied. The database is already up to date.
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Customers" AS c)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "FieldDefinitions" AS f)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationLanguages" AS l)
[EntityMetadata] Step 1: Found 1 entity types implementing IEntityMetadataProvider
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[@__metadata_EntityType_0='?'], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
WHERE e."EntityType" = @__metadata_EntityType_0
LIMIT 1
[EntityMetadata] - Already exists: Customer
[EntityMetadata] Step 2: Validating existing metadata records...
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
[EntityMetadata] ? No changes needed (all in sync)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationResources" AS l)
[xUnit.net 00:00:04.08]     BobCrm.Api.Tests.AdminAndAccessTests.CustomerAccess_AdminOnly [FAIL]
[xUnit.net 00:00:04.08]       System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
[xUnit.net 00:00:04.08]       Stack Trace:
[xUnit.net 00:00:04.08]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
[xUnit.net 00:00:04.08]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
[xUnit.net 00:00:04.08]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
[xUnit.net 00:00:04.08]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
[xUnit.net 00:00:04.08]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
[xUnit.net 00:00:04.08]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
[xUnit.net 00:00:04.08]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
[xUnit.net 00:00:04.08]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
[xUnit.net 00:00:04.08]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
[xUnit.net 00:00:04.08]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
[xUnit.net 00:00:04.08]            at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
[xUnit.net 00:00:04.08]         C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs(116,0): at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db)
[xUnit.net 00:00:04.08]         C:\workspace\bobcrm\src\BobCrm.Api\Program.cs(147,0): at Program.<Main>$(String[] args)
[xUnit.net 00:00:04.08]            at Program.<Main>(String[] args)
[xUnit.net 00:00:04.08]            at InvokeStub_Program.<Main>(Object, Span`1)
[xUnit.net 00:00:04.08]            at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
[xUnit.net 00:00:04.08]         --- End of stack trace from previous location ---
[xUnit.net 00:00:04.08]            at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
[xUnit.net 00:00:04.08]            at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
[xUnit.net 00:00:04.08]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:04.08]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs(35,0): at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:04.08]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
[xUnit.net 00:00:04.08]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
[xUnit.net 00:00:04.08]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:04.08]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:04.08]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:04.08]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:04.08]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\AdminAndAccessTests.cs(97,0): at BobCrm.Api.Tests.AdminAndAccessTests.CustomerAccess_AdminOnly()
[xUnit.net 00:00:04.08]         --- End of stack trace from previous location ---
[07:44:39 INF] ============================================
[07:44:39 INF] Application starting at 11/06/2025 07:44:39, log file: C:\workspace\bobcrm\tests\BobCrm.Api.Tests\bin\Debug\net8.0\..\..\logs\api_20251106_074439.log
[07:44:39 INF] ============================================
[07:44:39 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:39 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:39 INF] No migrations were applied. The database is already up to date.
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Customers" AS c)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "FieldDefinitions" AS f)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationLanguages" AS l)
[EntityMetadata] Step 1: Found 1 entity types implementing IEntityMetadataProvider
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[@__metadata_EntityType_0='?'], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
WHERE e."EntityType" = @__metadata_EntityType_0
LIMIT 1
[EntityMetadata] - Already exists: Customer
[EntityMetadata] Step 2: Validating existing metadata records...
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
[EntityMetadata] ? No changes needed (all in sync)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationResources" AS l)
[xUnit.net 00:00:04.13]     BobCrm.Api.Tests.FieldActionTests.RdpDownload_WithValidHost_ReturnsRdpFile [FAIL]
[xUnit.net 00:00:04.13]       System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
[xUnit.net 00:00:04.13]       Stack Trace:
[xUnit.net 00:00:04.13]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
[xUnit.net 00:00:04.13]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
[xUnit.net 00:00:04.13]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
[xUnit.net 00:00:04.13]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
[xUnit.net 00:00:04.13]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
[xUnit.net 00:00:04.13]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
[xUnit.net 00:00:04.13]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
[xUnit.net 00:00:04.13]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
[xUnit.net 00:00:04.13]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
[xUnit.net 00:00:04.13]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
[xUnit.net 00:00:04.13]            at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
[xUnit.net 00:00:04.13]         C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs(116,0): at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db)
[xUnit.net 00:00:04.13]         C:\workspace\bobcrm\src\BobCrm.Api\Program.cs(147,0): at Program.<Main>$(String[] args)
[xUnit.net 00:00:04.13]            at Program.<Main>(String[] args)
[xUnit.net 00:00:04.13]            at InvokeStub_Program.<Main>(Object, Span`1)
[xUnit.net 00:00:04.13]            at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
[xUnit.net 00:00:04.13]         --- End of stack trace from previous location ---
[xUnit.net 00:00:04.13]            at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
[xUnit.net 00:00:04.13]            at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
[xUnit.net 00:00:04.13]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:04.13]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs(35,0): at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:04.13]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
[xUnit.net 00:00:04.13]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
[xUnit.net 00:00:04.13]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:04.13]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:04.13]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:04.13]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:04.13]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\FieldActionTests.cs(20,0): at BobCrm.Api.Tests.FieldActionTests.RdpDownload_WithValidHost_ReturnsRdpFile()
[xUnit.net 00:00:04.13]         --- End of stack trace from previous location ---
[07:44:39 INF] ============================================
[07:44:39 INF] Application starting at 11/06/2025 07:44:39, log file: C:\workspace\bobcrm\tests\BobCrm.Api.Tests\bin\Debug\net8.0\..\..\logs\api_20251106_074439.log
[07:44:39 INF] ============================================
[07:44:39 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:39 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:39 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:39 INF] No migrations were applied. The database is already up to date.
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Customers" AS c)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "FieldDefinitions" AS f)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationLanguages" AS l)
[EntityMetadata] Step 1: Found 1 entity types implementing IEntityMetadataProvider
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[@__metadata_EntityType_0='?'], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
WHERE e."EntityType" = @__metadata_EntityType_0
LIMIT 1
[EntityMetadata] - Already exists: Customer
[EntityMetadata] Step 2: Validating existing metadata records...
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
[EntityMetadata] ? No changes needed (all in sync)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationResources" AS l)
[xUnit.net 00:00:04.19]     BobCrm.Api.Tests.FieldActionTests.FieldActions_RequireAuthentication [FAIL]
[xUnit.net 00:00:04.19]       System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
[xUnit.net 00:00:04.19]       Stack Trace:
[xUnit.net 00:00:04.19]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
[xUnit.net 00:00:04.19]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
[xUnit.net 00:00:04.19]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
[xUnit.net 00:00:04.19]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
[xUnit.net 00:00:04.19]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
[xUnit.net 00:00:04.19]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
[xUnit.net 00:00:04.19]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
[xUnit.net 00:00:04.19]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
[xUnit.net 00:00:04.19]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
[xUnit.net 00:00:04.19]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
[xUnit.net 00:00:04.19]            at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
[xUnit.net 00:00:04.19]         C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs(116,0): at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db)
[xUnit.net 00:00:04.19]         C:\workspace\bobcrm\src\BobCrm.Api\Program.cs(147,0): at Program.<Main>$(String[] args)
[xUnit.net 00:00:04.19]            at Program.<Main>(String[] args)
[xUnit.net 00:00:04.19]            at InvokeStub_Program.<Main>(Object, Span`1)
[xUnit.net 00:00:04.19]            at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
[xUnit.net 00:00:04.19]         --- End of stack trace from previous location ---
[xUnit.net 00:00:04.19]            at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
[xUnit.net 00:00:04.19]            at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
[xUnit.net 00:00:04.19]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:04.19]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs(35,0): at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:04.20]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
[xUnit.net 00:00:04.20]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
[xUnit.net 00:00:04.20]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:04.20]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:04.20]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:04.20]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:04.20]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\FieldActionTests.cs(295,0): at BobCrm.Api.Tests.FieldActionTests.FieldActions_RequireAuthentication()
[xUnit.net 00:00:04.20]         --- End of stack trace from previous location ---
[07:44:39 INF] ============================================
[07:44:39 INF] Application starting at 11/06/2025 07:44:39, log file: C:\workspace\bobcrm\tests\BobCrm.Api.Tests\bin\Debug\net8.0\..\..\logs\api_20251106_074439.log
[07:44:39 INF] ============================================
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:39 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:39 INF] No migrations were applied. The database is already up to date.
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Customers" AS c)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "FieldDefinitions" AS f)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationLanguages" AS l)
[EntityMetadata] Step 1: Found 1 entity types implementing IEntityMetadataProvider
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[@__metadata_EntityType_0='?'], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
WHERE e."EntityType" = @__metadata_EntityType_0
LIMIT 1
[EntityMetadata] - Already exists: Customer
[EntityMetadata] Step 2: Validating existing metadata records...
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
[EntityMetadata] ? No changes needed (all in sync)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationResources" AS l)
[xUnit.net 00:00:04.26]     BobCrm.Api.Tests.FieldActionTests.MailtoGenerate_WithEmail_ReturnsMailtoLink [FAIL]
[xUnit.net 00:00:04.26]       System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
[xUnit.net 00:00:04.26]       Stack Trace:
[xUnit.net 00:00:04.26]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
[xUnit.net 00:00:04.26]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
[xUnit.net 00:00:04.26]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
[xUnit.net 00:00:04.26]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
[xUnit.net 00:00:04.26]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
[xUnit.net 00:00:04.26]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
[xUnit.net 00:00:04.26]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
[xUnit.net 00:00:04.26]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
[xUnit.net 00:00:04.26]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
[xUnit.net 00:00:04.26]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
[xUnit.net 00:00:04.26]            at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
[xUnit.net 00:00:04.26]         C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs(116,0): at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db)
[xUnit.net 00:00:04.26]         C:\workspace\bobcrm\src\BobCrm.Api\Program.cs(147,0): at Program.<Main>$(String[] args)
[xUnit.net 00:00:04.26]            at Program.<Main>(String[] args)
[xUnit.net 00:00:04.26]            at InvokeStub_Program.<Main>(Object, Span`1)
[xUnit.net 00:00:04.26]            at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
[xUnit.net 00:00:04.26]         --- End of stack trace from previous location ---
[xUnit.net 00:00:04.26]            at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
[xUnit.net 00:00:04.26]            at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
[xUnit.net 00:00:04.26]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:04.26]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs(35,0): at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:04.26]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
[xUnit.net 00:00:04.26]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
[xUnit.net 00:00:04.26]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:04.26]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:04.26]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:04.26]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:04.26]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\FieldActionTests.cs(221,0): at BobCrm.Api.Tests.FieldActionTests.MailtoGenerate_WithEmail_ReturnsMailtoLink()
[xUnit.net 00:00:04.26]         --- End of stack trace from previous location ---
[07:44:39 INF] ============================================
[07:44:39 INF] Application starting at 11/06/2025 07:44:39, log file: C:\workspace\bobcrm\tests\BobCrm.Api.Tests\bin\Debug\net8.0\..\..\logs\api_20251106_074439.log
[07:44:39 INF] ============================================
[07:44:39 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:39 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:39 INF] No migrations were applied. The database is already up to date.
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Customers" AS c)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "FieldDefinitions" AS f)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationLanguages" AS l)
[EntityMetadata] Step 1: Found 1 entity types implementing IEntityMetadataProvider
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[@__metadata_EntityType_0='?'], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
WHERE e."EntityType" = @__metadata_EntityType_0
LIMIT 1
[EntityMetadata] - Already exists: Customer
[EntityMetadata] Step 2: Validating existing metadata records...
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
[EntityMetadata] ? No changes needed (all in sync)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationResources" AS l)
[xUnit.net 00:00:04.32]     BobCrm.Api.Tests.FieldActionTests.RdpDownload_WithoutHost_ReturnsBadRequest [FAIL]
[xUnit.net 00:00:04.32]       System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
[xUnit.net 00:00:04.32]       Stack Trace:
[xUnit.net 00:00:04.32]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
[xUnit.net 00:00:04.32]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
[xUnit.net 00:00:04.32]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
[xUnit.net 00:00:04.32]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
[xUnit.net 00:00:04.32]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
[xUnit.net 00:00:04.32]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
[xUnit.net 00:00:04.32]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
[xUnit.net 00:00:04.32]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
[xUnit.net 00:00:04.32]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
[xUnit.net 00:00:04.32]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
[xUnit.net 00:00:04.32]            at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
[xUnit.net 00:00:04.32]         C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs(116,0): at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db)
[xUnit.net 00:00:04.32]         C:\workspace\bobcrm\src\BobCrm.Api\Program.cs(147,0): at Program.<Main>$(String[] args)
[xUnit.net 00:00:04.32]            at Program.<Main>(String[] args)
[xUnit.net 00:00:04.32]            at InvokeStub_Program.<Main>(Object, Span`1)
[xUnit.net 00:00:04.32]            at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
[xUnit.net 00:00:04.32]         --- End of stack trace from previous location ---
[xUnit.net 00:00:04.32]            at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
[xUnit.net 00:00:04.32]            at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
[xUnit.net 00:00:04.32]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:04.32]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs(35,0): at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:04.32]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
[xUnit.net 00:00:04.32]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
[xUnit.net 00:00:04.32]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:04.32]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:04.32]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:04.32]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:04.32]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\FieldActionTests.cs(75,0): at BobCrm.Api.Tests.FieldActionTests.RdpDownload_WithoutHost_ReturnsBadRequest()
[xUnit.net 00:00:04.32]         --- End of stack trace from previous location ---
[07:44:39 INF] ============================================
[07:44:39 INF] Application starting at 11/06/2025 07:44:39, log file: C:\workspace\bobcrm\tests\BobCrm.Api.Tests\bin\Debug\net8.0\..\..\logs\api_20251106_074439.log
[07:44:39 INF] ============================================
[07:44:39 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:39 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:39 INF] No migrations were applied. The database is already up to date.
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Customers" AS c)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "FieldDefinitions" AS f)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationLanguages" AS l)
[EntityMetadata] Step 1: Found 1 entity types implementing IEntityMetadataProvider
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[@__metadata_EntityType_0='?'], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
WHERE e."EntityType" = @__metadata_EntityType_0
LIMIT 1
[EntityMetadata] - Already exists: Customer
[EntityMetadata] Step 2: Validating existing metadata records...
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
[EntityMetadata] ? No changes needed (all in sync)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationResources" AS l)
[xUnit.net 00:00:04.37]     BobCrm.Api.Tests.FieldActionTests.RdpDownload_WithDomain_IncludesDomainSetting [FAIL]
[xUnit.net 00:00:04.37]       System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
[xUnit.net 00:00:04.37]       Stack Trace:
[xUnit.net 00:00:04.37]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
[xUnit.net 00:00:04.37]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
[xUnit.net 00:00:04.37]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
[xUnit.net 00:00:04.37]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
[xUnit.net 00:00:04.37]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
[xUnit.net 00:00:04.37]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
[xUnit.net 00:00:04.37]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
[xUnit.net 00:00:04.37]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
[xUnit.net 00:00:04.37]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
[xUnit.net 00:00:04.37]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
[xUnit.net 00:00:04.37]            at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
[xUnit.net 00:00:04.37]         C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs(116,0): at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db)
[xUnit.net 00:00:04.37]         C:\workspace\bobcrm\src\BobCrm.Api\Program.cs(147,0): at Program.<Main>$(String[] args)
[xUnit.net 00:00:04.37]            at Program.<Main>(String[] args)
[xUnit.net 00:00:04.37]            at InvokeStub_Program.<Main>(Object, Span`1)
[xUnit.net 00:00:04.37]            at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
[xUnit.net 00:00:04.37]         --- End of stack trace from previous location ---
[xUnit.net 00:00:04.37]            at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
[xUnit.net 00:00:04.37]            at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
[xUnit.net 00:00:04.37]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:04.37]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs(35,0): at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:04.37]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
[xUnit.net 00:00:04.37]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
[xUnit.net 00:00:04.37]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:04.37]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:04.37]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:04.37]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:04.37]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\FieldActionTests.cs(100,0): at BobCrm.Api.Tests.FieldActionTests.RdpDownload_WithDomain_IncludesDomainSetting()
[xUnit.net 00:00:04.37]         --- End of stack trace from previous location ---
[07:44:39 INF] ============================================
[07:44:39 INF] Application starting at 11/06/2025 07:44:39, log file: C:\workspace\bobcrm\tests\BobCrm.Api.Tests\bin\Debug\net8.0\..\..\logs\api_20251106_074439.log
[07:44:39 INF] ============================================
[07:44:39 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:39 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:39 INF] No migrations were applied. The database is already up to date.
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Customers" AS c)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "FieldDefinitions" AS f)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationLanguages" AS l)
[EntityMetadata] Step 1: Found 1 entity types implementing IEntityMetadataProvider
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[@__metadata_EntityType_0='?'], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
WHERE e."EntityType" = @__metadata_EntityType_0
LIMIT 1
[EntityMetadata] - Already exists: Customer
[EntityMetadata] Step 2: Validating existing metadata records...
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
[EntityMetadata] ? No changes needed (all in sync)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationResources" AS l)
[xUnit.net 00:00:04.43]     BobCrm.Api.Tests.FieldActionTests.MailtoGenerate_WithoutEmail_ReturnsBadRequest [FAIL]
[xUnit.net 00:00:04.43]       System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
[xUnit.net 00:00:04.43]       Stack Trace:
[xUnit.net 00:00:04.43]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
[xUnit.net 00:00:04.43]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
[xUnit.net 00:00:04.43]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
[xUnit.net 00:00:04.43]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
[xUnit.net 00:00:04.43]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
[xUnit.net 00:00:04.43]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
[xUnit.net 00:00:04.43]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
[xUnit.net 00:00:04.43]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
[xUnit.net 00:00:04.43]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
[xUnit.net 00:00:04.43]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
[xUnit.net 00:00:04.43]            at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
[xUnit.net 00:00:04.43]         C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs(116,0): at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db)
[xUnit.net 00:00:04.43]         C:\workspace\bobcrm\src\BobCrm.Api\Program.cs(147,0): at Program.<Main>$(String[] args)
[xUnit.net 00:00:04.43]            at Program.<Main>(String[] args)
[xUnit.net 00:00:04.43]            at InvokeStub_Program.<Main>(Object, Span`1)
[xUnit.net 00:00:04.43]            at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
[xUnit.net 00:00:04.43]         --- End of stack trace from previous location ---
[xUnit.net 00:00:04.43]            at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
[xUnit.net 00:00:04.43]            at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
[xUnit.net 00:00:04.44]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:04.44]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs(35,0): at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:04.44]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
[xUnit.net 00:00:04.44]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
[xUnit.net 00:00:04.44]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:04.44]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:04.44]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:04.44]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:04.44]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\FieldActionTests.cs(274,0): at BobCrm.Api.Tests.FieldActionTests.MailtoGenerate_WithoutEmail_ReturnsBadRequest()
[xUnit.net 00:00:04.44]         --- End of stack trace from previous location ---
[07:44:39 INF] ============================================
[07:44:39 INF] Application starting at 11/06/2025 07:44:39, log file: C:\workspace\bobcrm\tests\BobCrm.Api.Tests\bin\Debug\net8.0\..\..\logs\api_20251106_074439.log
[07:44:39 INF] ============================================
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:39 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:39 INF] No migrations were applied. The database is already up to date.
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Customers" AS c)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "FieldDefinitions" AS f)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationLanguages" AS l)
[EntityMetadata] Step 1: Found 1 entity types implementing IEntityMetadataProvider
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[@__metadata_EntityType_0='?'], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
WHERE e."EntityType" = @__metadata_EntityType_0
LIMIT 1
[EntityMetadata] - Already exists: Customer
[EntityMetadata] Step 2: Validating existing metadata records...
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
[EntityMetadata] ? No changes needed (all in sync)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationResources" AS l)
[xUnit.net 00:00:04.49]     BobCrm.Api.Tests.FieldActionTests.MailtoGenerate_WithSubjectAndBody_IncludesQueryParams [FAIL]
[xUnit.net 00:00:04.49]       System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
[xUnit.net 00:00:04.49]       Stack Trace:
[xUnit.net 00:00:04.49]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
[xUnit.net 00:00:04.49]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
[xUnit.net 00:00:04.49]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
[xUnit.net 00:00:04.49]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
[xUnit.net 00:00:04.49]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
[xUnit.net 00:00:04.49]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
[xUnit.net 00:00:04.49]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
[xUnit.net 00:00:04.49]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
[xUnit.net 00:00:04.49]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
[xUnit.net 00:00:04.49]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
[xUnit.net 00:00:04.49]            at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
[xUnit.net 00:00:04.49]         C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs(116,0): at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db)
[xUnit.net 00:00:04.49]         C:\workspace\bobcrm\src\BobCrm.Api\Program.cs(147,0): at Program.<Main>$(String[] args)
[xUnit.net 00:00:04.49]            at Program.<Main>(String[] args)
[xUnit.net 00:00:04.49]            at InvokeStub_Program.<Main>(Object, Span`1)
[xUnit.net 00:00:04.49]            at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
[xUnit.net 00:00:04.49]         --- End of stack trace from previous location ---
[xUnit.net 00:00:04.49]            at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
[xUnit.net 00:00:04.49]            at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
[xUnit.net 00:00:04.49]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:04.49]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs(35,0): at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:04.49]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
[xUnit.net 00:00:04.49]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
[xUnit.net 00:00:04.49]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:04.49]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:04.49]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:04.49]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:04.49]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\FieldActionTests.cs(245,0): at BobCrm.Api.Tests.FieldActionTests.MailtoGenerate_WithSubjectAndBody_IncludesQueryParams()
[xUnit.net 00:00:04.49]         --- End of stack trace from previous location ---
  繧ｹ繧ｭ繝・・ BobCrm.Api.Tests.AdminAndAccessTests.Admin_Db_Health_And_Recreate [1 ms]
  繧ｨ繝ｩ繝ｼ 繝｡繝・そ繝ｼ繧ｸ:
   豁､豬玖ｯ穂ｼ夐㍾蟒ｺ謨ｰ謐ｮ蠎灘ｹｶ遐ｴ蝮丞・莉匁ｵ玖ｯ慕噪迥ｶ諤・ｼ御ｻ・惠髫皮ｦｻ霑占｡梧慮菴ｿ逕ｨ

  螟ｱ謨・BobCrm.Api.Tests.AdminAndAccessTests.CustomerAccess_AdminOnly [56 ms]
  繧ｨ繝ｩ繝ｼ 繝｡繝・そ繝ｼ繧ｸ:
   System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
  繧ｹ繧ｿ繝・け 繝医Ξ繝ｼ繧ｹ:
     at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
   at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db) in C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs:line 116
   at Program.<Main>$(String[] args) in C:\workspace\bobcrm\src\BobCrm.Api\Program.cs:line 147
   at Program.<Main>(String[] args)
   at InvokeStub_Program.<Main>(Object, Span`1)
   at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
   at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder) in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs:line 35
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at BobCrm.Api.Tests.AdminAndAccessTests.CustomerAccess_AdminOnly() in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\AdminAndAccessTests.cs:line 97
--- End of stack trace from previous location ---
  螟ｱ謨・BobCrm.Api.Tests.FieldActionTests.RdpDownload_WithValidHost_ReturnsRdpFile [51 ms]
  繧ｨ繝ｩ繝ｼ 繝｡繝・そ繝ｼ繧ｸ:
   System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
  繧ｹ繧ｿ繝・け 繝医Ξ繝ｼ繧ｹ:
     at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
   at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db) in C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs:line 116
   at Program.<Main>$(String[] args) in C:\workspace\bobcrm\src\BobCrm.Api\Program.cs:line 147
   at Program.<Main>(String[] args)
   at InvokeStub_Program.<Main>(Object, Span`1)
   at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
   at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder) in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs:line 35
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at BobCrm.Api.Tests.FieldActionTests.RdpDownload_WithValidHost_ReturnsRdpFile() in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\FieldActionTests.cs:line 20
--- End of stack trace from previous location ---
  螟ｱ謨・BobCrm.Api.Tests.FieldActionTests.FieldActions_RequireAuthentication [60 ms]
  繧ｨ繝ｩ繝ｼ 繝｡繝・そ繝ｼ繧ｸ:
   System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
  繧ｹ繧ｿ繝・け 繝医Ξ繝ｼ繧ｹ:
     at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
   at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db) in C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs:line 116
   at Program.<Main>$(String[] args) in C:\workspace\bobcrm\src\BobCrm.Api\Program.cs:line 147
   at Program.<Main>(String[] args)
   at InvokeStub_Program.<Main>(Object, Span`1)
   at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
   at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder) in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs:line 35
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at BobCrm.Api.Tests.FieldActionTests.FieldActions_RequireAuthentication() in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\FieldActionTests.cs:line 295
--- End of stack trace from previous location ---
  螟ｱ謨・BobCrm.Api.Tests.FieldActionTests.MailtoGenerate_WithEmail_ReturnsMailtoLink [66 ms]
  繧ｨ繝ｩ繝ｼ 繝｡繝・そ繝ｼ繧ｸ:
   System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
  繧ｹ繧ｿ繝・け 繝医Ξ繝ｼ繧ｹ:
     at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
   at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db) in C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs:line 116
   at Program.<Main>$(String[] args) in C:\workspace\bobcrm\src\BobCrm.Api\Program.cs:line 147
   at Program.<Main>(String[] args)
   at InvokeStub_Program.<Main>(Object, Span`1)
   at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
   at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder) in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs:line 35
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at BobCrm.Api.Tests.FieldActionTests.MailtoGenerate_WithEmail_ReturnsMailtoLink() in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\FieldActionTests.cs:line 221
--- End of stack trace from previous location ---
  螟ｱ謨・BobCrm.Api.Tests.FieldActionTests.RdpDownload_WithoutHost_ReturnsBadRequest [54 ms]
  繧ｨ繝ｩ繝ｼ 繝｡繝・そ繝ｼ繧ｸ:
   System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
  繧ｹ繧ｿ繝・け 繝医Ξ繝ｼ繧ｹ:
     at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
   at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db) in C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs:line 116
   at Program.<Main>$(String[] args) in C:\workspace\bobcrm\src\BobCrm.Api\Program.cs:line 147
   at Program.<Main>(String[] args)
   at InvokeStub_Program.<Main>(Object, Span`1)
   at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
   at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder) in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs:line 35
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at BobCrm.Api.Tests.FieldActionTests.RdpDownload_WithoutHost_ReturnsBadRequest() in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\FieldActionTests.cs:line 75
--- End of stack trace from previous location ---
  螟ｱ謨・BobCrm.Api.Tests.FieldActionTests.RdpDownload_WithDomain_IncludesDomainSetting [53 ms]
  繧ｨ繝ｩ繝ｼ 繝｡繝・そ繝ｼ繧ｸ:
   System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
  繧ｹ繧ｿ繝・け 繝医Ξ繝ｼ繧ｹ:
     at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
   at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db) in C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs:line 116
   at Program.<Main>$(String[] args) in C:\workspace\bobcrm\src\BobCrm.Api\Program.cs:line 147
   at Program.<Main>(String[] args)
   at InvokeStub_Program.<Main>(Object, Span`1)
   at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
   at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder) in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs:line 35
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at BobCrm.Api.Tests.FieldActionTests.RdpDownload_WithDomain_IncludesDomainSetting() in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\FieldActionTests.cs:line 100
--- End of stack trace from previous location ---
  螟ｱ謨・BobCrm.Api.Tests.FieldActionTests.MailtoGenerate_WithoutEmail_ReturnsBadRequest [56 ms]
  繧ｨ繝ｩ繝ｼ 繝｡繝・そ繝ｼ繧ｸ:
   System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
  繧ｹ繧ｿ繝・け 繝医Ξ繝ｼ繧ｹ:
     at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
   at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db) in C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs:line 116
   at Program.<Main>$(String[] args) in C:\workspace\bobcrm\src\BobCrm.Api\Program.cs:line 147
   at Program.<Main>(String[] args)
   at InvokeStub_Program.<Main>(Object, Span`1)
   at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
   at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder) in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs:line 35
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at BobCrm.Api.Tests.FieldActionTests.MailtoGenerate_WithoutEmail_ReturnsBadRequest() in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\FieldActionTests.cs:line 274
--- End of stack trace from previous location ---
  螟ｱ謨・BobCrm.Api.Tests.FieldActionTests.MailtoGenerate_WithSubjectAndBody_IncludesQueryParams [62 ms]
  繧ｨ繝ｩ繝ｼ 繝｡繝・そ繝ｼ繧ｸ:
   System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
  繧ｹ繧ｿ繝・け 繝医Ξ繝ｼ繧ｹ:
     at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
   at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db) in C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs:line 116
   at Program.<Main>$(String[] args) in C:\workspace\bobcrm\src\BobCrm.Api\Program.cs:line 147
   at Program.<Main>(String[] args)
   at InvokeStub_Program.<Main>(Object, Span`1)
   at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
   at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder) in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs:line 35
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at BobCrm.Api.Tests.FieldActionTests.MailtoGenerate_WithSubjectAndBody_IncludesQueryParams() in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\FieldActionTests.cs:line 245
--- End of stack trace from previous location ---
[07:44:39 INF] ============================================
[07:44:39 INF] Application starting at 11/06/2025 07:44:39, log file: C:\workspace\bobcrm\tests\BobCrm.Api.Tests\bin\Debug\net8.0\..\..\logs\api_20251106_074439.log
[07:44:39 INF] ============================================
[07:44:39 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:39 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:39 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:39 INF] No migrations were applied. The database is already up to date.
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Customers" AS c)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "FieldDefinitions" AS f)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationLanguages" AS l)
[EntityMetadata] Step 1: Found 1 entity types implementing IEntityMetadataProvider
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[@__metadata_EntityType_0='?'], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
WHERE e."EntityType" = @__metadata_EntityType_0
LIMIT 1
[EntityMetadata] - Already exists: Customer
[EntityMetadata] Step 2: Validating existing metadata records...
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
[EntityMetadata] ? No changes needed (all in sync)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationResources" AS l)
[xUnit.net 00:00:04.55]     BobCrm.Api.Tests.FieldActionTests.FileValidate_WithNonExistingFile_ReturnsNotFound [FAIL]
[xUnit.net 00:00:04.55]       System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
[xUnit.net 00:00:04.55]       Stack Trace:
[xUnit.net 00:00:04.55]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
[xUnit.net 00:00:04.55]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
[xUnit.net 00:00:04.55]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
[xUnit.net 00:00:04.55]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
[xUnit.net 00:00:04.55]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
[xUnit.net 00:00:04.55]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
[xUnit.net 00:00:04.55]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
[xUnit.net 00:00:04.55]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
[xUnit.net 00:00:04.55]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
[xUnit.net 00:00:04.55]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
[xUnit.net 00:00:04.55]            at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
[xUnit.net 00:00:04.55]         C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs(116,0): at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db)
[xUnit.net 00:00:04.55]         C:\workspace\bobcrm\src\BobCrm.Api\Program.cs(147,0): at Program.<Main>$(String[] args)
[xUnit.net 00:00:04.55]            at Program.<Main>(String[] args)
[xUnit.net 00:00:04.55]            at InvokeStub_Program.<Main>(Object, Span`1)
[xUnit.net 00:00:04.55]            at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
[xUnit.net 00:00:04.55]         --- End of stack trace from previous location ---
[xUnit.net 00:00:04.55]            at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
[xUnit.net 00:00:04.55]            at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
[xUnit.net 00:00:04.55]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:04.55]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs(35,0): at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:04.55]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
[xUnit.net 00:00:04.55]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
[xUnit.net 00:00:04.55]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:04.55]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:04.55]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:04.55]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:04.55]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\FieldActionTests.cs(179,0): at BobCrm.Api.Tests.FieldActionTests.FileValidate_WithNonExistingFile_ReturnsNotFound()
[xUnit.net 00:00:04.55]         --- End of stack trace from previous location ---
[07:44:39 INF] ============================================
[07:44:39 INF] Application starting at 11/06/2025 07:44:39, log file: C:\workspace\bobcrm\tests\BobCrm.Api.Tests\bin\Debug\net8.0\..\..\logs\api_20251106_074439.log
[07:44:39 INF] ============================================
[07:44:39 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:39 INF] No migrations were applied. The database is already up to date.
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Customers" AS c)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "FieldDefinitions" AS f)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationLanguages" AS l)
[EntityMetadata] Step 1: Found 1 entity types implementing IEntityMetadataProvider
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[@__metadata_EntityType_0='?'], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
WHERE e."EntityType" = @__metadata_EntityType_0
LIMIT 1
[EntityMetadata] - Already exists: Customer
[EntityMetadata] Step 2: Validating existing metadata records...
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
[EntityMetadata] ? No changes needed (all in sync)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationResources" AS l)
[xUnit.net 00:00:04.60]     BobCrm.Api.Tests.FieldActionTests.RdpDownload_WithRedirectOptions_IncludesRedirectSettings [FAIL]
[xUnit.net 00:00:04.60]       System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
[xUnit.net 00:00:04.60]       Stack Trace:
[xUnit.net 00:00:04.60]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
[xUnit.net 00:00:04.60]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
[xUnit.net 00:00:04.60]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
[xUnit.net 00:00:04.60]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
[xUnit.net 00:00:04.60]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
[xUnit.net 00:00:04.60]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
[xUnit.net 00:00:04.60]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
[xUnit.net 00:00:04.60]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
[xUnit.net 00:00:04.60]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
[xUnit.net 00:00:04.60]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
[xUnit.net 00:00:04.60]            at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
[xUnit.net 00:00:04.60]         C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs(116,0): at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db)
[xUnit.net 00:00:04.60]         C:\workspace\bobcrm\src\BobCrm.Api\Program.cs(147,0): at Program.<Main>$(String[] args)
[xUnit.net 00:00:04.60]            at Program.<Main>(String[] args)
[xUnit.net 00:00:04.60]            at InvokeStub_Program.<Main>(Object, Span`1)
[xUnit.net 00:00:04.60]            at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
[xUnit.net 00:00:04.60]         --- End of stack trace from previous location ---
[xUnit.net 00:00:04.60]            at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
[xUnit.net 00:00:04.60]            at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
[xUnit.net 00:00:04.60]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:04.60]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs(35,0): at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:04.60]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
[xUnit.net 00:00:04.60]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
[xUnit.net 00:00:04.60]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:04.60]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:04.60]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:04.60]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:04.60]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\FieldActionTests.cs(125,0): at BobCrm.Api.Tests.FieldActionTests.RdpDownload_WithRedirectOptions_IncludesRedirectSettings()
[xUnit.net 00:00:04.60]         --- End of stack trace from previous location ---
[07:44:39 INF] ============================================
[07:44:39 INF] Application starting at 11/06/2025 07:44:39, log file: C:\workspace\bobcrm\tests\BobCrm.Api.Tests\bin\Debug\net8.0\..\..\logs\api_20251106_074439.log
[07:44:39 INF] ============================================
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:39 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:39 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:39 INF] No migrations were applied. The database is already up to date.
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Customers" AS c)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "FieldDefinitions" AS f)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationLanguages" AS l)
[EntityMetadata] Step 1: Found 1 entity types implementing IEntityMetadataProvider
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[@__metadata_EntityType_0='?'], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
WHERE e."EntityType" = @__metadata_EntityType_0
LIMIT 1
[EntityMetadata] - Already exists: Customer
[EntityMetadata] Step 2: Validating existing metadata records...
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
[EntityMetadata] ? No changes needed (all in sync)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationResources" AS l)
[xUnit.net 00:00:04.66]     BobCrm.Api.Tests.FieldActionTests.RdpDownload_WithCustomPort_IncludesPortInAddress [FAIL]
[xUnit.net 00:00:04.66]       System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
[xUnit.net 00:00:04.66]       Stack Trace:
[xUnit.net 00:00:04.66]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
[xUnit.net 00:00:04.66]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
[xUnit.net 00:00:04.66]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
[xUnit.net 00:00:04.66]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
[xUnit.net 00:00:04.66]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
[xUnit.net 00:00:04.66]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
[xUnit.net 00:00:04.66]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
[xUnit.net 00:00:04.66]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
[xUnit.net 00:00:04.66]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
[xUnit.net 00:00:04.66]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
[xUnit.net 00:00:04.66]            at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
[xUnit.net 00:00:04.66]         C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs(116,0): at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db)
[xUnit.net 00:00:04.66]         C:\workspace\bobcrm\src\BobCrm.Api\Program.cs(147,0): at Program.<Main>$(String[] args)
[xUnit.net 00:00:04.66]            at Program.<Main>(String[] args)
[xUnit.net 00:00:04.66]            at InvokeStub_Program.<Main>(Object, Span`1)
[xUnit.net 00:00:04.66]            at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
[xUnit.net 00:00:04.66]         --- End of stack trace from previous location ---
[xUnit.net 00:00:04.66]            at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
[xUnit.net 00:00:04.66]            at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
[xUnit.net 00:00:04.66]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:04.66]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs(35,0): at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:04.66]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
[xUnit.net 00:00:04.66]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
[xUnit.net 00:00:04.66]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:04.66]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:04.66]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:04.66]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:04.66]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\FieldActionTests.cs(51,0): at BobCrm.Api.Tests.FieldActionTests.RdpDownload_WithCustomPort_IncludesPortInAddress()
[xUnit.net 00:00:04.66]         --- End of stack trace from previous location ---
[07:44:39 INF] ============================================
[07:44:39 INF] Application starting at 11/06/2025 07:44:39, log file: C:\workspace\bobcrm\tests\BobCrm.Api.Tests\bin\Debug\net8.0\..\..\logs\api_20251106_074439.log
[07:44:39 INF] ============================================
[07:44:39 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:39 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:39 INF] No migrations were applied. The database is already up to date.
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Customers" AS c)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "FieldDefinitions" AS f)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationLanguages" AS l)
[EntityMetadata] Step 1: Found 1 entity types implementing IEntityMetadataProvider
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[@__metadata_EntityType_0='?'], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
WHERE e."EntityType" = @__metadata_EntityType_0
LIMIT 1
[EntityMetadata] - Already exists: Customer
[EntityMetadata] Step 2: Validating existing metadata records...
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
[EntityMetadata] ? No changes needed (all in sync)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationResources" AS l)
[xUnit.net 00:00:04.72]     BobCrm.Api.Tests.FieldActionTests.FileValidate_WithExistingFile_ReturnsExists [FAIL]
[xUnit.net 00:00:04.72]       System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
[xUnit.net 00:00:04.72]       Stack Trace:
[xUnit.net 00:00:04.72]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
[xUnit.net 00:00:04.72]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
[xUnit.net 00:00:04.72]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
[xUnit.net 00:00:04.72]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
[xUnit.net 00:00:04.72]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
[xUnit.net 00:00:04.72]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
[xUnit.net 00:00:04.72]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
[xUnit.net 00:00:04.72]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
[xUnit.net 00:00:04.72]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
[xUnit.net 00:00:04.72]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
[xUnit.net 00:00:04.72]            at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
[xUnit.net 00:00:04.72]         C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs(116,0): at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db)
[xUnit.net 00:00:04.72]         C:\workspace\bobcrm\src\BobCrm.Api\Program.cs(147,0): at Program.<Main>$(String[] args)
[xUnit.net 00:00:04.72]            at Program.<Main>(String[] args)
[xUnit.net 00:00:04.72]            at InvokeStub_Program.<Main>(Object, Span`1)
[xUnit.net 00:00:04.72]            at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
[xUnit.net 00:00:04.72]         --- End of stack trace from previous location ---
[xUnit.net 00:00:04.72]            at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
[xUnit.net 00:00:04.72]            at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
[xUnit.net 00:00:04.72]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:04.72]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs(35,0): at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:04.72]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
[xUnit.net 00:00:04.72]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
[xUnit.net 00:00:04.72]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:04.72]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:04.72]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:04.72]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:04.72]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\FieldActionTests.cs(153,0): at BobCrm.Api.Tests.FieldActionTests.FileValidate_WithExistingFile_ReturnsExists()
[xUnit.net 00:00:04.72]         --- End of stack trace from previous location ---
[07:44:39 INF] ============================================
[07:44:39 INF] Application starting at 11/06/2025 07:44:39, log file: C:\workspace\bobcrm\tests\BobCrm.Api.Tests\bin\Debug\net8.0\..\..\logs\api_20251106_074439.log
[07:44:39 INF] ============================================
[07:44:39 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:39 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:39 INF] No migrations were applied. The database is already up to date.
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Customers" AS c)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "FieldDefinitions" AS f)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationLanguages" AS l)
[EntityMetadata] Step 1: Found 1 entity types implementing IEntityMetadataProvider
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[@__metadata_EntityType_0='?'], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
WHERE e."EntityType" = @__metadata_EntityType_0
LIMIT 1
[EntityMetadata] - Already exists: Customer
[EntityMetadata] Step 2: Validating existing metadata records...
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
[EntityMetadata] ? No changes needed (all in sync)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationResources" AS l)
[xUnit.net 00:00:04.77]     BobCrm.Api.Tests.FieldActionTests.FileValidate_WithUrl_ReturnsUrlType [FAIL]
[xUnit.net 00:00:04.77]       System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
[xUnit.net 00:00:04.77]       Stack Trace:
[xUnit.net 00:00:04.77]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
[xUnit.net 00:00:04.77]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
[xUnit.net 00:00:04.77]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
[xUnit.net 00:00:04.77]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
[xUnit.net 00:00:04.77]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
[xUnit.net 00:00:04.77]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
[xUnit.net 00:00:04.77]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
[xUnit.net 00:00:04.77]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
[xUnit.net 00:00:04.77]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
[xUnit.net 00:00:04.77]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
[xUnit.net 00:00:04.77]            at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
[xUnit.net 00:00:04.77]         C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs(116,0): at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db)
[xUnit.net 00:00:04.77]         C:\workspace\bobcrm\src\BobCrm.Api\Program.cs(147,0): at Program.<Main>$(String[] args)
[xUnit.net 00:00:04.77]            at Program.<Main>(String[] args)
[xUnit.net 00:00:04.77]            at InvokeStub_Program.<Main>(Object, Span`1)
[xUnit.net 00:00:04.77]            at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
[xUnit.net 00:00:04.77]         --- End of stack trace from previous location ---
[xUnit.net 00:00:04.77]            at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
[xUnit.net 00:00:04.77]            at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
[xUnit.net 00:00:04.77]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:04.77]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs(35,0): at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:04.77]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
[xUnit.net 00:00:04.77]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
[xUnit.net 00:00:04.77]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:04.77]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:04.77]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:04.77]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:04.77]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\FieldActionTests.cs(200,0): at BobCrm.Api.Tests.FieldActionTests.FileValidate_WithUrl_ReturnsUrlType()
[xUnit.net 00:00:04.77]         --- End of stack trace from previous location ---
  螟ｱ謨・BobCrm.Api.Tests.FieldActionTests.FileValidate_WithNonExistingFile_ReturnsNotFound [55 ms]
  繧ｨ繝ｩ繝ｼ 繝｡繝・そ繝ｼ繧ｸ:
   System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
  繧ｹ繧ｿ繝・け 繝医Ξ繝ｼ繧ｹ:
     at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
   at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db) in C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs:line 116
   at Program.<Main>$(String[] args) in C:\workspace\bobcrm\src\BobCrm.Api\Program.cs:line 147
   at Program.<Main>(String[] args)
   at InvokeStub_Program.<Main>(Object, Span`1)
   at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
   at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder) in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs:line 35
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at BobCrm.Api.Tests.FieldActionTests.FileValidate_WithNonExistingFile_ReturnsNotFound() in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\FieldActionTests.cs:line 179
--- End of stack trace from previous location ---
  螟ｱ謨・BobCrm.Api.Tests.FieldActionTests.RdpDownload_WithRedirectOptions_IncludesRedirectSettings [49 ms]
  繧ｨ繝ｩ繝ｼ 繝｡繝・そ繝ｼ繧ｸ:
   System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
  繧ｹ繧ｿ繝・け 繝医Ξ繝ｼ繧ｹ:
     at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
   at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db) in C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs:line 116
   at Program.<Main>$(String[] args) in C:\workspace\bobcrm\src\BobCrm.Api\Program.cs:line 147
   at Program.<Main>(String[] args)
   at InvokeStub_Program.<Main>(Object, Span`1)
   at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
   at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder) in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs:line 35
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at BobCrm.Api.Tests.FieldActionTests.RdpDownload_WithRedirectOptions_IncludesRedirectSettings() in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\FieldActionTests.cs:line 125
--- End of stack trace from previous location ---
  螟ｱ謨・BobCrm.Api.Tests.FieldActionTests.RdpDownload_WithCustomPort_IncludesPortInAddress [59 ms]
  繧ｨ繝ｩ繝ｼ 繝｡繝・そ繝ｼ繧ｸ:
   System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
  繧ｹ繧ｿ繝・け 繝医Ξ繝ｼ繧ｹ:
     at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
   at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db) in C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs:line 116
   at Program.<Main>$(String[] args) in C:\workspace\bobcrm\src\BobCrm.Api\Program.cs:line 147
   at Program.<Main>(String[] args)
   at InvokeStub_Program.<Main>(Object, Span`1)
   at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
   at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder) in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs:line 35
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at BobCrm.Api.Tests.FieldActionTests.RdpDownload_WithCustomPort_IncludesPortInAddress() in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\FieldActionTests.cs:line 51
--- End of stack trace from previous location ---
  螟ｱ謨・BobCrm.Api.Tests.FieldActionTests.FileValidate_WithExistingFile_ReturnsExists [56 ms]
  繧ｨ繝ｩ繝ｼ 繝｡繝・そ繝ｼ繧ｸ:
   System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
  繧ｹ繧ｿ繝・け 繝医Ξ繝ｼ繧ｹ:
     at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
   at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db) in C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs:line 116
   at Program.<Main>$(String[] args) in C:\workspace\bobcrm\src\BobCrm.Api\Program.cs:line 147
   at Program.<Main>(String[] args)
   at InvokeStub_Program.<Main>(Object, Span`1)
   at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
   at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder) in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs:line 35
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at BobCrm.Api.Tests.FieldActionTests.FileValidate_WithExistingFile_ReturnsExists() in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\FieldActionTests.cs:line 153
--- End of stack trace from previous location ---
  螟ｱ謨・BobCrm.Api.Tests.FieldActionTests.FileValidate_WithUrl_ReturnsUrlType [50 ms]
  繧ｨ繝ｩ繝ｼ 繝｡繝・そ繝ｼ繧ｸ:
   System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
  繧ｹ繧ｿ繝・け 繝医Ξ繝ｼ繧ｹ:
     at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
   at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db) in C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs:line 116
   at Program.<Main>$(String[] args) in C:\workspace\bobcrm\src\BobCrm.Api\Program.cs:line 147
   at Program.<Main>(String[] args)
   at InvokeStub_Program.<Main>(Object, Span`1)
   at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
   at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder) in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs:line 35
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at BobCrm.Api.Tests.FieldActionTests.FileValidate_WithUrl_ReturnsUrlType() in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\FieldActionTests.cs:line 200
--- End of stack trace from previous location ---
  謌仙粥 BobCrm.Api.Tests.ValidatorsTests.BusinessValidator_Errors_When_NoFields_Or_EmptyKey [3 ms]
  謌仙粥 BobCrm.Api.Tests.ValidatorsTests.CommonValidator_Required_And_Regex [4 ms]
  謌仙粥 BobCrm.Api.Tests.ValidatorsTests.ValidationPipeline_Stops_On_First_Failure [4 ms]
  謌仙粥 BobCrm.Api.Tests.ValidatorsTests.PersistenceValidator_UnknownField [< 1 ms]
[07:44:39 INF] ============================================
[07:44:39 INF] Application starting at 11/06/2025 07:44:39, log file: C:\workspace\bobcrm\tests\BobCrm.Api.Tests\bin\Debug\net8.0\..\..\logs\api_20251106_074439.log
[07:44:39 INF] ============================================
[07:44:39 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:39 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:39 INF] No migrations were applied. The database is already up to date.
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Customers" AS c)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "FieldDefinitions" AS f)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationLanguages" AS l)
[EntityMetadata] Step 1: Found 1 entity types implementing IEntityMetadataProvider
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[@__metadata_EntityType_0='?'], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
WHERE e."EntityType" = @__metadata_EntityType_0
LIMIT 1
[EntityMetadata] - Already exists: Customer
[EntityMetadata] Step 2: Validating existing metadata records...
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
[EntityMetadata] ? No changes needed (all in sync)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationResources" AS l)
[xUnit.net 00:00:04.83]     BobCrm.Api.Tests.CustomersTests.List_And_Detail_Returns_Data [FAIL]
[xUnit.net 00:00:04.83]       System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
[xUnit.net 00:00:04.83]       Stack Trace:
[xUnit.net 00:00:04.83]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
[xUnit.net 00:00:04.83]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
[xUnit.net 00:00:04.83]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
[xUnit.net 00:00:04.83]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
[xUnit.net 00:00:04.83]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
[xUnit.net 00:00:04.83]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
[xUnit.net 00:00:04.83]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
[xUnit.net 00:00:04.83]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
[xUnit.net 00:00:04.83]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
[xUnit.net 00:00:04.83]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
[xUnit.net 00:00:04.83]            at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
[xUnit.net 00:00:04.83]         C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs(116,0): at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db)
[xUnit.net 00:00:04.83]         C:\workspace\bobcrm\src\BobCrm.Api\Program.cs(147,0): at Program.<Main>$(String[] args)
[xUnit.net 00:00:04.83]            at Program.<Main>(String[] args)
[xUnit.net 00:00:04.83]            at InvokeStub_Program.<Main>(Object, Span`1)
[xUnit.net 00:00:04.83]            at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
[xUnit.net 00:00:04.83]         --- End of stack trace from previous location ---
[xUnit.net 00:00:04.83]            at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
[xUnit.net 00:00:04.83]            at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
[xUnit.net 00:00:04.83]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:04.83]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs(35,0): at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:04.83]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
[xUnit.net 00:00:04.83]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
[xUnit.net 00:00:04.83]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:04.83]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:04.83]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:04.83]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:04.83]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\CustomersTests.cs(15,0): at BobCrm.Api.Tests.CustomersTests.List_And_Detail_Returns_Data()
[xUnit.net 00:00:04.83]         --- End of stack trace from previous location ---
[07:44:39 INF] ============================================
[07:44:39 INF] Application starting at 11/06/2025 07:44:39, log file: C:\workspace\bobcrm\tests\BobCrm.Api.Tests\bin\Debug\net8.0\..\..\logs\api_20251106_074439.log
[07:44:39 INF] ============================================
[07:44:39 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:39 INF] No migrations were applied. The database is already up to date.
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Customers" AS c)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "FieldDefinitions" AS f)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationLanguages" AS l)
[EntityMetadata] Step 1: Found 1 entity types implementing IEntityMetadataProvider
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[@__metadata_EntityType_0='?'], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
WHERE e."EntityType" = @__metadata_EntityType_0
LIMIT 1
[EntityMetadata] - Already exists: Customer
[EntityMetadata] Step 2: Validating existing metadata records...
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
[EntityMetadata] ? No changes needed (all in sync)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationResources" AS l)
[xUnit.net 00:00:04.89]     BobCrm.Api.Tests.CustomersTests.Update_Validation_And_Concurrency [FAIL]
[xUnit.net 00:00:04.89]       System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
[xUnit.net 00:00:04.89]       Stack Trace:
[xUnit.net 00:00:04.89]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
[xUnit.net 00:00:04.89]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
[xUnit.net 00:00:04.89]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
[xUnit.net 00:00:04.89]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
[xUnit.net 00:00:04.89]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
[xUnit.net 00:00:04.89]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
[xUnit.net 00:00:04.89]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
[xUnit.net 00:00:04.89]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
[xUnit.net 00:00:04.89]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
[xUnit.net 00:00:04.89]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
[xUnit.net 00:00:04.89]            at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
[xUnit.net 00:00:04.89]         C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs(116,0): at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db)
[xUnit.net 00:00:04.89]         C:\workspace\bobcrm\src\BobCrm.Api\Program.cs(147,0): at Program.<Main>$(String[] args)
[xUnit.net 00:00:04.89]            at Program.<Main>(String[] args)
[xUnit.net 00:00:04.89]            at InvokeStub_Program.<Main>(Object, Span`1)
[xUnit.net 00:00:04.89]            at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
[xUnit.net 00:00:04.89]         --- End of stack trace from previous location ---
[xUnit.net 00:00:04.89]            at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
[xUnit.net 00:00:04.89]            at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
[xUnit.net 00:00:04.89]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:04.89]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs(35,0): at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:04.89]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
[xUnit.net 00:00:04.89]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
[xUnit.net 00:00:04.89]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:04.89]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:04.89]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:04.89]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:04.89]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\CustomersTests.cs(35,0): at BobCrm.Api.Tests.CustomersTests.Update_Validation_And_Concurrency()
[xUnit.net 00:00:04.89]         --- End of stack trace from previous location ---
[07:44:39 INF] ============================================
[07:44:39 INF] Application starting at 11/06/2025 07:44:39, log file: C:\workspace\bobcrm\tests\BobCrm.Api.Tests\bin\Debug\net8.0\..\..\logs\api_20251106_074439.log
[07:44:39 INF] ============================================
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:39 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:39 INF] No migrations were applied. The database is already up to date.
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Customers" AS c)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "FieldDefinitions" AS f)
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationLanguages" AS l)
[EntityMetadata] Step 1: Found 1 entity types implementing IEntityMetadataProvider
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[@__metadata_EntityType_0='?'], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
WHERE e."EntityType" = @__metadata_EntityType_0
LIMIT 1
[EntityMetadata] - Already exists: Customer
[EntityMetadata] Step 2: Validating existing metadata records...
[07:44:39 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
[EntityMetadata] ? No changes needed (all in sync)
[07:44:39 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationResources" AS l)
[xUnit.net 00:00:04.95]     BobCrm.Api.Tests.FieldsAndI18nTests.I18n_Ok [FAIL]
[xUnit.net 00:00:04.95]       System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
[xUnit.net 00:00:04.95]       Stack Trace:
[xUnit.net 00:00:04.95]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
[xUnit.net 00:00:04.95]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
[xUnit.net 00:00:04.95]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
[xUnit.net 00:00:04.95]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
[xUnit.net 00:00:04.95]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
[xUnit.net 00:00:04.95]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
[xUnit.net 00:00:04.95]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
[xUnit.net 00:00:04.95]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
[xUnit.net 00:00:04.95]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
[xUnit.net 00:00:04.95]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
[xUnit.net 00:00:04.95]            at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
[xUnit.net 00:00:04.95]         C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs(116,0): at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db)
[xUnit.net 00:00:04.95]         C:\workspace\bobcrm\src\BobCrm.Api\Program.cs(147,0): at Program.<Main>$(String[] args)
[xUnit.net 00:00:04.95]            at Program.<Main>(String[] args)
[xUnit.net 00:00:04.95]            at InvokeStub_Program.<Main>(Object, Span`1)
[xUnit.net 00:00:04.95]            at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
[xUnit.net 00:00:04.95]         --- End of stack trace from previous location ---
[xUnit.net 00:00:04.95]            at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
[xUnit.net 00:00:04.95]            at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
[xUnit.net 00:00:04.95]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:04.95]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs(35,0): at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:04.95]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
[xUnit.net 00:00:04.95]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
[xUnit.net 00:00:04.95]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:04.95]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:04.95]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:04.95]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:04.95]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\FieldsAndI18nTests.cs(46,0): at BobCrm.Api.Tests.FieldsAndI18nTests.I18n_Ok()
[xUnit.net 00:00:04.95]         --- End of stack trace from previous location ---
[07:44:40 INF] ============================================
[07:44:40 INF] Application starting at 11/06/2025 07:44:40, log file: C:\workspace\bobcrm\tests\BobCrm.Api.Tests\bin\Debug\net8.0\..\..\logs\api_20251106_074439.log
[07:44:40 INF] ============================================
[07:44:40 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:40 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:40 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:40 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
[07:44:40 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM public."__EFMigrationsHistory"
ORDER BY "MigrationId";
[07:44:40 INF] No migrations were applied. The database is already up to date.
[07:44:40 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Customers" AS c)
[07:44:40 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "FieldDefinitions" AS f)
[07:44:40 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationLanguages" AS l)
[EntityMetadata] Step 1: Found 1 entity types implementing IEntityMetadataProvider
[07:44:40 INF] Executed DbCommand (1ms) [Parameters=[@__metadata_EntityType_0='?'], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
WHERE e."EntityType" = @__metadata_EntityType_0
LIMIT 1
[EntityMetadata] - Already exists: Customer
[EntityMetadata] Step 2: Validating existing metadata records...
[07:44:40 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT e."EntityType", e."ApiEndpoint", e."Category", e."CreatedAt", e."DescriptionKey", e."DisplayNameKey", e."EntityName", e."EntityRoute", e."Icon", e."IsEnabled", e."IsRootEntity", e."Order", e."UpdatedAt"
FROM "EntityMetadata" AS e
[EntityMetadata] ? No changes needed (all in sync)
[07:44:40 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "LocalizationResources" AS l)
[xUnit.net 00:00:05.00]     BobCrm.Api.Tests.FieldsAndI18nTests.Fields_And_Tags_Ok [FAIL]
[xUnit.net 00:00:05.00]       System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
[xUnit.net 00:00:05.00]       Stack Trace:
[xUnit.net 00:00:05.00]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
[xUnit.net 00:00:05.00]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
[xUnit.net 00:00:05.00]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
[xUnit.net 00:00:05.00]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
[xUnit.net 00:00:05.00]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
[xUnit.net 00:00:05.00]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
[xUnit.net 00:00:05.00]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
[xUnit.net 00:00:05.00]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
[xUnit.net 00:00:05.00]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
[xUnit.net 00:00:05.00]            at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
[xUnit.net 00:00:05.00]            at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
[xUnit.net 00:00:05.00]         C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs(116,0): at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db)
[xUnit.net 00:00:05.00]         C:\workspace\bobcrm\src\BobCrm.Api\Program.cs(147,0): at Program.<Main>$(String[] args)
[xUnit.net 00:00:05.00]            at Program.<Main>(String[] args)
[xUnit.net 00:00:05.00]            at InvokeStub_Program.<Main>(Object, Span`1)
[xUnit.net 00:00:05.00]            at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
[xUnit.net 00:00:05.00]         --- End of stack trace from previous location ---
[xUnit.net 00:00:05.00]            at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
[xUnit.net 00:00:05.00]            at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
[xUnit.net 00:00:05.00]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:05.00]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs(35,0): at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder)
[xUnit.net 00:00:05.00]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
[xUnit.net 00:00:05.00]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
[xUnit.net 00:00:05.00]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
[xUnit.net 00:00:05.00]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
[xUnit.net 00:00:05.00]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
[xUnit.net 00:00:05.00]            at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
[xUnit.net 00:00:05.00]         C:\workspace\bobcrm\tests\BobCrm.Api.Tests\FieldsAndI18nTests.cs(14,0): at BobCrm.Api.Tests.FieldsAndI18nTests.Fields_And_Tags_Ok()
[xUnit.net 00:00:05.00]         --- End of stack trace from previous location ---
[xUnit.net 00:00:05.00]   Finished:    BobCrm.Api.Tests
  螟ｱ謨・BobCrm.Api.Tests.CustomersTests.List_And_Detail_Returns_Data [52 ms]
  繧ｨ繝ｩ繝ｼ 繝｡繝・そ繝ｼ繧ｸ:
   System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
  繧ｹ繧ｿ繝・け 繝医Ξ繝ｼ繧ｹ:
     at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
   at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db) in C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs:line 116
   at Program.<Main>$(String[] args) in C:\workspace\bobcrm\src\BobCrm.Api\Program.cs:line 147
   at Program.<Main>(String[] args)
   at InvokeStub_Program.<Main>(Object, Span`1)
   at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
   at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder) in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs:line 35
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at BobCrm.Api.Tests.CustomersTests.List_And_Detail_Returns_Data() in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\CustomersTests.cs:line 15
--- End of stack trace from previous location ---
  螟ｱ謨・BobCrm.Api.Tests.CustomersTests.Update_Validation_And_Concurrency [55 ms]
  繧ｨ繝ｩ繝ｼ 繝｡繝・そ繝ｼ繧ｸ:
   System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
  繧ｹ繧ｿ繝・け 繝医Ξ繝ｼ繧ｹ:
     at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
   at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db) in C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs:line 116
   at Program.<Main>$(String[] args) in C:\workspace\bobcrm\src\BobCrm.Api\Program.cs:line 147
   at Program.<Main>(String[] args)
   at InvokeStub_Program.<Main>(Object, Span`1)
   at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
   at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder) in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs:line 35
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at BobCrm.Api.Tests.CustomersTests.Update_Validation_And_Concurrency() in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\CustomersTests.cs:line 35
--- End of stack trace from previous location ---
  螟ｱ謨・BobCrm.Api.Tests.FieldsAndI18nTests.I18n_Ok [58 ms]
  繧ｨ繝ｩ繝ｼ 繝｡繝・そ繝ｼ繧ｸ:
   System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
  繧ｹ繧ｿ繝・け 繝医Ξ繝ｼ繧ｹ:
     at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
   at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db) in C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs:line 116
   at Program.<Main>$(String[] args) in C:\workspace\bobcrm\src\BobCrm.Api\Program.cs:line 147
   at Program.<Main>(String[] args)
   at InvokeStub_Program.<Main>(Object, Span`1)
   at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
   at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder) in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs:line 35
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at BobCrm.Api.Tests.FieldsAndI18nTests.I18n_Ok() in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\FieldsAndI18nTests.cs:line 46
--- End of stack trace from previous location ---
  螟ｱ謨・BobCrm.Api.Tests.FieldsAndI18nTests.Fields_And_Tags_Ok [52 ms]
  繧ｨ繝ｩ繝ｼ 繝｡繝・そ繝ｼ繧ｸ:
   System.InvalidOperationException : The instance of entity type 'LocalizationResource' cannot be tracked because another instance with the same key value for {'Key'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
  繧ｹ繧ｿ繝・け 繝医Ξ繝ｼ繧ｹ:
     at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityStateAsync(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintActionAsync(EntityEntryGraphNode`1 node, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraphAsync[TState](EntityEntryGraphNode`1 node, Func`3 handleNode, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraphAsync(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.AddRangeAsync(TEntity[] entities)
   at BobCrm.Api.Infrastructure.DatabaseInitializer.InitializeAsync(DbContext db) in C:\workspace\bobcrm\src\BobCrm.Api\Infrastructure\DatabaseInitializer.cs:line 116
   at Program.<Main>$(String[] args) in C:\workspace\bobcrm\src\BobCrm.Api\Program.cs:line 147
   at Program.<Main>(String[] args)
   at InvokeStub_Program.<Main>(Object, Span`1)
   at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Testing.DeferredHostBuilder.DeferredHost.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Start(IHost host)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateHost(IHostBuilder builder)
   at BobCrm.Api.Tests.TestWebAppFactory.CreateHost(IHostBuilder builder) in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\TestWebAppFactory.cs:line 35
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.ConfigureHostBuilder(IHostBuilder hostBuilder)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(Uri baseAddress, DelegatingHandler[] handlers)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)
   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient()
   at BobCrm.Api.Tests.FieldsAndI18nTests.Fields_And_Tags_Ok() in C:\workspace\bobcrm\tests\BobCrm.Api.Tests\FieldsAndI18nTests.cs:line 14
--- End of stack trace from previous location ---

繝・せ繝医・螳溯｡後↓螟ｱ謨励＠縺ｾ縺励◆縲・
繝・せ繝医・蜷郁ｨ域焚: 67
     謌仙粥: 7
     螟ｱ謨・ 57
    繧ｹ繧ｭ繝・・: 3
蜷郁ｨ域凾髢・ 5.5315 遘・

繝ｯ繝ｼ繧ｯ繝ｭ繝ｼ繝峨・譖ｴ譁ｰ縺悟茜逕ｨ蜿ｯ閭ｽ縺ｧ縺吶りｩｳ邏ｰ縺ｫ縺､縺・※縺ｯ縲～dotnet workload list` 繧貞ｮ溯｡後＠縺ｦ縺上□縺輔＞縲・
