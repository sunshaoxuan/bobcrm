# 更新国际化资源

## 问题
新建实体画面显示很多国际化键（如 `LBL_CREATE_ENTITY_DEF`、`LBL_NAMESPACE` 等）而不是实际的文本。

## 原因
我们添加了152个新的国际化键到 `DatabaseInitializer.cs`，但这些键只在数据库首次初始化时插入。对于已经存在的数据库，需要手动添加这些资源。

## 解决方案

### 方案1：删除并重建数据库（推荐用于开发环境）

这是最简单的方法，适用于开发环境：

```bash
# 进入API目录
cd src/BobCrm.Api

# 删除现有的数据库文件（如果使用SQLite）
rm -f bobcrm.db

# 重新运行应用，数据库会自动重建并包含所有国际化资源
dotnet run
```

### 方案2：执行SQL脚本

如果不想删除数据库，可以执行提供的SQL脚本：

#### 选项A：使用安全脚本（检查重复）
```bash
# 使用你的数据库工具执行
add-missing-i18n-resources-safe.sql
```

#### 选项B：使用简单脚本（如果确定键不存在）
```bash
# 使用你的数据库工具执行
add-missing-i18n-resources.sql
```

### 方案3：通过API端点添加（需要实现）

可以创建一个临时的管理端点来批量插入这些资源：

```bash
# 调用API端点（如果实现了的话）
curl -X POST http://localhost:5200/api/admin/sync-i18n-resources
```

## 添加的国际化键列表

总共添加了 **152个新键**，分为以下类别：

### EntityDefinitionEdit.razor（43个键）
- 实体定义的创建和编辑
- 字段定义管理
- 接口选择
- 数据类型、长度、精度等配置
- 成功/失败消息提示

### MasterDetailConfig.razor（56个键）
- 主子表配置
- 子实体管理
- 外键字段配置
- 级联删除行为设置
- 实体结构预览

### EntityDefinitionPublish.razor（42个键）
- 实体发布流程
- 代码生成
- 编译功能
- DDL脚本预览
- 编译状态和错误信息

### DynamicEntityData.razor（11个键）
- 动态实体数据管理
- 数据列表显示
- CRUD操作相关提示

## 验证

更新后，访问实体编辑页面，应该看到：
- ✅ "新建实体定义" 而不是 `LBL_CREATE_ENTITY_DEF`
- ✅ "命名空间" 而不是 `LBL_NAMESPACE`
- ✅ "实体名称" 而不是 `LBL_ENTITY_NAME`
- ✅ 所有其他文本都正确显示

## 注意事项

1. **备份数据库**：在执行SQL脚本前，建议备份数据库
2. **检查数据库类型**：提供的SQL脚本是针对SQL Server的，如果使用SQLite或其他数据库，可能需要调整语法
3. **刷新浏览器缓存**：更新后记得清除浏览器缓存并刷新页面

## 后续优化建议

为了避免将来出现类似问题，建议：

1. **创建数据库迁移**：使用EF Core迁移来管理国际化资源的变更
2. **实现资源同步端点**：创建一个管理端点，可以从代码同步所有国际化资源到数据库
3. **添加资源版本检查**：在应用启动时检查资源版本，自动添加缺失的键
