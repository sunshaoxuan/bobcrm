@using BobCrm.App.Models.Widgets

@* Section 容器的设计态渲染器 *@
<div style="border:@(Section.ContainerLayout.BorderWidth)px @(Section.ContainerLayout.BorderStyle) @(Section.ContainerLayout.BorderColor); border-radius:@(Section.ContainerLayout.BorderRadius)px; background:@(Section.ContainerLayout.BackgroundColor); min-height:150px; display:flex; flex-direction:column;">
    @if (Section.ShowTitle)
    {
        <div style="padding:8px 12px; border-bottom:1px solid #d9d9d9; font-weight:600; font-size:13px; display:flex; justify-content:space-between; align-items:center; flex-shrink:0;">
            <span>@(string.IsNullOrWhiteSpace(Section.Title) ? "分组标题" : Section.Title)</span>
            @if (Section.Collapsible)
            {
                <span style="font-size:10px; color:#999">[可折叠]</span>
            }
        </div>
    }
    <div style="flex:1; padding:@(Section.ContainerLayout.Padding)px; display:flex; flex-direction:@(Section.ContainerLayout.FlexDirection); flex-wrap:@(Section.ContainerLayout.FlexWrap ? "wrap" : "nowrap"); gap:@(Section.ContainerLayout.Gap)px;"
         @ondrop="@OnDrop" @ondrop:preventDefault @ondrop:stopPropagation
         @ondragover="@OnDragOver" @ondragover:preventDefault>
        @if (Section.Children?.Any() == true)
        {
            @foreach (var child in Section.Children)
            {
                @RenderChild(child)
            }
        }
        else
        {
            <div style="flex:1; display:flex; align-items:center; justify-content:center; color:#999; font-size:12px; pointer-events:none">
                拖入组件到分组
            </div>
        }
    </div>
</div>

@code {
    [Parameter, EditorRequired]
    public SectionWidget Section { get; set; } = null!;

    [Parameter, EditorRequired]
    public RenderFragment<DraggableWidget> RenderChild { get; set; } = null!;

    [Parameter, EditorRequired]
    public EventCallback<Microsoft.AspNetCore.Components.Web.DragEventArgs> OnDrop { get; set; }

    [Parameter, EditorRequired]
    public EventCallback<Microsoft.AspNetCore.Components.Web.DragEventArgs> OnDragOver { get; set; }
}

