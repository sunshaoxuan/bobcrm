@page "/users"
@rendermode RenderMode.InteractiveServer

@inject BobCrm.App.Services.I18nService I18n
@inject NavigationManager Nav

<AuthChecker>
    <div class="collection-shell">
        <CollectionHeader Title="@I18n.T("MENU_USERS")"
                          Subtitle="@I18n.T("TXT_USER_SUMMARY")"
                          Eyebrow="@I18n.T("LBL_COLLECTION")">
            <Actions>
                <Button Type="@ButtonType.Default" Icon="@IconType.Outline.Filter">@I18n.T("BTN_SAVE_VIEW")</Button>
                <Button Type="@ButtonType.Default" Icon="@IconType.Outline.Download">@I18n.T("BTN_EXPORT")</Button>
                <Button Type="@ButtonType.Primary" Icon="@IconType.Outline.Plus" OnClick="CreateUser">@I18n.T("BTN_NEW_USER")</Button>
            </Actions>
        </CollectionHeader>

        <div class="collection-content" style="padding: 24px;">
            <ListTemplateHost EntityType="user" />
        </div>
    </div>
</AuthChecker>

@code {
    protected override void OnInitialized()
    {
        I18n.OnChanged += HandleI18nChanged;
    }

    private void CreateUser()
    {
        Nav.NavigateTo("/user/new");
    }

    private void HandleI18nChanged() => InvokeAsync(StateHasChanged);
}
