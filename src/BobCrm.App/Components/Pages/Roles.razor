@page "/roles"
@rendermode RenderMode.InteractiveServer

@inject BobCrm.App.Services.I18nService I18n
@inject NavigationManager Nav

<AuthChecker>
    <div class="collection-shell">
        <CollectionHeader Title="@I18n.T("MENU_ROLES")"
                          Subtitle="@I18n.T("TXT_ROLE_SUMMARY")"
                          Eyebrow="@I18n.T("LBL_COLLECTION")">
            <Actions>
                <Button Type="@ButtonType.Default" Icon="@IconType.Outline.Filter">@I18n.T("BTN_SAVE_VIEW")</Button>
                <Button Type="@ButtonType.Default" Icon="@IconType.Outline.Download">@I18n.T("BTN_EXPORT")</Button>
                <Button Type="@ButtonType.Primary" Icon="@IconType.Outline.Plus" OnClick="CreateRole">@I18n.T("BTN_NEW_ROLE")</Button>
            </Actions>
        </CollectionHeader>

        <div class="collection-content" style="padding: 24px;">
            <ListTemplateHost EntityType="role" />
        </div>
    </div>
</AuthChecker>

@code {
    protected override void OnInitialized()
    {
        I18n.OnChanged += HandleI18nChanged;
    }

    private void CreateRole()
    {
        Nav.NavigateTo("/role/new");
    }

    private void HandleI18nChanged() => InvokeAsync(StateHasChanged);
}
