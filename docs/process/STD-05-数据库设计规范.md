# STD-05: 数据库设计规范

> **版本**: 1.0
> **适用范围**: 数据模型设计

---

## 1. 通用规范

- ✅ **迁移策略**: 考虑数据迁移和升级路径，生产环境禁止直接修改 Schema 导致数据丢失。
- ✅ **种子数据**: 必须提供基础数据的种子脚本（如字典表、初始管理员）。
- ✅ **设计元即真理**: 设计文档（Design Source）是真理，数据库是实现的投影。严禁跳过文档直接修改数据库。

## 2. 实体设计规范

### 2.1 主键
- 推荐使用 **UUID** 或 **雪花算法 ID** 以支持分布式环境。
- 如使用自增主键 (`int`/`long`)，需注意并在设计文档中说明。

### 2.2 审计字段
每个业务表**必须**包含以下审计字段：
- `CreatedAt` (创建时间)
- `CreatedBy` (创建人)
- `UpdatedAt` (更新时间)
- `UpdatedBy` (更新人)

### 2.3 软删除
- 推荐使用软删除机制 (逻辑删除)。
- 字段名通常为 `IsDeleted` (Boolean) 或 `DeletedAt` (Timestamp)。
- 查询时必须过滤掉已软删除的数据。

## 3. 索引设计规范

- ✅ **外键索引**: 所有作为外键的字段必须建立索引（防止死锁和提升联表性能）。
- ✅ **唯一索引**: 业务上的唯一约束必须通过数据库唯一索引保证。
- ✅ **查询优化**: 针对高频查询条件字段建立索引。
- ✅ **适度原则**: 避免建立过多的索引影响写入性能。

## 4. 命名规范

- **表名**: 使用复数名词 (如 `Users`, `Orders`) 或 PascalCase (视项目具体约定，保持统一)。
- **字段名**: PascalCase 或 snake_case (视项目技术栈约定)。
- **约束名**: 清晰表达约束含义 (如 `PK_Users`, `FK_Orders_Users_UserId`).

## 5. 动态扩展设计

对于需动态扩展的实体：
- 推荐使用 JSON 字段存储非结构化/动态属性。
- 或使用 EAV (Entity-Attribute-Value) 模型（视复杂度而定）。
- **禁止** 随意增加 `Field1`, `Field2` 等无意义预留字段。
