# 阶段 2 布局与交互验证记录

> 覆盖 Calm App Shell、全局状态条（Bulk Bar / Sticky Bar / Toast）、Light/Dark 主题与 sm/md/lg 断点的自测流程。所有截图/录屏存放于团队共享盘，以下记录落地步骤与关键观察点，供回归复用。

## 1. 组件与入口说明

- **LayoutState**：控制侧栏折叠（桌面）、移动遮罩（≤1024px）与右侧工作栏显隐（`src/BobCrm.App/Services/LayoutState.cs`）。
- **InteractionState**：负责批量操作条、粘性工具条与 Toast 队列（`src/BobCrm.App/Services/InteractionState.cs`）。  
  - Header Demo 按钮：`工作栏` → 切换右栏；`工具条` → 显示 Sticky Bar；`批量条` → 显示 Bulk Bar；`通知` → 追加 Toast。
- **GlobalOverlayHost**：集中渲染 Bulk Bar + Toast（`src/BobCrm.App/Components/Shared/GlobalOverlayHost.razor`），被 `MainLayout` 注入。
- **Theme Playground**：`/theme-playground` 页面展示按钮、输入、卡片、表格、时间线等组件在 light/dark 下的视觉基准。

## 2. 响应式与层级验证

| 断点 | 校验动作 | 预期 |
| --- | --- | --- |
| **Desktop ≥ 1200px** | 1) 点击 “工具条/批量条/通知” 按钮；2) 收起/展开侧栏；3) 打开右栏 | Sticky Bar 附着内容区顶部；Bulk Bar 悬浮底部；Toast 叠在右上；侧栏宽度 260px↔72px 过渡；右栏（320px）玻璃浮层。 |
| **Tablet ≈ 900px** | 模拟宽度 900px，点击移动菜单按钮打开侧栏 | 侧栏以抽屉形式滑入，遮罩覆盖主区域；Bulk/Toast 位置不变；右栏自动隐藏。 |
| **Mobile ≈ 600px** | 1) 打开侧栏并选中客户；2) 触发 Sticky/Bulk | 选择客户后遮罩关闭；Sticky Bar 占据内容区顶部；Bulk Bar 自适应整宽；Toast 仍固定右上但不遮挡主题按钮。 |

## 3. 主题与动效验证

- **Light/Dark**：在 `/theme-playground` 中切换 Calm Light/Dark，确认：背景/玻璃层/阴影/语义色按照设计说明书 3.5 映射；按钮、输入、表格 hover/active/focus 有平滑动效（120–240ms）。
- **层级顺序**：在 Layout 页面同时打开 Sticky → Bulk → Drawer（移动侧栏） → Toast，确认视觉层级为 base < sticky < bulk < overlay < toast，且焦点不被遮罩截断。

## 4. 回归步骤（每次合并前执行）

1. `dotnet build src/BobCrm.App/BobCrm.App.csproj` 确认编译通过。
2. `dotnet run` 或 `scripts/dev.ps1 -Action start` 启动前端，访问：
   - `/theme-playground`：拍摄 light/dark × desktop/tablet/mobile 三套截图。
   - `/customers`：使用 Header 按钮触发 Sticky/Bulk/Toast，录制短动效。
3. 将截图与备注归档到共享盘 `UIUE/Stage2/yyyymmdd` 下，填写上述表格（断点、观察结果、备注）。

> 一旦新增布局或交互层级，需同步更新本文件的校验步骤及 README 计划。
