# TC-FORM-002 表单设计器

| 项目 | 内容 |
|------|------|
| **用例编号** | TC-FORM-002 |
| **用例名称** | 表单设计器 |
| **所属领域** | 表单设计 |
| **测试类型** | 功能测试 |
| **优先级** | P0 - 关键路径 |
| **版本** | 1.0 |

---

## 1. 测试场景描述

### 1.1 业务背景
表单设计器提供可视化拖拽界面，用于设计数据录入表单的布局和控件。

### 1.2 涉及页面
- `/designer/new` - 新建表单设计
- `/designer/{TemplateId}` - 编辑已有模板

---

## 2. 前置条件

| 条件编号 | 条件描述 |
|----------|----------|
| PRE-001 | 以管理员身份登录 |
| PRE-002 | 已创建模板（TC-FORM-001） |

---

## 3. 测试步骤

### 场景 A: 进入表单设计器

| 步骤 | 操作描述 | 预期结果 | 截图 |
|------|----------|----------|------|
| A1 | 在模板列表中点击"设计"按钮 | 进入表单设计器界面 | ✓ |
| A2 | 确认显示设计器布局 | 显示左侧控件面板、中间画布、右侧属性面板 | ✓ |

### 场景 B: 添加控件

| 步骤 | 操作描述 | 预期结果 | 截图 |
|------|----------|----------|------|
| B1 | 从控件面板拖拽"文本框"到画布 | 控件放置到画布 | ✓ |
| B2 | 从控件面板拖拽"下拉选择"到画布 | 控件放置成功 | - |
| B3 | 添加"数字输入"控件 | 控件放置成功 | - |
| B4 | 添加"日期选择"控件 | 控件放置成功 | ✓ |

### 场景 C: 配置控件属性

| 步骤 | 操作描述 | 预期结果 | 截图 |
|------|----------|----------|------|
| C1 | 选中画布上的文本框控件 | 右侧显示属性面板 | - |
| C2 | 设置标签为"产品名称" | 属性更新成功 | - |
| C3 | 设置字段绑定 | 绑定成功 | ✓ |
| C4 | 设置验证规则（必填） | 规则配置成功 | - |

### 场景 D: 调整布局

| 步骤 | 操作描述 | 预期结果 | 截图 |
|------|----------|----------|------|
| D1 | 拖拽控件调整位置 | 控件位置变更 | - |
| D2 | 调整控件宽度 | 宽度变更 | ✓ |
| D3 | 添加布局容器（如面板、标签页） | 容器添加成功 | ✓ |

### 场景 E: 预览表单

| 步骤 | 操作描述 | 预期结果 | 截图 |
|------|----------|----------|------|
| E1 | 点击"预览"按钮 | 显示表单预览 | ✓ |
| E2 | 确认控件可交互 | 可以输入数据 | - |
| E3 | 关闭预览 | 返回设计器 | - |

### 场景 F: 保存表单设计

| 步骤 | 操作描述 | 预期结果 | 截图 |
|------|----------|----------|------|
| F1 | 点击保存按钮 | 显示保存成功消息 | ✓ |
| F2 | 刷新页面 | 设计内容保持不变 | - |

---

## 4. 预期结果汇总

| 结果编号 | 场景 | 预期结果 |
|----------|------|----------|
| EXP-001 | 进入设计器 | 正确显示设计器界面 |
| EXP-002 | 添加控件 | 控件拖拽放置成功 |
| EXP-003 | 配置属性 | 属性更新生效 |
| EXP-004 | 调整布局 | 布局变更保存 |
| EXP-005 | 预览表单 | 预览正确显示 |
| EXP-006 | 保存设计 | 设计持久化成功 |

---

## 5. AI 自动化测试注释

```yaml
test_type: e2e
requires_auth: admin
depends_on: TC-FORM-001
drag_drop: true

# 设计器测试修改现有模板，统一在 TC-FORM-001 清理
cleanup:
  strategy: deferred
  defer_to: TC-FORM-001
  reason: 模板修改将在模板管理测试中统一清理
  
# 如果需要恢复模板到初始状态
standalone_cleanup:
  steps:
    - api: POST /api/templates/{templateId}/reset
      description: 重置模板到初始状态
  on_error: ignore
```
