# TC-SYS-004 文件管理

| 项目 | 内容 |
|------|------|
| **用例编号** | TC-SYS-004 |
| **用例名称** | 文件管理 |
| **所属领域** | 系统配置 |
| **测试类型** | 功能测试 |
| **优先级** | P2 - 一般功能 |
| **版本** | 1.0 |

---

## 1. 测试场景描述

### 1.1 业务背景
系统提供文件上传功能，支持将文件存储到对象存储服务（MinIO/S3），并在系统中引用。

### 1.2 涉及页面
- `/files` - 文件上传与管理页面

---

## 2. 前置条件

| 条件编号 | 条件描述 |
|----------|----------|
| PRE-001 | 用户已登录 |
| PRE-002 | 对象存储服务已配置并可用 |

---

## 3. 测试步骤

### 场景 A: 上传文件

| 步骤 | 操作描述 | 预期结果 | 截图 |
|------|----------|----------|------|
| A1 | 导航到 `/files` | 显示文件上传界面 | ✓ |
| A2 | 点击文件选择框 | 弹出系统文件选择对话框 | - |
| A3 | 选择一个测试文件（如图片或文档） | 文件被选中，"上传"按钮激活 | - |
| A4 | 点击"上传"按钮 | 显示上传进度或结果 | - |
| A5 | 等待上传完成 | 显示已上传文件的 URL 链接 | ✓ |

### 场景 B: 访问上传的文件

| 步骤 | 操作描述 | 预期结果 | 截图 |
|------|----------|----------|------|
| B1 | 点击上传后生成的 URL 链接 | 在新标签页打开文件 | - |
| B2 | 验证文件内容 | 文件内容与上传一致 | ✓ |

---

## 4. 预期结果汇总

| 结果编号 | 场景 | 预期结果 |
|----------|------|----------|
| EXP-001 | 界面状态 | 初始状态上传按钮不可用 |
| EXP-002 | 文件上传 | 上传成功返回有效 URL |
| EXP-003 | 文件访问 | 上传的文件可被公共或授权访问 |

---

## 5. AI 自动化测试注释

```yaml
test_type: e2e
requires_auth: any_user
drag_drop: true

cleanup:
  strategy: api
  steps:
    # 假设有删除文件的 API，需根据实际情况调整
    # 如果没有删除 API，此测试可能会产生孤儿文件
    - api: DELETE /api/files/{lastUploadedFileId}
      on_error: ignore
```
