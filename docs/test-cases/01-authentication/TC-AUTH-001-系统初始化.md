# TC-AUTH-001 系统初始化设置

| 项目 | 内容 |
|------|------|
| **用例编号** | TC-AUTH-001 |
| **用例名称** | 系统初始化设置 |
| **所属领域** | 认证与授权 |
| **测试类型** | 冒烟测试 / 功能测试 |
| **优先级** | P0 - 关键路径 |
| **版本** | 1.0 |

---

## 1. 测试场景描述

### 1.1 业务背景
BobCRM 系统首次部署后，需要通过初始化设置页面配置管理员账户。这是系统启用的第一步，必须在任何其他操作之前完成。

### 1.2 测试目的
验证系统初始化流程是否能够正确创建管理员账户并完成系统初始化配置。

### 1.3 涉及页面
- `/setup` - 系统初始化设置页面

---

## 2. 前置条件

| 条件编号 | 条件描述 |
|----------|----------|
| PRE-001 | 系统数据库为空（无管理员账户存在） |
| PRE-002 | 应用服务正常运行在 `http://localhost:3000` |
| PRE-003 | 浏览器已清除 localStorage 缓存 |

---

## 3. 测试数据

### 3.1 管理员账户数据

```json
{
  "adminUsername": "admin",
  "adminEmail": "admin@example.com",
  "adminPassword": "Admin@12345",
  "confirmPassword": "Admin@12345"
}
```

### 3.2 无效数据（异常场景）

```json
{
  "weakPassword": "123456",
  "mismatchPassword": "Admin@12345" / "Admin@54321",
  "invalidEmail": "invalid-email"
}
```

---

## 4. 测试步骤

### 场景 A: 正常初始化流程（Happy Path）

| 步骤 | 操作描述 | 预期结果 | 截图 |
|------|----------|----------|------|
| A1 | 访问 `http://localhost:3000/setup` | 显示系统初始化设置页面，包含管理员账户设置表单 | ✓ |
| A2 | 确认页面显示"初始化设置"或类似标题 | 页面标题正确显示 | - |
| A3 | 在用户名输入框输入 `admin` | 输入框显示输入内容 | - |
| A4 | 在邮箱输入框输入 `admin@example.com` | 输入框显示输入内容 | - |
| A5 | 在密码输入框输入 `Admin@12345` | 密码以掩码形式显示 | - |
| A6 | 在确认密码输入框输入 `Admin@12345` | 密码以掩码形式显示 | - |
| A7 | 点击"创建管理员账户"按钮 | 显示加载状态 | - |
| A8 | 等待初始化完成 | 显示成功消息，自动跳转到登录页面 | ✓ |
| A9 | 确认页面跳转到 `/login` | URL 变更为 `/login`，显示登录表单 | ✓ |

### 场景 B: 弱密码验证

| 步骤 | 操作描述 | 预期结果 | 截图 |
|------|----------|----------|------|
| B1 | 访问 `/setup` 页面 | 显示初始化设置页面 | - |
| B2 | 填写用户名和邮箱 | 字段填充成功 | - |
| B3 | 在密码字段输入 `123456` | 显示密码强度不足的提示 | ✓ |
| B4 | 尝试提交表单 | 表单提交被阻止，显示密码要求说明 | - |

### 场景 C: 密码不匹配验证

| 步骤 | 操作描述 | 预期结果 | 截图 |
|------|----------|----------|------|
| C1 | 访问 `/setup` 页面 | 显示初始化设置页面 | - |
| C2 | 填写所有字段，密码输入 `Admin@12345`，确认密码输入 `Admin@54321` | 字段填充成功 | - |
| C3 | 点击提交按钮 | 显示"密码不匹配"错误提示 | ✓ |

### 场景 D: 系统已初始化时访问 Setup

| 步骤 | 操作描述 | 预期结果 | 截图 |
|------|----------|----------|------|
| D1 | 在系统已初始化后访问 `/setup` | 自动重定向到 `/login` 页面 | ✓ |

---

## 5. 预期结果汇总

| 结果编号 | 场景 | 预期结果 |
|----------|------|----------|
| EXP-001 | 正常流程 | 管理员账户成功创建，页面跳转到登录页 |
| EXP-002 | 弱密码 | 显示密码强度要求，阻止提交 |
| EXP-003 | 密码不匹配 | 显示密码不匹配错误 |
| EXP-004 | 重复访问 | 已初始化系统重定向到登录页 |

---

## 6. 后置条件

| 条件编号 | 条件描述 |
|----------|----------|
| POST-001 | 如需重新测试，需重置数据库 |
| POST-002 | 管理员账户已创建并可用于后续登录测试 |

---

## 7. AI 自动化测试注释

```yaml
test_type: e2e
browser: chromium
timeout: 30000
requires_clean_db: true
output_artifacts:
  - screenshots/TC-AUTH-001-A1-setup-page.png
  - screenshots/TC-AUTH-001-A8-success.png
  - screenshots/TC-AUTH-001-A9-login-redirect.png
```
