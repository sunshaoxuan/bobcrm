# BobCRM 产品路线图

> **愿景**: 构建一个用于企业信息系统建设和运行的综合性无代码/低代码平台。

---

## 🏆 已完成里程碑 (成就)

在继续前行之前，我们确认已建立的坚实基础：

- **动态实体系统**:
    - [x] 运行时实体定义 (元数据驱动)。
    - [x] 数据库架构自动迁移 (PostgreSQL)。
    - [x] 动态 CRUD API。
- **表单引擎**:
    - [x] 拖拽式表单设计器。
    - [x] 表单模板存储与版本控制。
    - [x] 动态表单渲染 (详情/编辑视图)。
- **动态枚举系统**:
    - [x] UI 驱动的枚举管理。
    - [x] 与实体字段集成。
- **身份与访问管理 (RBAC)**:
    - [x] 用户/角色/组织管理。
    - [x] 基于功能的权限控制。
    - [x] 数据范围 (行级安全) 基础。
- **前端架构**:
    - [x] Ant Design Blazor 集成。
    - [x] 动态菜单/导航系统。
    - [x] 多语言支持 (i18n)。

---

## 🚀 版本 1.0: 无代码/低代码基础
**目标**: 一个功能齐全的平台，允许用户在不编写代码的情况下构建和运行数据驱动的应用程序 (不包括复杂的工作流)。

### 1.1 模板系统补全 (当前优先级)
- [x] **列表视图模板化**:
    - [x] 实现 `ListTemplateHost` 以渲染动态数据网格。
    - [x] 支持通过模板配置列、筛选和排序。
    - [x] **任务**: 迁移 `Customers` (客户) 列表以使用 `ListTemplateHost`。
    - [x] **DataGridRuntime行操作**: 实现RowActionsJson的Edit和Delete按钮功能
    - [x] **导航功能**: 实现行点击和操作按钮导航到详情页
    - [x] **自动模板生成**: EntityDefinitionSynchronizer在同步实体时自动创建模板和绑定
- [x] **模板绑定 UI** (基础完成):
    - [x] `/templates/bindings` 页面已实现，支持实体/用途筛选和系统/用户绑定切换
    - [x] 在角色权限页面中已集成模板绑定选择器
    - [ ] **待增强**: 上下文感知绑定UI（角色/组织级别的绑定可视化）
    - [ ] **待增强**: 批量绑定操作和绑定配置复制
- [x] **系统实体迁移** (部分完成):
    - [x] Customer、User、Role 实体已迁移至模板驱动视图
    - [x] 详见 [PROC-07-系统实体模板化迁移记录](process/PROC-07-系统实体模板化迁移记录.md)
    - [ ] **待补偿**: UserRoleAssignment 组件（用户角色分配功能）
    - [ ] **待补偿**: RolePermissionTree 组件（角色权限树功能）
    - [ ] **待迁移**: Organization 实体

### 1.2 菜单与导航管理 (优先级提升)
> **说明**: 提升此模块优先级是为了完成权限系统的闭环。只有实现了可视化的菜单管理并与权限挂钩，后续的高级功能才能安全地交付给最终用户。

- [ ] **动态枚举管理入口**:
    - [ ] 在系统菜单中添加 `/system/enums` 入口（仅管理员可见）
    - [ ] 权限码关联：`Menu_EnumManagement`
    - [ ] 详见 [GUIDE-05-动态枚举系统使用指南](guides/GUIDE-05-动态枚举系统使用指南.md)
- [ ] **可视化菜单编辑器**:
    - [ ] 拖拽式菜单层级配置
    - [ ] 将菜单链接到动态实体或自定义页面
    - [ ] **权限集成**: 自动生成或关联功能权限码 (Function Codes)，确保菜单可见性与用户权限严格同步
    - [ ] 详见 [GUIDE-06-菜单编辑器使用指南](guides/GUIDE-06-菜单编辑器使用指南.md)
    - [ ] 实施计划参考 [PROC-06-下一步开发计划](process/PROC-06-下一步开发计划.md)

### 1.3 高级数据可视化与交互
- [ ] **仪表盘引擎**:
    - [ ] 拖拽式仪表盘设计器。
    - [ ] 组件: 图表、KPI 卡片、活动日志。
- [ ] **数据导入/导出**:
    - [ ] Excel/CSV 导入映射到动态实体。
    - [ ] 列表视图的导出功能。

### 1.4 增强的安全与治理
- [ ] **字段级安全**:
    - [ ] 基于角色配置每个字段的读/写访问权限。
- [ ] **数据范围 UI**:
    - [ ] 用于定义数据范围的可视化编辑器 (例如，“销售人员只能看到自己的线索”)。
- [ ] **审计日志 UI**:
    - [ ] 用于查看系统活动和数据变更的可视化日志查看器。

### 1.5 业务逻辑 (脚本)
- [ ] **简单逻辑挂钩**:
    - [ ] 保存前/保存后验证脚本 (C# 或 JavaScript 沙箱)。
    - [ ] 字段计算公式。

---

## 🌊 版本 2.0: 工作流自动化引擎 (Elsa Workflow 集成)
**目标**: 集成业界领先的 **Elsa Workflow** (最新版) 引擎，利用其成熟的生态系统实现灵活的业务流程编排，避免重复造轮子。

### 2.1 核心引擎集成
- [ ] **Elsa Server 集成**:
    - [ ] 引入 Elsa NuGet 包并配置服务。
    - [ ] 配置 Elsa 持久化层 (与 BobCRM 数据库集成)。
- [ ] **自定义活动 (Custom Activities)**:
    - [ ] 开发适配 BobCRM 的自定义活动 (例如: "创建实体记录", "更新实体状态", "发送站内信")。
    - [ ] 实现脚本活动以支持复杂业务逻辑。

### 2.2 官方设计器接入
- [ ] **Elsa Studio 集成**:
    - [ ] 直接集成 Elsa 官方提供的 Dashboard/Designer 组件 (Blazor 或独立部署)。
    - [ ] 实现单点登录 (SSO)，使 BobCRM 用户能无缝访问流程设计器。

### 2.3 业务流程应用
- [ ] **审批工作流**:
    - [ ] 基于 Elsa 实现审批状态机。
    - [ ] **审批中心**: 在 BobCRM 中构建统一的"待办事项"界面，与 Elsa 任务信号 (Signals) 对接。
- [ ] **自动化触发器**:
    - [ ] 实现 BobCRM 实体事件 (OnCreate, OnUpdate) 到 Elsa 工作流的自动触发机制。

---

## 🌍 版本 2.5: 多数据库与可扩展性
**目标**: 通过多数据库能力支持多样化的企业基础设施需求。

### 3.1 数据库抽象层 (中间语言机制)
- [ ] **统一查询语言 (UQL)**:
    - [ ] 定义一套独立于具体数据库的中间语言体系 (类 SQL 或对象查询语法)。
    - [ ] 系统核心仅依赖此 UQL 进行数据交互，解耦底层数据库。
- [ ] **翻译引擎 (Translation Engine)**:
    - [ ] 实现 UQL 到目标数据库方言 (PostgreSQL, MSSQL, Oracle 等) 的转换器。
    - [ ] **可扩展架构**: 新增数据库支持只需实现对应的方言翻译层。
- [ ] **EF Core 提供程序工厂**: 基于翻译引擎适配 EF Core Provider。

### 3.2 关系型数据库支持
- [ ] **JSON 支持分级策略**:
    - [ ] **原生支持 (优先)**: 针对 PostgreSQL, MySQL 5.7+, MSSQL 2016+, Oracle 12c+ 等现代化数据库，利用原生 JSON 类型存储动态字段，确保查询性能。
    - [ ] **降级支持 (Legacy)**: 针对不支持 JSON 的旧版数据库，采用文本存储 + 应用层解析方案 (需评估性能影响)。
- [ ] **MSSQL Server**: 全面支持。
- [ ] **MySQL / MariaDB**: 全面支持。
- [ ] **Oracle Database**: 全面支持。

### 3.3 NoSQL 与存储扩展
- [ ] **NoSQL 集成**: MongoDB 或 CosmosDB 用于非结构化数据/日志。
- [ ] **存储提供程序**: 抽象 MinIO 以支持 S3、Azure Blob、本地文件系统。

---

## ⚡ 版本 3.0: 优化与现代化
**目标**: 优化平台以实现高性能、大规模扩展和卓越的开发者体验。

### 4.1 性能调优
- [ ] **缓存策略**: 用于元数据和热数据的分布式缓存 (Redis)。
- [ ] **CQRS**: 为高流量实体分离读/写模型。

### 4.2 架构重构
- [ ] **微服务就绪**: 解耦核心模块 (认证、实体、工作流) 以便独立部署。
- [ ] **API 网关**: 具有速率限制和节流功能的统一入口点。

### 4.3 开发者体验 (DX)
- [ ] **SDK & CLI**: 供开发者扩展平台的工具。
- [ ] **市场**: 分享/销售模板和插件的机制。
