# TEMPLATE-01: 代码审查报告模板

**模板版本**: v1.0
**适用于**: PROMPT-01-全面代码审查

---

## 使用说明

复制本模板到 `docs/reviews/` 目录，命名为：
`REVIEW-XX-全面代码审查-YYYY-MM.md`

---

# REVIEW-XX: BobCRM 全面代码审查报告

**审查日期**: YYYY-MM-DD
**审查人**: [AI/人工]
**审查版本**: vX.X.X
**基于 Commit**: [commit hash]

---

## 一、审查概要

### 1.1 审查范围

| 类型 | 文件数 | 代码行数 | 备注 |
|------|--------|----------|------|
| 后端服务 | | | src/BobCrm.Api/ |
| 前端组件 | | | src/BobCrm.App/ |
| 测试代码 | | | tests/ |
| **总计** | | | |

### 1.2 总体评分

| 维度 | 评分 | 权重 | 加权分 |
|------|------|------|--------|
| 功能完整性 | /10 | 25% | |
| 代码质量 | /10 | 25% | |
| 安全性 | /10 | 20% | |
| 性能 | /10 | 15% | |
| I18n合规 | /10 | 10% | |
| 文档一致性 | /10 | 5% | |
| **总体** | **/10** | 100% | |

### 1.3 问题统计

| 优先级 | 数量 | 已修复 | 待处理 |
|--------|------|--------|--------|
| P0 (阻断) | | | |
| P1 (重要) | | | |
| P2 (一般) | | | |
| P3 (优化) | | | |
| **总计** | | | |

---

## 二、功能评审

### 2.1 实体系统

#### 评审结果
| 检查项 | 状态 | 说明 |
|--------|------|------|
| 实体定义 CRUD | ✅/⚠️/❌ | |
| 字段管理 | | |
| 接口管理 | | |
| 实体发布 | | |
| 动态实体 CRUD | | |
| 实体锁定 | | |

#### 发现问题
1. **[问题ID]**: [问题描述]
   - 位置：`[文件路径:行号]`
   - 优先级：P?
   - 详情：

### 2.2 权限系统

#### 评审结果
| 检查项 | 状态 | 说明 |
|--------|------|------|
| 用户管理 | | |
| 角色管理 | | |
| 功能节点 | | |
| 权限分配 | | |
| 数据范围 | | |

#### 发现问题
...

### 2.3 表单系统

#### 评审结果
| 检查项 | 状态 | 说明 |
|--------|------|------|
| 模板 CRUD | | |
| 设计器功能 | | |
| 控件属性 | | |
| 表单渲染 | | |

#### 发现问题
...

### 2.4 菜单导航

#### 评审结果
| 检查项 | 状态 | 说明 |
|--------|------|------|
| 菜单配置 | | |
| 域选择器 | | |
| 菜单面板 | | |

#### 发现问题
...

### 2.5 多语言系统

#### 评审结果
| 检查项 | 状态 | 说明 |
|--------|------|------|
| 资源管理 | | |
| 前端切换 | | |
| 元数据多语 | | |

#### 发现问题
...

### 2.6 枚举系统

#### 评审结果
| 检查项 | 状态 | 说明 |
|--------|------|------|
| 枚举定义 | | |
| 枚举项管理 | | |
| UI 集成 | | |

#### 发现问题
...

---

## 三、代码质量评审

### 3.1 OOP/SOLID 原则

| 原则 | 评分 | 发现问题数 | 说明 |
|------|------|------------|------|
| 单一职责 (SRP) | /10 | | |
| 开闭原则 (OCP) | /10 | | |
| 里氏替换 (LSP) | /10 | | |
| 接口隔离 (ISP) | /10 | | |
| 依赖倒置 (DIP) | /10 | | |

#### 具体问题

**[Q-OOP-001]**: 缺少接口抽象
- 位置：`src/BobCrm.Api/Services/EntityLockService.cs`
- 问题：服务类直接注入具体类而非接口
- 当前代码：
```csharp
public class EntityPublishingService
{
    private readonly EntityLockService _lockService; // 具体类
}
```
- 建议修复：
```csharp
public interface IEntityLockService { ... }

public class EntityPublishingService
{
    private readonly IEntityLockService _lockService; // 接口
}
```

### 3.2 命名规范

| 检查项 | 合规率 | 问题数 |
|--------|--------|--------|
| 类/接口命名 | % | |
| 方法命名 | % | |
| 变量命名 | % | |
| 文件命名 | % | |

#### 具体问题
...

### 3.3 异常处理

| 检查项 | 状态 | 说明 |
|--------|------|------|
| 无空 catch | | |
| 异常类型合理 | | |
| 错误信息完整 | | |
| 全局异常处理 | | |

#### 具体问题
...

### 3.4 异步编程

| 检查项 | 状态 | 说明 |
|--------|------|------|
| async/await 正确使用 | | |
| 无 async void | | |
| 无阻塞调用 | | |
| 取消令牌支持 | | |

#### 具体问题
...

### 3.5 日志记录

| 检查项 | 状态 | 说明 |
|--------|------|------|
| 关键操作有日志 | | |
| 日志级别合适 | | |
| 结构化日志 | | |
| 无敏感信息泄露 | | |

#### 具体问题
...

---

## 四、安全性评审

### 4.1 输入验证

| 检查项 | 状态 | 风险级别 |
|--------|------|----------|
| API 参数验证 | | |
| SQL 注入防护 | | |
| XSS 防护 | | |
| CSRF 防护 | | |

#### 发现漏洞
...

### 4.2 认证授权

| 检查项 | 状态 | 说明 |
|--------|------|------|
| JWT 安全配置 | | |
| 密码安全存储 | | |
| 权限验证完整 | | |
| 敏感操作审计 | | |

#### 发现问题
...

### 4.3 敏感数据

| 检查项 | 状态 | 说明 |
|--------|------|------|
| 配置文件安全 | | |
| 日志无敏感信息 | | |
| 加密传输 | | |

#### 发现问题
...

---

## 五、性能评审

### 5.1 数据库

| 检查项 | 状态 | 说明 |
|--------|------|------|
| N+1 查询问题 | | |
| 索引使用合理 | | |
| 查询优化 | | |
| 连接池配置 | | |

#### 发现问题
...

### 5.2 内存管理

| 检查项 | 状态 | 说明 |
|--------|------|------|
| IDisposable 处理 | | |
| 大对象及时释放 | | |
| 无内存泄漏 | | |

#### 发现问题
...

### 5.3 缓存策略

| 检查项 | 状态 | 说明 |
|--------|------|------|
| 合理使用缓存 | | |
| 缓存失效策略 | | |
| 分布式缓存支持 | | |

#### 发现问题
...

---

## 六、I18n 合规评审

### 6.1 硬编码检查

| 检查范围 | 硬编码数 | 已修复 | 说明 |
|----------|----------|--------|------|
| 后端错误消息 | | | |
| 前端 UI 文本 | | | |
| 日志消息 | | | |
| 验证消息 | | | |

#### 硬编码清单
| 文件 | 行号 | 硬编码内容 | 建议资源键 |
|------|------|------------|------------|
| | | | |

### 6.2 资源完整性

| 语言 | 资源总数 | 缺失数 | 完整率 |
|------|----------|--------|--------|
| zh-CN | | | % |
| ja-JP | | | % |
| en-US | | | % |

---

## 七、文档一致性评审

### 7.1 设计文档对比

| 设计文档 | 章节 | 一致性 | 差异说明 |
|----------|------|--------|----------|
| ARCH-01 | | ✅/❌ | |
| ARCH-20 | | | |
| ARCH-21 | | | |

### 7.2 API 文档对比

| API 端点 | 文档状态 | 实现状态 | 差异 |
|----------|----------|----------|------|
| | | | |

### 7.3 缺失/过时文档

| 功能模块 | 文档状态 | 建议操作 |
|----------|----------|----------|
| | | |

---

## 八、正面发现

### 8.1 优秀实践

1. **[实践名称]**
   - 位置：`[文件路径]`
   - 描述：
   - 值得推广原因：

### 8.2 代码亮点

1. **[亮点描述]**
   - 位置：
   - 说明：

---

## 九、问题汇总清单

### P0 问题（必须修复）

| ID | 类别 | 描述 | 位置 | 负责人 | 状态 |
|----|------|------|------|--------|------|
| P0-001 | | | | | ⬜ |

### P1 问题（重要修复）

| ID | 类别 | 描述 | 位置 | 负责人 | 状态 |
|----|------|------|------|--------|------|
| P1-001 | | | | | ⬜ |

### P2 问题（一般改进）

| ID | 类别 | 描述 | 位置 | 负责人 | 状态 |
|----|------|------|------|--------|------|
| P2-001 | | | | | ⬜ |

### P3 问题（优化建议）

| ID | 类别 | 描述 | 位置 | 负责人 | 状态 |
|----|------|------|------|--------|------|
| P3-001 | | | | | ⬜ |

---

## 十、改进建议

### 10.1 短期改进（1-2周）

1. [具体建议]

### 10.2 中期改进（1个月）

1. [具体建议]

### 10.3 长期改进（季度）

1. [具体建议]

---

## 附录

### A. 审查工具和方法

- 代码分析工具：
- 审查方法：
- 参考规范：

### B. 相关文档

- 改进计划：`PLAN-XX-审查改进计划-YYYY-MM.md`
- 问题详单：`AUDIT-XX-代码审查问题清单-YYYY-MM.md`

### C. 审查日志

| 日期 | 阶段 | 内容 | 耗时 |
|------|------|------|------|
| | 文档学习 | | |
| | 功能评审 | | |
| | 代码评审 | | |
| | 报告整理 | | |

---

**报告生成日期**: YYYY-MM-DD
**下次审查建议日期**: YYYY-MM-DD
